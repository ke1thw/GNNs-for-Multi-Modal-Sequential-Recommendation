11/29/2023 05:16:04 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Sports/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Sports/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Sports/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_embed_dim_2': 256, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Sports', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-clothing.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Sports-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/29/2023 05:17:23 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Sports/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Sports/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Sports/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_embed_dim_2': 256, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Sports', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-clothing.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Sports-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/29/2023 05:17:39 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/29/2023 05:17:39 - INFO - trainer.finetune_trainer - ***** Run training *****
11/29/2023 05:17:39 - INFO - trainer.finetune_trainer -   Num examples = 189543
11/29/2023 05:17:39 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/29/2023 05:17:39 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/29/2023 05:17:39 - INFO - trainer.finetune_trainer -   Total train batch size = 8
11/29/2023 05:17:39 - INFO - trainer.finetune_trainer -   Total steps = 11846500
11/29/2023 05:27:40 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Sports/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Sports/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Sports/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_embed_dim_2': 256, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Sports', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-clothing.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Sports-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/29/2023 05:27:56 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/29/2023 05:27:56 - INFO - trainer.finetune_trainer - ***** Run training *****
11/29/2023 05:27:56 - INFO - trainer.finetune_trainer -   Num examples = 189543
11/29/2023 05:27:56 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/29/2023 05:27:56 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/29/2023 05:27:56 - INFO - trainer.finetune_trainer -   Total train batch size = 8
11/29/2023 05:27:56 - INFO - trainer.finetune_trainer -   Total steps = 11846500
11/29/2023 05:29:04 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Sports/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Sports/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Sports/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_embed_dim_2': 256, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Sports', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-clothing.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Sports-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/29/2023 05:29:20 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/29/2023 05:29:20 - INFO - trainer.finetune_trainer - ***** Run training *****
11/29/2023 05:29:20 - INFO - trainer.finetune_trainer -   Num examples = 189543
11/29/2023 05:29:20 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/29/2023 05:29:20 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/29/2023 05:29:20 - INFO - trainer.finetune_trainer -   Total train batch size = 8
11/29/2023 05:29:20 - INFO - trainer.finetune_trainer -   Total steps = 11846500
11/29/2023 05:30:44 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Sports/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Sports/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Sports/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_embed_dim_2': 256, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Sports', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-clothing.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Sports-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/29/2023 05:31:00 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/29/2023 05:31:00 - INFO - trainer.finetune_trainer - ***** Run training *****
11/29/2023 05:31:00 - INFO - trainer.finetune_trainer -   Num examples = 189543
11/29/2023 05:31:00 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/29/2023 05:31:00 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/29/2023 05:31:00 - INFO - trainer.finetune_trainer -   Total train batch size = 8
11/29/2023 05:31:00 - INFO - trainer.finetune_trainer -   Total steps = 11846500
11/29/2023 05:33:40 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Sports/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Sports/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Sports/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_embed_dim_2': 256, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Sports', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-clothing.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Sports-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/29/2023 05:33:56 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/29/2023 05:33:56 - INFO - trainer.finetune_trainer - ***** Run training *****
11/29/2023 05:33:56 - INFO - trainer.finetune_trainer -   Num examples = 189543
11/29/2023 05:33:56 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/29/2023 05:33:56 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/29/2023 05:33:56 - INFO - trainer.finetune_trainer -   Total train batch size = 8
11/29/2023 05:33:56 - INFO - trainer.finetune_trainer -   Total steps = 11846500
11/29/2023 05:39:47 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Sports/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Sports/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Sports/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_embed_dim_2': 256, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Sports', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-clothing.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Sports-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/29/2023 05:40:04 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/29/2023 05:40:04 - INFO - trainer.finetune_trainer - ***** Run training *****
11/29/2023 05:40:04 - INFO - trainer.finetune_trainer -   Num examples = 189543
11/29/2023 05:40:04 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/29/2023 05:40:04 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/29/2023 05:40:04 - INFO - trainer.finetune_trainer -   Total train batch size = 8
11/29/2023 05:40:04 - INFO - trainer.finetune_trainer -   Total steps = 11846500
11/29/2023 05:46:29 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Sports/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Sports/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Sports/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_embed_dim_2': 256, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Sports', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-clothing.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Sports-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/29/2023 05:46:46 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/29/2023 05:46:46 - INFO - trainer.finetune_trainer - ***** Run training *****
11/29/2023 05:46:46 - INFO - trainer.finetune_trainer -   Num examples = 189543
11/29/2023 05:46:46 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/29/2023 05:46:46 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/29/2023 05:46:46 - INFO - trainer.finetune_trainer -   Total train batch size = 8
11/29/2023 05:46:46 - INFO - trainer.finetune_trainer -   Total steps = 11846500
