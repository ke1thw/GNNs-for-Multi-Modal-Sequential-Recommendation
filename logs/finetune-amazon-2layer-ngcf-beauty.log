11/29/2023 06:45:43 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_embed_dim_2': 256, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/29/2023 06:46:13 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/29/2023 06:46:13 - INFO - trainer.finetune_trainer - ***** Run training *****
11/29/2023 06:46:13 - INFO - trainer.finetune_trainer -   Num examples = 131413
11/29/2023 06:46:13 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/29/2023 06:46:13 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/29/2023 06:46:13 - INFO - trainer.finetune_trainer -   Total train batch size = 8
11/29/2023 06:46:13 - INFO - trainer.finetune_trainer -   Total steps = 8213500
11/29/2023 06:49:37 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_embed_dim_2': 256, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/29/2023 06:49:53 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/29/2023 06:49:53 - INFO - trainer.finetune_trainer - ***** Run training *****
11/29/2023 06:49:53 - INFO - trainer.finetune_trainer -   Num examples = 131413
11/29/2023 06:49:53 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/29/2023 06:49:53 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/29/2023 06:49:53 - INFO - trainer.finetune_trainer -   Total train batch size = 8
11/29/2023 06:49:53 - INFO - trainer.finetune_trainer -   Total steps = 8213500
11/29/2023 10:52:01 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 8, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/29/2023 10:52:24 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/29/2023 10:52:24 - INFO - trainer.finetune_trainer - ***** Run training *****
11/29/2023 10:52:24 - INFO - trainer.finetune_trainer -   Num examples = 131413
11/29/2023 10:52:24 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/29/2023 10:52:24 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/29/2023 10:52:24 - INFO - trainer.finetune_trainer -   Total train batch size = 8
11/29/2023 10:52:24 - INFO - trainer.finetune_trainer -   Total steps = 8213500
11/29/2023 11:45:19 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 8, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 8, 'device': device(type='cuda', index=0)}
11/29/2023 12:39:15 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 8, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 8, 'device': device(type='cuda', index=0)}
11/29/2023 12:52:10 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 8, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/29/2023 12:52:29 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/29/2023 12:52:29 - INFO - trainer.finetune_trainer - ***** Run training *****
11/29/2023 12:52:29 - INFO - trainer.finetune_trainer -   Num examples = 131413
11/29/2023 12:52:29 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/29/2023 12:52:29 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/29/2023 12:52:29 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
11/29/2023 12:52:29 - INFO - trainer.finetune_trainer -   Total steps = 32500
11/29/2023 13:19:42 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 8, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 4, 'device': device(type='cuda', index=0)}
11/29/2023 13:20:07 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/29/2023 13:20:07 - INFO - trainer.finetune_trainer - ***** Run training *****
11/29/2023 13:20:07 - INFO - trainer.finetune_trainer -   Num examples = 131413
11/29/2023 13:20:07 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/29/2023 13:20:07 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/29/2023 13:20:07 - INFO - trainer.finetune_trainer -   Total train batch size = 4096
11/29/2023 13:20:07 - INFO - trainer.finetune_trainer -   Total steps = 16500
11/29/2023 13:21:21 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:21:36 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.018691588193178177, R@50:0.056343063712120056, NDCG@10:0.010055271908640862, NDCG@50:0.01804075390100479
11/29/2023 13:21:36 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:22:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:22:58 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.039484862238168716, R@50:0.10982426255941391, NDCG@10:0.02000889740884304, NDCG@50:0.03517528995871544
11/29/2023 13:22:58 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:24:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:24:20 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.05021687597036362, R@50:0.1368778795003891, NDCG@10:0.024495793506503105, NDCG@50:0.04313506931066513
11/29/2023 13:24:20 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:25:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:25:42 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.05701381713151932, R@50:0.15516701340675354, NDCG@10:0.027925916016101837, NDCG@50:0.0491119809448719
11/29/2023 13:25:42 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:26:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:27:04 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.05947323516011238, R@50:0.16411036252975464, NDCG@10:0.029216095805168152, NDCG@50:0.051765017211437225
11/29/2023 13:27:04 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:28:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:28:26 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.06877431273460388, R@50:0.18235477805137634, NDCG@10:0.033734872937202454, NDCG@50:0.058231040835380554
11/29/2023 13:28:26 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:29:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:29:48 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.07051826268434525, R@50:0.1839645802974701, NDCG@10:0.03487970307469368, NDCG@50:0.059302087873220444
11/29/2023 13:29:48 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:30:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:31:10 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.07776237279176712, R@50:0.1961275339126587, NDCG@10:0.03888440504670143, NDCG@50:0.06454087048768997
11/29/2023 13:31:10 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:32:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:32:32 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.07955104112625122, R@50:0.19608281552791595, NDCG@10:0.03852196782827377, NDCG@50:0.06374377012252808
11/29/2023 13:32:32 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:33:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:33:54 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.07946161180734634, R@50:0.1966194063425064, NDCG@10:0.039779260754585266, NDCG@50:0.0652272179722786
11/29/2023 13:35:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:35:16 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.0817868784070015, R@50:0.20788802206516266, NDCG@10:0.04153343662619591, NDCG@50:0.06884758174419403
11/29/2023 13:35:16 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:36:23 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:36:38 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.08022179454565048, R@50:0.20033089816570282, NDCG@10:0.04006560146808624, NDCG@50:0.06623459607362747
11/29/2023 13:37:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:38:00 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.08388856053352356, R@50:0.20426596701145172, NDCG@10:0.0419013649225235, NDCG@50:0.06789915263652802
11/29/2023 13:38:00 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 12 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:39:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:39:22 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.0871528834104538, R@50:0.2132987529039383, NDCG@10:0.04363216459751129, NDCG@50:0.07105729728937149
11/29/2023 13:39:22 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 13 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:40:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:40:44 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.0828600823879242, R@50:0.20426596701145172, NDCG@10:0.041936930269002914, NDCG@50:0.06841221451759338
11/29/2023 13:41:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:42:06 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.08491704612970352, R@50:0.2107946127653122, NDCG@10:0.04201164469122887, NDCG@50:0.06938204169273376
11/29/2023 13:43:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:43:28 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.0882260873913765, R@50:0.2129410207271576, NDCG@10:0.044030774384737015, NDCG@50:0.07117340713739395
11/29/2023 13:43:28 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:44:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:44:50 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.08943343907594681, R@50:0.21803872287273407, NDCG@10:0.04490964114665985, NDCG@50:0.072904072701931
11/29/2023 13:44:50 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 17 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:45:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:46:12 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.08961230516433716, R@50:0.21459552645683289, NDCG@10:0.04543774947524071, NDCG@50:0.07262539118528366
11/29/2023 13:46:12 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:47:19 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:47:34 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.09131153672933578, R@50:0.21906720101833344, NDCG@10:0.04631687328219414, NDCG@50:0.07415681332349777
11/29/2023 13:47:34 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 19 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:48:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:48:56 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.08912041783332825, R@50:0.2148638367652893, NDCG@10:0.044813185930252075, NDCG@50:0.07210281491279602
11/29/2023 13:50:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:50:18 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.09292133897542953, R@50:0.21790456771850586, NDCG@10:0.04725251346826553, NDCG@50:0.0744316577911377
11/29/2023 13:50:18 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 21 to ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 13:51:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:51:40 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.08853910118341446, R@50:0.21334347128868103, NDCG@10:0.0446087010204792, NDCG@50:0.07169827818870544
11/29/2023 13:52:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:53:02 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.09225059300661087, R@50:0.21674193441867828, NDCG@10:0.04688742384314537, NDCG@50:0.07389967143535614
11/29/2023 13:54:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:54:24 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.0910879522562027, R@50:0.21884362399578094, NDCG@10:0.046042684465646744, NDCG@50:0.07399686425924301
11/29/2023 13:55:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:55:46 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.08934400230646133, R@50:0.2179492861032486, NDCG@10:0.044865552335977554, NDCG@50:0.07290000468492508
11/29/2023 13:56:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:57:07 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.0892992839217186, R@50:0.21866475045681, NDCG@10:0.045089829713106155, NDCG@50:0.07323595136404037
11/29/2023 13:58:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:58:29 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.09090908616781235, R@50:0.2175915539264679, NDCG@10:0.0458376370370388, NDCG@50:0.07329066097736359
11/29/2023 13:59:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 13:59:51 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.08947815746068954, R@50:0.21303044259548187, NDCG@10:0.04437955096364021, NDCG@50:0.07121235877275467
11/29/2023 14:00:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 14:01:13 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.09077493846416473, R@50:0.2150874137878418, NDCG@10:0.045803118497133255, NDCG@50:0.0728815346956253
11/29/2023 14:02:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 14:02:35 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.08920985460281372, R@50:0.2132987529039383, NDCG@10:0.04522096738219261, NDCG@50:0.07224200665950775
11/29/2023 14:03:42 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/29/2023 14:03:57 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.08563251793384552, R@50:0.2091400921344757, NDCG@10:0.043332476168870926, NDCG@50:0.07018642872571945
11/29/2023 14:03:57 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Beauty-8192batch-ngcf
11/29/2023 14:03:57 - INFO - trainer.finetune_evaluator - ***** Run test *****
11/29/2023 14:04:12 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.07753878831863403, R@50:0.18852569162845612, NDCG@10:0.03884074464440346, NDCG@50:0.06286589801311493

11/30/2023 03:50:05 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/30/2023 03:50:20 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/30/2023 03:50:20 - INFO - trainer.finetune_trainer - ***** Run training *****
11/30/2023 03:50:20 - INFO - trainer.finetune_trainer -   Num examples = 131413
11/30/2023 03:50:20 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/30/2023 03:50:20 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/30/2023 03:50:20 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
11/30/2023 03:50:20 - INFO - trainer.finetune_trainer -   Total steps = 32500
11/30/2023 03:52:17 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/30/2023 03:52:32 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/30/2023 03:52:32 - INFO - trainer.finetune_trainer - ***** Run training *****
11/30/2023 03:52:32 - INFO - trainer.finetune_trainer -   Num examples = 131413
11/30/2023 03:52:32 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/30/2023 03:52:32 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/30/2023 03:52:32 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
11/30/2023 03:52:32 - INFO - trainer.finetune_trainer -   Total steps = 32500
11/30/2023 03:53:42 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 03:53:52 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.03027321770787239, R@50:0.08201046288013458, NDCG@10:0.01576085388660431, NDCG@50:0.026805434376001358
11/30/2023 03:53:52 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 03:55:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 03:55:09 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.049724992364645004, R@50:0.13965031504631042, NDCG@10:0.023801112547516823, NDCG@50:0.04320523142814636
11/30/2023 03:55:09 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 03:56:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 03:56:27 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.05911550298333168, R@50:0.1592809557914734, NDCG@10:0.028658563271164894, NDCG@50:0.05019855499267578
11/30/2023 03:56:27 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 03:57:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 03:57:44 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.06457094103097916, R@50:0.17900101840496063, NDCG@10:0.031155895441770554, NDCG@50:0.055757567286491394
11/30/2023 03:57:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 03:58:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 03:59:02 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.07154674828052521, R@50:0.18763135373592377, NDCG@10:0.035988517105579376, NDCG@50:0.061144184321165085
11/30/2023 03:59:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:00:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:00:20 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.07588426768779755, R@50:0.19702185690402985, NDCG@10:0.038298722356557846, NDCG@50:0.06450913101434708
11/30/2023 04:00:20 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:01:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:01:37 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.08294951170682907, R@50:0.20417653024196625, NDCG@10:0.040679723024368286, NDCG@50:0.06683579832315445
11/30/2023 04:01:37 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:02:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:02:55 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.08567723631858826, R@50:0.20744085311889648, NDCG@10:0.04287385568022728, NDCG@50:0.06927797943353653
11/30/2023 04:02:55 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:04:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:04:13 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.08804722130298615, R@50:0.21410365402698517, NDCG@10:0.04431784525513649, NDCG@50:0.07166268676519394
11/30/2023 04:04:13 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:05:21 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:05:30 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.08706345409154892, R@50:0.2140142172574997, NDCG@10:0.04445508494973183, NDCG@50:0.07188723981380463
11/30/2023 04:06:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:06:48 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.09050663560628891, R@50:0.2184411734342575, NDCG@10:0.04491186887025833, NDCG@50:0.07248145341873169
11/30/2023 04:06:48 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:07:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:08:05 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.09059607237577438, R@50:0.2230917066335678, NDCG@10:0.04571876302361488, NDCG@50:0.07440249621868134
11/30/2023 04:08:05 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 11 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:09:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:09:23 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.09099852293729782, R@50:0.22049814462661743, NDCG@10:0.045880381017923355, NDCG@50:0.07396887242794037
11/30/2023 04:09:23 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 12 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:10:31 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:10:40 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.0943075567483902, R@50:0.22859185934066772, NDCG@10:0.04764958471059799, NDCG@50:0.07668393105268478
11/30/2023 04:10:40 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 13 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:11:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:11:58 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.09520189464092255, R@50:0.22841300070285797, NDCG@10:0.04762215167284012, NDCG@50:0.07644300907850266
11/30/2023 04:11:58 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 14 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:13:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:13:16 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.09471000730991364, R@50:0.22809998691082, NDCG@10:0.047403544187545776, NDCG@50:0.07616099715232849
11/30/2023 04:14:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:14:33 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.09819791465997696, R@50:0.23149845004081726, NDCG@10:0.04919012263417244, NDCG@50:0.07801234722137451
11/30/2023 04:14:33 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:15:42 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:15:51 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.09766131639480591, R@50:0.2322586327791214, NDCG@10:0.04882953315973282, NDCG@50:0.07804056257009506
11/30/2023 04:16:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:17:08 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.09815319627523422, R@50:0.2346286177635193, NDCG@10:0.04944133013486862, NDCG@50:0.07923007011413574
11/30/2023 04:18:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:18:26 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.09918168187141418, R@50:0.233108252286911, NDCG@10:0.0495588593184948, NDCG@50:0.07861965149641037
11/30/2023 04:18:26 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 19 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:19:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:19:44 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.09792961180210114, R@50:0.23529937863349915, NDCG@10:0.04887831583619118, NDCG@50:0.07871489971876144
11/30/2023 04:20:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:21:01 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.10021016746759415, R@50:0.23480749130249023, NDCG@10:0.0498478077352047, NDCG@50:0.07910928875207901
11/30/2023 04:21:01 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 21 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:22:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:22:19 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.09936054795980453, R@50:0.2390555739402771, NDCG@10:0.04929948225617409, NDCG@50:0.07972177863121033
11/30/2023 04:23:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:23:37 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.10083620250225067, R@50:0.23878727853298187, NDCG@10:0.05025990679860115, NDCG@50:0.08014204353094101
11/30/2023 04:23:37 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 23 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:24:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:24:54 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.10034431517124176, R@50:0.2394133061170578, NDCG@10:0.05016615241765976, NDCG@50:0.08030887693166733
11/30/2023 04:26:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:26:12 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.10070204734802246, R@50:0.23431560397148132, NDCG@10:0.05055676028132439, NDCG@50:0.07969176769256592
11/30/2023 04:27:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:27:29 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.10244600474834442, R@50:0.24214103817939758, NDCG@10:0.05134370177984238, NDCG@50:0.08168326318264008
11/30/2023 04:27:29 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 26 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:28:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:28:47 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.10186468809843063, R@50:0.23677502572536469, NDCG@10:0.05101531744003296, NDCG@50:0.08042238652706146
11/30/2023 04:29:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:30:04 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.10231184959411621, R@50:0.24173858761787415, NDCG@10:0.05106021463871002, NDCG@50:0.08126012980937958
11/30/2023 04:31:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:31:21 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.10472655296325684, R@50:0.2408442497253418, NDCG@10:0.05283593758940697, NDCG@50:0.08240792155265808
11/30/2023 04:31:21 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 29 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:32:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:32:39 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.103608638048172, R@50:0.2422751784324646, NDCG@10:0.0517791211605072, NDCG@50:0.08193787932395935
11/30/2023 04:33:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:33:56 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.10405580699443817, R@50:0.24053123593330383, NDCG@10:0.052069682627916336, NDCG@50:0.08166852593421936
11/30/2023 04:35:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:35:14 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.10365335643291473, R@50:0.24035236239433289, NDCG@10:0.051896512508392334, NDCG@50:0.08174912631511688
11/30/2023 04:36:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:36:31 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.10490541905164719, R@50:0.24308007955551147, NDCG@10:0.052923914045095444, NDCG@50:0.08303925395011902
11/30/2023 04:36:31 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 33 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:37:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:37:48 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.10633635520935059, R@50:0.24321423470973969, NDCG@10:0.05337237939238548, NDCG@50:0.0830974355340004
11/30/2023 04:37:48 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 34 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:38:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:39:06 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.10526315867900848, R@50:0.24196216464042664, NDCG@10:0.052650924772024155, NDCG@50:0.08242159336805344
11/30/2023 04:40:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:40:23 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.10535258799791336, R@50:0.24196216464042664, NDCG@10:0.05313247814774513, NDCG@50:0.0829569548368454
11/30/2023 04:41:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:41:41 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.10566560924053192, R@50:0.2453606277704239, NDCG@10:0.05341963842511177, NDCG@50:0.08374489098787308
11/30/2023 04:42:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:42:58 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.10499485582113266, R@50:0.24647855758666992, NDCG@10:0.053396716713905334, NDCG@50:0.08421042561531067
11/30/2023 04:44:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:44:16 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.10427938401699066, R@50:0.24379554390907288, NDCG@10:0.052983976900577545, NDCG@50:0.08346538990736008
11/30/2023 04:45:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:45:33 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.10477127134799957, R@50:0.24339309334754944, NDCG@10:0.05309710279107094, NDCG@50:0.0833725780248642
11/30/2023 04:46:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:46:50 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.10517372190952301, R@50:0.2437061220407486, NDCG@10:0.053433917462825775, NDCG@50:0.0835980772972107
11/30/2023 04:47:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:48:08 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.10812502354383469, R@50:0.2467021346092224, NDCG@10:0.05426230654120445, NDCG@50:0.08441377431154251
11/30/2023 04:48:08 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 42 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:49:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:49:25 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.10588918626308441, R@50:0.24388498067855835, NDCG@10:0.053242020308971405, NDCG@50:0.08319339156150818
11/30/2023 04:50:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:50:43 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.10673880577087402, R@50:0.24209631979465485, NDCG@10:0.0529581643640995, NDCG@50:0.08256343007087708
11/30/2023 04:51:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:52:00 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.10602334141731262, R@50:0.24576307833194733, NDCG@10:0.053456589579582214, NDCG@50:0.08391764760017395
11/30/2023 04:53:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:53:17 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.1057550385594368, R@50:0.24603138864040375, NDCG@10:0.053383246064186096, NDCG@50:0.08395648747682571
11/30/2023 04:54:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:54:35 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.10696239024400711, R@50:0.24495817720890045, NDCG@10:0.05404095724225044, NDCG@50:0.08424575626850128
11/30/2023 04:55:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:55:52 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.10392165184020996, R@50:0.2458525151014328, NDCG@10:0.052577391266822815, NDCG@50:0.08356208354234695
11/30/2023 04:57:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:57:10 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.10830388963222504, R@50:0.2453606277704239, NDCG@10:0.05416703224182129, NDCG@50:0.08405692875385284
11/30/2023 04:57:10 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 49 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 04:58:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:58:27 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.10745427757501602, R@50:0.24321423470973969, NDCG@10:0.05426516756415367, NDCG@50:0.0838141217827797
11/30/2023 04:59:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 04:59:45 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.10669408738613129, R@50:0.24321423470973969, NDCG@10:0.05438987538218498, NDCG@50:0.08411626517772675
11/30/2023 05:00:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:01:02 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.10669408738613129, R@50:0.24482403695583344, NDCG@10:0.05430298671126366, NDCG@50:0.08444717526435852
11/30/2023 05:02:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:02:19 - INFO - trainer.finetune_evaluator - Epoch 53 Eval Result: R@10:0.10794615745544434, R@50:0.24589723348617554, NDCG@10:0.05469350144267082, NDCG@50:0.0847044289112091
11/30/2023 05:03:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:03:37 - INFO - trainer.finetune_evaluator - Epoch 54 Eval Result: R@10:0.10714125633239746, R@50:0.24580779671669006, NDCG@10:0.05368600785732269, NDCG@50:0.08400104194879532
11/30/2023 05:04:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:04:54 - INFO - trainer.finetune_evaluator - Epoch 55 Eval Result: R@10:0.10794615745544434, R@50:0.2441979944705963, NDCG@10:0.05427153408527374, NDCG@50:0.08393392711877823
11/30/2023 05:06:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:06:12 - INFO - trainer.finetune_evaluator - Epoch 56 Eval Result: R@10:0.10781200975179672, R@50:0.24455572664737701, NDCG@10:0.054243769496679306, NDCG@50:0.08405698835849762
11/30/2023 05:07:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:07:29 - INFO - trainer.finetune_evaluator - Epoch 57 Eval Result: R@10:0.10946653038263321, R@50:0.2470598667860031, NDCG@10:0.05496714636683464, NDCG@50:0.08495528250932693
11/30/2023 05:07:29 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 57 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:08:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:08:46 - INFO - trainer.finetune_evaluator - Epoch 58 Eval Result: R@10:0.10866162925958633, R@50:0.24647855758666992, NDCG@10:0.05438530445098877, NDCG@50:0.0844227597117424
11/30/2023 05:09:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:10:04 - INFO - trainer.finetune_evaluator - Epoch 59 Eval Result: R@10:0.1079014390707016, R@50:0.24647855758666992, NDCG@10:0.05456547066569328, NDCG@50:0.08480549603700638
11/30/2023 05:11:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:11:21 - INFO - trainer.finetune_evaluator - Epoch 60 Eval Result: R@10:0.10723069310188293, R@50:0.24652327597141266, NDCG@10:0.05396527424454689, NDCG@50:0.0842600017786026
11/30/2023 05:12:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:12:39 - INFO - trainer.finetune_evaluator - Epoch 61 Eval Result: R@10:0.10803559422492981, R@50:0.2452712059020996, NDCG@10:0.054105810821056366, NDCG@50:0.08401072770357132
11/30/2023 05:13:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:13:56 - INFO - trainer.finetune_evaluator - Epoch 62 Eval Result: R@10:0.10763314366340637, R@50:0.24437686800956726, NDCG@10:0.05456145480275154, NDCG@50:0.08448215574026108
11/30/2023 05:15:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:15:13 - INFO - trainer.finetune_evaluator - Epoch 63 Eval Result: R@10:0.10794615745544434, R@50:0.24576307833194733, NDCG@10:0.054489292204380035, NDCG@50:0.08461412042379379
11/30/2023 05:16:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:16:31 - INFO - trainer.finetune_evaluator - Epoch 64 Eval Result: R@10:0.1082591786980629, R@50:0.24352724850177765, NDCG@10:0.05448855459690094, NDCG@50:0.0839313343167305
11/30/2023 05:17:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:17:48 - INFO - trainer.finetune_evaluator - Epoch 65 Eval Result: R@10:0.10834860801696777, R@50:0.2463444024324417, NDCG@10:0.05459165200591087, NDCG@50:0.08471027761697769
11/30/2023 05:18:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:19:06 - INFO - trainer.finetune_evaluator - Epoch 66 Eval Result: R@10:0.10709653794765472, R@50:0.24455572664737701, NDCG@10:0.055083584040403366, NDCG@50:0.0850406289100647
11/30/2023 05:20:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:20:23 - INFO - trainer.finetune_evaluator - Epoch 67 Eval Result: R@10:0.1082591786980629, R@50:0.24683628976345062, NDCG@10:0.05497223883867264, NDCG@50:0.08526792377233505
11/30/2023 05:20:23 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:20:23 - INFO - trainer.finetune_evaluator - ***** Run test *****
11/30/2023 05:20:32 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.09515717625617981, R@50:0.22514867782592773, NDCG@10:0.048165179789066315, NDCG@50:0.07644800841808319
11/30/2023 05:36:28 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/30/2023 05:36:42 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/30/2023 05:36:42 - INFO - trainer.finetune_trainer - ***** Run training *****
11/30/2023 05:36:42 - INFO - trainer.finetune_trainer -   Num examples = 131413
11/30/2023 05:36:42 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/30/2023 05:36:42 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/30/2023 05:36:42 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
11/30/2023 05:36:42 - INFO - trainer.finetune_trainer -   Total steps = 32500
11/30/2023 05:37:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:38:02 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.026069846004247665, R@50:0.07239636778831482, NDCG@10:0.013722044415771961, NDCG@50:0.023653343319892883
11/30/2023 05:38:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:39:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:39:20 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.048651788383722305, R@50:0.13231676816940308, NDCG@10:0.023388255387544632, NDCG@50:0.0414167121052742
11/30/2023 05:39:20 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:40:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:40:39 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.05983097106218338, R@50:0.16044358909130096, NDCG@10:0.02898198552429676, NDCG@50:0.05067005753517151
11/30/2023 05:40:39 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:41:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:41:57 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.06685149669647217, R@50:0.17904573678970337, NDCG@10:0.03314095735549927, NDCG@50:0.05738515406847
11/30/2023 05:41:57 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:43:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:43:15 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.07382730394601822, R@50:0.1907615214586258, NDCG@10:0.03689035400748253, NDCG@50:0.062213413417339325
11/30/2023 05:43:15 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:44:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:44:34 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.07888029515743256, R@50:0.19961543381214142, NDCG@10:0.039707448333501816, NDCG@50:0.0657765343785286
11/30/2023 05:44:34 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:45:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:45:52 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.08120556175708771, R@50:0.2041318267583847, NDCG@10:0.041054464876651764, NDCG@50:0.06760018318891525
11/30/2023 05:45:52 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:47:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:47:10 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.08603496849536896, R@50:0.21097347140312195, NDCG@10:0.042946286499500275, NDCG@50:0.07002817094326019
11/30/2023 05:47:10 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:48:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:48:29 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.08782363682985306, R@50:0.2170102298259735, NDCG@10:0.0443856418132782, NDCG@50:0.07228349149227142
11/30/2023 05:48:29 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:49:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:49:47 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.09122210741043091, R@50:0.21888834238052368, NDCG@10:0.04654339700937271, NDCG@50:0.07406412810087204
11/30/2023 05:49:47 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 9 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:50:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:51:05 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.0900147557258606, R@50:0.221660777926445, NDCG@10:0.04531587287783623, NDCG@50:0.07375029474496841
11/30/2023 05:52:15 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:52:24 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.090730220079422, R@50:0.2241649031639099, NDCG@10:0.04547436907887459, NDCG@50:0.07446323335170746
11/30/2023 05:53:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:53:42 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.09336850792169571, R@50:0.22564056515693665, NDCG@10:0.046476587653160095, NDCG@50:0.07500013709068298
11/30/2023 05:53:42 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 12 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:54:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:55:00 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.0943075567483902, R@50:0.23055939376354218, NDCG@10:0.04781187325716019, NDCG@50:0.07742819935083389
11/30/2023 05:55:00 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 13 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:56:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:56:19 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.09506774693727493, R@50:0.23172204196453094, NDCG@10:0.04824875667691231, NDCG@50:0.07786450535058975
11/30/2023 05:56:19 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 14 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:57:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:57:37 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.09618566185235977, R@50:0.23123015463352203, NDCG@10:0.04886956512928009, NDCG@50:0.07806089520454407
11/30/2023 05:57:37 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 15 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 05:58:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 05:58:55 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.09658811241388321, R@50:0.23154316842556, NDCG@10:0.04861747846007347, NDCG@50:0.07792851328849792
11/30/2023 05:58:55 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 06:00:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:00:14 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.0996735692024231, R@50:0.23534409701824188, NDCG@10:0.049873050302267075, NDCG@50:0.07928099483251572
11/30/2023 06:00:14 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 17 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 06:01:23 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:01:32 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.10123865306377411, R@50:0.23686446249485016, NDCG@10:0.05143023654818535, NDCG@50:0.08076644688844681
11/30/2023 06:01:32 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 06:02:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:02:50 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.10132808238267899, R@50:0.23686446249485016, NDCG@10:0.05145120248198509, NDCG@50:0.08068487793207169
11/30/2023 06:02:50 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 19 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 06:03:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:04:09 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.09837678074836731, R@50:0.2358359694480896, NDCG@10:0.04963170364499092, NDCG@50:0.0794050395488739
11/30/2023 06:05:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:05:27 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.10235656797885895, R@50:0.2386978417634964, NDCG@10:0.05146976187825203, NDCG@50:0.08103451877832413
11/30/2023 06:05:27 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 21 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 06:06:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:06:45 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.10262487083673477, R@50:0.24003934860229492, NDCG@10:0.05178403854370117, NDCG@50:0.08156246691942215
11/30/2023 06:06:45 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 22 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 06:07:54 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:08:04 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.10342977195978165, R@50:0.24129141867160797, NDCG@10:0.05224771425127983, NDCG@50:0.08218753337860107
11/30/2023 06:08:04 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 23 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 06:09:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:09:22 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.10293788462877274, R@50:0.2399051934480667, NDCG@10:0.05224497243762016, NDCG@50:0.08187831193208694
11/30/2023 06:10:31 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:10:40 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.10392165184020996, R@50:0.23708803951740265, NDCG@10:0.052454348653554916, NDCG@50:0.0814116895198822
11/30/2023 06:10:40 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 25 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 06:11:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:11:59 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.10450296849012375, R@50:0.24209631979465485, NDCG@10:0.05236625671386719, NDCG@50:0.08223897963762283
11/30/2023 06:11:59 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 26 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 06:13:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:13:17 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.10284845530986786, R@50:0.2399051934480667, NDCG@10:0.052274029701948166, NDCG@50:0.08208206295967102
11/30/2023 06:14:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:14:35 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.10311675071716309, R@50:0.2426329106092453, NDCG@10:0.052093908190727234, NDCG@50:0.08243311196565628
11/30/2023 06:15:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:15:53 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.10629163682460785, R@50:0.24102310836315155, NDCG@10:0.053593676537275314, NDCG@50:0.08278309553861618
11/30/2023 06:15:53 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 29 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 06:17:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:17:12 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.10553145408630371, R@50:0.24330367147922516, NDCG@10:0.05365854501724243, NDCG@50:0.08356194198131561
11/30/2023 06:18:21 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:18:30 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.10410051792860031, R@50:0.2422751784324646, NDCG@10:0.052549753338098526, NDCG@50:0.08254227787256241
11/30/2023 06:19:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:19:48 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.10369806736707687, R@50:0.23851898312568665, NDCG@10:0.05193353816866875, NDCG@50:0.08117848634719849
11/30/2023 06:20:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:21:07 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.10499485582113266, R@50:0.23994991183280945, NDCG@10:0.05265950784087181, NDCG@50:0.08206450939178467
11/30/2023 06:22:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:22:25 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.10758842527866364, R@50:0.2417832911014557, NDCG@10:0.05475720390677452, NDCG@50:0.08394476771354675
11/30/2023 06:22:25 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 34 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 06:23:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:23:43 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.10530786961317062, R@50:0.24187272787094116, NDCG@10:0.05329651013016701, NDCG@50:0.08306126296520233
11/30/2023 06:24:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:25:02 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.10700710862874985, R@50:0.24231989681720734, NDCG@10:0.054133426398038864, NDCG@50:0.08365169167518616
11/30/2023 06:26:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:26:20 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.10624692589044571, R@50:0.24223046004772186, NDCG@10:0.054167427122592926, NDCG@50:0.08378636837005615
11/30/2023 06:27:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:27:38 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.10517372190952301, R@50:0.24451102316379547, NDCG@10:0.05343986302614212, NDCG@50:0.083846814930439
11/30/2023 06:28:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:28:56 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.1057550385594368, R@50:0.24308007955551147, NDCG@10:0.05328204855322838, NDCG@50:0.08304305374622345
11/30/2023 06:30:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:30:15 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.10714125633239746, R@50:0.2452712059020996, NDCG@10:0.05434342101216316, NDCG@50:0.0843183621764183
11/30/2023 06:31:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:31:33 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.10745427757501602, R@50:0.24231989681720734, NDCG@10:0.05426565930247307, NDCG@50:0.083594411611557
11/30/2023 06:32:42 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:32:51 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.10593390464782715, R@50:0.2456289380788803, NDCG@10:0.05348893627524376, NDCG@50:0.08390732109546661
11/30/2023 06:34:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:34:10 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.10602334141731262, R@50:0.24321423470973969, NDCG@10:0.05353763327002525, NDCG@50:0.0835360735654831
11/30/2023 06:35:19 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:35:28 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.10830388963222504, R@50:0.24558421969413757, NDCG@10:0.05418341979384422, NDCG@50:0.08411316573619843
11/30/2023 06:35:28 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 44 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 06:36:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:36:46 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.10615748912096024, R@50:0.24571837484836578, NDCG@10:0.05275826156139374, NDCG@50:0.08310803025960922
11/30/2023 06:37:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:38:04 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.10571032017469406, R@50:0.2451370507478714, NDCG@10:0.05390959605574608, NDCG@50:0.08438041806221008
11/30/2023 06:39:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:39:23 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.10620220750570297, R@50:0.24285650253295898, NDCG@10:0.05341075733304024, NDCG@50:0.08324070274829865
11/30/2023 06:40:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:40:41 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.10521844029426575, R@50:0.24460044503211975, NDCG@10:0.052434731274843216, NDCG@50:0.08277228474617004
11/30/2023 06:41:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:41:59 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.10655993968248367, R@50:0.2465679794549942, NDCG@10:0.05399784445762634, NDCG@50:0.08456147462129593
11/30/2023 06:43:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:43:18 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.10794615745544434, R@50:0.2416938692331314, NDCG@10:0.054323285818099976, NDCG@50:0.08348751068115234
11/30/2023 06:44:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:44:36 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.10799087584018707, R@50:0.24258819222450256, NDCG@10:0.05453606694936752, NDCG@50:0.08386216312646866
11/30/2023 06:45:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:45:54 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.10772257298231125, R@50:0.24303536117076874, NDCG@10:0.05420122668147087, NDCG@50:0.0838097333908081
11/30/2023 06:47:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:47:12 - INFO - trainer.finetune_evaluator - Epoch 53 Eval Result: R@10:0.10691767185926437, R@50:0.2452712059020996, NDCG@10:0.05381612479686737, NDCG@50:0.08397452533245087
11/30/2023 06:48:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:48:31 - INFO - trainer.finetune_evaluator - Epoch 54 Eval Result: R@10:0.10924294590950012, R@50:0.2441979944705963, NDCG@10:0.05521763488650322, NDCG@50:0.08455917239189148
11/30/2023 06:48:31 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 54 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 06:49:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:49:49 - INFO - trainer.finetune_evaluator - Epoch 55 Eval Result: R@10:0.10723069310188293, R@50:0.24218574166297913, NDCG@10:0.053335439413785934, NDCG@50:0.08282291144132614
11/30/2023 06:50:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:51:07 - INFO - trainer.finetune_evaluator - Epoch 56 Eval Result: R@10:0.1075437068939209, R@50:0.24258819222450256, NDCG@10:0.053209323436021805, NDCG@50:0.08270062506198883
11/30/2023 06:52:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:52:26 - INFO - trainer.finetune_evaluator - Epoch 57 Eval Result: R@10:0.10794615745544434, R@50:0.24196216464042664, NDCG@10:0.054246935993433, NDCG@50:0.08356305956840515
11/30/2023 06:53:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:53:44 - INFO - trainer.finetune_evaluator - Epoch 58 Eval Result: R@10:0.1061127707362175, R@50:0.2426329106092453, NDCG@10:0.0534711517393589, NDCG@50:0.08326606452465057
11/30/2023 06:54:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:55:02 - INFO - trainer.finetune_evaluator - Epoch 59 Eval Result: R@10:0.10638107359409332, R@50:0.24272234737873077, NDCG@10:0.053266771137714386, NDCG@50:0.08304380625486374
11/30/2023 06:56:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:56:20 - INFO - trainer.finetune_evaluator - Epoch 60 Eval Result: R@10:0.10799087584018707, R@50:0.24214103817939758, NDCG@10:0.053747933357954025, NDCG@50:0.08313632011413574
11/30/2023 06:57:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:57:39 - INFO - trainer.finetune_evaluator - Epoch 61 Eval Result: R@10:0.10508428514003754, R@50:0.24088896811008453, NDCG@10:0.05313795804977417, NDCG@50:0.08282937109470367
11/30/2023 06:58:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 06:58:57 - INFO - trainer.finetune_evaluator - Epoch 62 Eval Result: R@10:0.10477127134799957, R@50:0.24366140365600586, NDCG@10:0.05293065309524536, NDCG@50:0.08329689502716064
11/30/2023 07:00:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:00:15 - INFO - trainer.finetune_evaluator - Epoch 63 Eval Result: R@10:0.10906407982110977, R@50:0.24057593941688538, NDCG@10:0.054507944732904434, NDCG@50:0.08317253738641739
11/30/2023 07:01:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:01:34 - INFO - trainer.finetune_evaluator - Epoch 64 Eval Result: R@10:0.10606805980205536, R@50:0.2420516014099121, NDCG@10:0.0535714216530323, NDCG@50:0.08326462656259537
11/30/2023 07:01:34 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:01:34 - INFO - trainer.finetune_evaluator - ***** Run test *****
11/30/2023 07:01:43 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.09564906358718872, R@50:0.2248803824186325, NDCG@10:0.04800576716661453, NDCG@50:0.07615296542644501
11/30/2023 07:10:06 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/30/2023 07:10:28 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/30/2023 07:10:28 - INFO - trainer.finetune_trainer - ***** Run training *****
11/30/2023 07:10:28 - INFO - trainer.finetune_trainer -   Num examples = 131413
11/30/2023 07:10:28 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/30/2023 07:10:28 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/30/2023 07:10:28 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
11/30/2023 07:10:28 - INFO - trainer.finetune_trainer -   Total steps = 32500
11/30/2023 07:11:31 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:11:38 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.032687921077013016, R@50:0.08455931395292282, NDCG@10:0.016203224658966064, NDCG@50:0.02738988772034645
11/30/2023 07:11:38 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:12:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:12:43 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.04744443669915199, R@50:0.13575996458530426, NDCG@10:0.02332804910838604, NDCG@50:0.042381562292575836
11/30/2023 07:12:43 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:13:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:13:49 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.05942852050065994, R@50:0.15695568919181824, NDCG@10:0.029282040894031525, NDCG@50:0.05025111138820648
11/30/2023 07:13:49 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:14:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:14:54 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.06340830773115158, R@50:0.17654161155223846, NDCG@10:0.03141302242875099, NDCG@50:0.05574990436434746
11/30/2023 07:14:54 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:15:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:16:00 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.06886374950408936, R@50:0.18512721359729767, NDCG@10:0.0339629165828228, NDCG@50:0.059071771800518036
11/30/2023 07:16:00 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:16:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:17:05 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.07503465563058853, R@50:0.19187943637371063, NDCG@10:0.037142153829336166, NDCG@50:0.062346477061510086
11/30/2023 07:17:05 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:18:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:18:10 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.07955104112625122, R@50:0.2012699544429779, NDCG@10:0.039133090525865555, NDCG@50:0.06538296490907669
11/30/2023 07:18:10 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:19:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:19:16 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.08411214500665665, R@50:0.20820103585720062, NDCG@10:0.04158851504325867, NDCG@50:0.06845405697822571
11/30/2023 07:19:16 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:20:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:20:21 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.08616911619901657, R@50:0.21133121848106384, NDCG@10:0.0432557612657547, NDCG@50:0.07026505470275879
11/30/2023 07:20:21 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:21:19 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:21:27 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.08639270067214966, R@50:0.21316459774971008, NDCG@10:0.04307058826088905, NDCG@50:0.07042650878429413
11/30/2023 07:21:27 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 9 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:22:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:22:32 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.09023834019899368, R@50:0.21584759652614594, NDCG@10:0.04458656907081604, NDCG@50:0.0716187059879303
11/30/2023 07:22:32 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:23:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:23:37 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.09050663560628891, R@50:0.22148190438747406, NDCG@10:0.04517820104956627, NDCG@50:0.07362218201160431
11/30/2023 07:23:37 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 11 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:24:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:24:43 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.0900147557258606, R@50:0.22031927108764648, NDCG@10:0.0447525717318058, NDCG@50:0.07298853993415833
11/30/2023 07:25:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:25:48 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.0932343602180481, R@50:0.22394132614135742, NDCG@10:0.04676428809762001, NDCG@50:0.07501769065856934
11/30/2023 07:25:48 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 13 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:26:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:26:54 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.0946652963757515, R@50:0.22894960641860962, NDCG@10:0.047550395131111145, NDCG@50:0.07659943401813507
11/30/2023 07:26:54 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 14 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:27:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:27:59 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.09354737401008606, R@50:0.22675848007202148, NDCG@10:0.046944357454776764, NDCG@50:0.07577947527170181
11/30/2023 07:28:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:29:04 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.09757187962532043, R@50:0.2306041121482849, NDCG@10:0.049378424882888794, NDCG@50:0.07814445346593857
11/30/2023 07:29:04 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:30:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:30:10 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.09564906358718872, R@50:0.23158788681030273, NDCG@10:0.047540802508592606, NDCG@50:0.07708249241113663
11/30/2023 07:31:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:31:15 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.0975271612405777, R@50:0.23614898324012756, NDCG@10:0.050044622272253036, NDCG@50:0.08000220358371735
11/30/2023 07:32:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:32:21 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.09918168187141418, R@50:0.2361937016248703, NDCG@10:0.049637969583272934, NDCG@50:0.07924080640077591
11/30/2023 07:32:21 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 19 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:33:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:33:26 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.10088091343641281, R@50:0.23078298568725586, NDCG@10:0.05037986859679222, NDCG@50:0.07846637070178986
11/30/2023 07:33:26 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 20 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:34:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:34:31 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.10047846287488937, R@50:0.23771408200263977, NDCG@10:0.050236962735652924, NDCG@50:0.08003638684749603
11/30/2023 07:35:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:35:37 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.10199883580207825, R@50:0.2374904900789261, NDCG@10:0.05062299221754074, NDCG@50:0.08002571761608124
11/30/2023 07:35:37 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 22 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:36:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:36:42 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.09958413243293762, R@50:0.2366855889558792, NDCG@10:0.049550894647836685, NDCG@50:0.07926612347364426
11/30/2023 07:37:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:37:48 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.10101506859064102, R@50:0.23838482797145844, NDCG@10:0.0504152849316597, NDCG@50:0.08025359362363815
11/30/2023 07:38:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:38:53 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.10128336399793625, R@50:0.23556767404079437, NDCG@10:0.0507393479347229, NDCG@50:0.07985910028219223
11/30/2023 07:39:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:39:59 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.10334033519029617, R@50:0.2410678267478943, NDCG@10:0.05179519206285477, NDCG@50:0.08175626397132874
11/30/2023 07:39:59 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 26 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:40:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:41:04 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.1014622375369072, R@50:0.2409783899784088, NDCG@10:0.050697799772024155, NDCG@50:0.08106376230716705
11/30/2023 07:42:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:42:09 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.10342977195978165, R@50:0.24303536117076874, NDCG@10:0.05158109590411186, NDCG@50:0.08182886242866516
11/30/2023 07:42:09 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 28 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:43:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:43:15 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.10289316624403, R@50:0.24115726351737976, NDCG@10:0.05185452476143837, NDCG@50:0.08191708475351334
11/30/2023 07:44:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:44:20 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.10329561680555344, R@50:0.2440638542175293, NDCG@10:0.05199314281344414, NDCG@50:0.0826616957783699
11/30/2023 07:45:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:45:25 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.10410051792860031, R@50:0.2409783899784088, NDCG@10:0.05195881798863411, NDCG@50:0.08173155039548874
11/30/2023 07:45:25 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 31 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:46:23 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:46:31 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.103608638048172, R@50:0.24473460018634796, NDCG@10:0.05179663375020027, NDCG@50:0.08247825503349304
11/30/2023 07:47:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:47:36 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.10593390464782715, R@50:0.24558421969413757, NDCG@10:0.053193140774965286, NDCG@50:0.08354589343070984
11/30/2023 07:47:36 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 33 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:48:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:48:42 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.10579975694417953, R@50:0.24442158639431, NDCG@10:0.05330948904156685, NDCG@50:0.08342566341161728
11/30/2023 07:49:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:49:47 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.10320618748664856, R@50:0.24361668527126312, NDCG@10:0.05209396034479141, NDCG@50:0.0827772468328476
11/30/2023 07:50:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:50:52 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.1071859747171402, R@50:0.2456289380788803, NDCG@10:0.05355038121342659, NDCG@50:0.08370527625083923
11/30/2023 07:50:52 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 36 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:51:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:51:58 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.10776729136705399, R@50:0.24482403695583344, NDCG@10:0.05385575070977211, NDCG@50:0.08381278067827225
11/30/2023 07:51:58 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 37 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 07:52:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:53:03 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.10602334141731262, R@50:0.2475070357322693, NDCG@10:0.05339870601892471, NDCG@50:0.08429721742868423
11/30/2023 07:54:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:54:09 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.10633635520935059, R@50:0.2438402622938156, NDCG@10:0.05250444635748863, NDCG@50:0.08254221081733704
11/30/2023 07:55:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:55:14 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.10557617247104645, R@50:0.24661269783973694, NDCG@10:0.052994176745414734, NDCG@50:0.08381928503513336
11/30/2023 07:56:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:56:19 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.10664937645196915, R@50:0.24629968404769897, NDCG@10:0.054316870868206024, NDCG@50:0.08479326218366623
11/30/2023 07:57:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:57:25 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.10678352415561676, R@50:0.24710458517074585, NDCG@10:0.054145995527505875, NDCG@50:0.08477339148521423
11/30/2023 07:58:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:58:30 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.10624692589044571, R@50:0.24397441744804382, NDCG@10:0.052981942892074585, NDCG@50:0.08308473974466324
11/30/2023 07:59:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 07:59:36 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.10758842527866364, R@50:0.2487143874168396, NDCG@10:0.05395961180329323, NDCG@50:0.08474505692720413
11/30/2023 08:00:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 08:00:41 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.1075437068939209, R@50:0.2465679794549942, NDCG@10:0.05392520874738693, NDCG@50:0.0844029039144516
11/30/2023 08:01:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 08:01:46 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.10714125633239746, R@50:0.2472834587097168, NDCG@10:0.0542178712785244, NDCG@50:0.08483944088220596
11/30/2023 08:02:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 08:02:52 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.10740955919027328, R@50:0.24661269783973694, NDCG@10:0.054044757038354874, NDCG@50:0.08445277065038681
11/30/2023 08:02:52 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 08:02:52 - INFO - trainer.finetune_evaluator - ***** Run test *****
11/30/2023 08:02:59 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.09310020506381989, R@50:0.221660777926445, NDCG@10:0.04650891199707985, NDCG@50:0.07451867312192917
11/30/2023 09:28:04 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/30/2023 09:28:22 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/30/2023 09:28:22 - INFO - trainer.finetune_trainer - ***** Run training *****
11/30/2023 09:28:22 - INFO - trainer.finetune_trainer -   Num examples = 131413
11/30/2023 09:28:22 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/30/2023 09:28:22 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/30/2023 09:28:22 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
11/30/2023 09:28:22 - INFO - trainer.finetune_trainer -   Total steps = 32500
11/30/2023 09:29:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:29:08 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.03152528777718544, R@50:0.0875106155872345, NDCG@10:0.015970928594470024, NDCG@50:0.028106536716222763
11/30/2023 09:29:08 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:29:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:29:49 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.04556633532047272, R@50:0.13660956919193268, NDCG@10:0.022296126931905746, NDCG@50:0.04192538559436798
11/30/2023 09:29:49 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:30:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:30:30 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.05768456682562828, R@50:0.16008585691452026, NDCG@10:0.028478529304265976, NDCG@50:0.050656579434871674
11/30/2023 09:30:30 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:31:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:31:11 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.06363189220428467, R@50:0.17493180930614471, NDCG@10:0.03098185546696186, NDCG@50:0.05495476350188255
11/30/2023 09:31:11 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:31:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:31:53 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.0696239322423935, R@50:0.1857532560825348, NDCG@10:0.034411631524562836, NDCG@50:0.05945270135998726
11/30/2023 09:31:53 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:32:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:32:34 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.07203863561153412, R@50:0.19250547885894775, NDCG@10:0.035158198326826096, NDCG@50:0.0611194409430027
11/30/2023 09:32:34 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:33:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:33:15 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.07874614000320435, R@50:0.19997316598892212, NDCG@10:0.03893433138728142, NDCG@50:0.06521008163690567
11/30/2023 09:33:15 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:33:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:33:57 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.07941689342260361, R@50:0.2062782198190689, NDCG@10:0.0391392707824707, NDCG@50:0.06675108522176743
11/30/2023 09:33:57 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:34:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:34:38 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.08254706114530563, R@50:0.20618878304958344, NDCG@10:0.04051732271909714, NDCG@50:0.06729941070079803
11/30/2023 09:34:38 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:35:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:35:19 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.08567723631858826, R@50:0.21039216220378876, NDCG@10:0.04318622127175331, NDCG@50:0.07019738852977753
11/30/2023 09:35:19 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 9 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:35:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:36:01 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.08907570689916611, R@50:0.21633948385715485, NDCG@10:0.04420344904065132, NDCG@50:0.07169201225042343
11/30/2023 09:36:01 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:36:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:36:42 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.09166927635669708, R@50:0.22268925607204437, NDCG@10:0.045541148632764816, NDCG@50:0.07383538037538528
11/30/2023 09:36:42 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 11 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:37:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:37:23 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.08920985460281372, R@50:0.21955908834934235, NDCG@10:0.04432350769639015, NDCG@50:0.07255834341049194
11/30/2023 09:37:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:38:04 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.09368152171373367, R@50:0.22675848007202148, NDCG@10:0.04638950154185295, NDCG@50:0.07520303875207901
11/30/2023 09:38:04 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 13 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:38:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:38:46 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.09314492344856262, R@50:0.22264453768730164, NDCG@10:0.046678926795721054, NDCG@50:0.07471924275159836
11/30/2023 09:39:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:39:27 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.09238474071025848, R@50:0.22586414217948914, NDCG@10:0.04631286859512329, NDCG@50:0.07522203773260117
11/30/2023 09:40:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:40:08 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.09399454295635223, R@50:0.22899430990219116, NDCG@10:0.04679686948657036, NDCG@50:0.07599305361509323
11/30/2023 09:40:08 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:40:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:40:49 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.09605151414871216, R@50:0.22854715585708618, NDCG@10:0.04798679053783417, NDCG@50:0.07664452493190765
11/30/2023 09:40:49 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 17 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:41:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:41:31 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.09743773192167282, R@50:0.2334659844636917, NDCG@10:0.04898221045732498, NDCG@50:0.07838374376296997
11/30/2023 09:41:31 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:42:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:42:12 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.09846621751785278, R@50:0.23355542123317719, NDCG@10:0.04887626692652702, NDCG@50:0.07817398011684418
11/30/2023 09:42:12 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 19 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:42:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:42:53 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.09743773192167282, R@50:0.23248222470283508, NDCG@10:0.04891420528292656, NDCG@50:0.07814659178256989
11/30/2023 09:43:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:43:34 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.09815319627523422, R@50:0.23695388436317444, NDCG@10:0.049961261451244354, NDCG@50:0.08010303974151611
11/30/2023 09:44:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:44:16 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.09873451292514801, R@50:0.23699860274791718, NDCG@10:0.04941177740693092, NDCG@50:0.07937296479940414
11/30/2023 09:44:16 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 22 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:44:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:44:57 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.10021016746759415, R@50:0.23601484298706055, NDCG@10:0.05009518191218376, NDCG@50:0.07958938926458359
11/30/2023 09:44:57 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 23 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:45:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:45:38 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.10012073069810867, R@50:0.23793765902519226, NDCG@10:0.049975015223026276, NDCG@50:0.07984860241413116
11/30/2023 09:46:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:46:19 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.10119393467903137, R@50:0.2378482222557068, NDCG@10:0.050005655735731125, NDCG@50:0.07947713881731033
11/30/2023 09:46:19 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 25 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:46:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:47:00 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.10029959678649902, R@50:0.23829539120197296, NDCG@10:0.05043921247124672, NDCG@50:0.08025874197483063
11/30/2023 09:47:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:47:41 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.09953941404819489, R@50:0.23825067281723022, NDCG@10:0.050103556364774704, NDCG@50:0.08021210879087448
11/30/2023 09:48:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:48:22 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.10226713865995407, R@50:0.24254348874092102, NDCG@10:0.05057399719953537, NDCG@50:0.08102376013994217
11/30/2023 09:48:22 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 28 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:48:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:49:04 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.1021777018904686, R@50:0.24035236239433289, NDCG@10:0.05079854279756546, NDCG@50:0.08070284873247147
11/30/2023 09:49:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:49:45 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.10244600474834442, R@50:0.24160443246364594, NDCG@10:0.051260970532894135, NDCG@50:0.08145202696323395
11/30/2023 09:49:45 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 30 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:50:21 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:50:26 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.1025354340672493, R@50:0.24231989681720734, NDCG@10:0.05110746622085571, NDCG@50:0.0815226137638092
11/30/2023 09:50:26 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 31 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:51:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:51:08 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.10284845530986786, R@50:0.24102310836315155, NDCG@10:0.051501378417015076, NDCG@50:0.08150595426559448
11/30/2023 09:51:08 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 32 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:51:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:51:49 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.10445825755596161, R@50:0.241425558924675, NDCG@10:0.051995422691106796, NDCG@50:0.08172207325696945
11/30/2023 09:51:49 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 33 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:52:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:52:30 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.10423467308282852, R@50:0.2424093335866928, NDCG@10:0.05186907947063446, NDCG@50:0.0819065049290657
11/30/2023 09:53:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:53:12 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.10275901854038239, R@50:0.2420516014099121, NDCG@10:0.05078085511922836, NDCG@50:0.08096350729465485
11/30/2023 09:53:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:53:53 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.1032509058713913, R@50:0.24209631979465485, NDCG@10:0.05120415985584259, NDCG@50:0.08135737478733063
11/30/2023 09:54:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:54:34 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.10204355418682098, R@50:0.242990642786026, NDCG@10:0.05095570906996727, NDCG@50:0.08168252557516098
11/30/2023 09:55:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:55:15 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.10566560924053192, R@50:0.24576307833194733, NDCG@10:0.0529203787446022, NDCG@50:0.08330465853214264
11/30/2023 09:55:15 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 38 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:55:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:55:56 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.10499485582113266, R@50:0.2441979944705963, NDCG@10:0.05167208984494209, NDCG@50:0.08193972706794739
11/30/2023 09:56:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:56:38 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.10275901854038239, R@50:0.24643383920192719, NDCG@10:0.05151756852865219, NDCG@50:0.08282376825809479
11/30/2023 09:57:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:57:19 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.10517372190952301, R@50:0.24603138864040375, NDCG@10:0.05316139757633209, NDCG@50:0.08376455307006836
11/30/2023 09:57:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:58:00 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.10517372190952301, R@50:0.24415327608585358, NDCG@10:0.052716583013534546, NDCG@50:0.08297424018383026
11/30/2023 09:58:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:58:42 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.10427938401699066, R@50:0.24594195187091827, NDCG@10:0.05210539326071739, NDCG@50:0.0828741043806076
11/30/2023 09:59:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 09:59:23 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.10593390464782715, R@50:0.2470598667860031, NDCG@10:0.05329739302396774, NDCG@50:0.08387234807014465
11/30/2023 09:59:23 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 44 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 09:59:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:00:04 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.10571032017469406, R@50:0.24683628976345062, NDCG@10:0.05249879136681557, NDCG@50:0.08315613865852356
11/30/2023 10:00:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:00:45 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.10709653794765472, R@50:0.24629968404769897, NDCG@10:0.05325361713767052, NDCG@50:0.08356555551290512
11/30/2023 10:00:45 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 46 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 10:01:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:01:27 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.10593390464782715, R@50:0.24701514840126038, NDCG@10:0.05278182029724121, NDCG@50:0.08344967663288116
11/30/2023 10:02:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:02:08 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.10709653794765472, R@50:0.2472834587097168, NDCG@10:0.053452473133802414, NDCG@50:0.08397466689348221
11/30/2023 10:02:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:02:50 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.10803559422492981, R@50:0.24866966903209686, NDCG@10:0.053819987922906876, NDCG@50:0.08435478061437607
11/30/2023 10:02:50 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 49 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 10:03:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:03:31 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.10512900352478027, R@50:0.2449134737253189, NDCG@10:0.052802082151174545, NDCG@50:0.08318343013525009
11/30/2023 10:04:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:04:12 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.10597862303256989, R@50:0.2470598667860031, NDCG@10:0.052468255162239075, NDCG@50:0.08313121646642685
11/30/2023 10:04:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:04:53 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.10562089085578918, R@50:0.24629968404769897, NDCG@10:0.05269017070531845, NDCG@50:0.08332327753305435
11/30/2023 10:05:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:05:35 - INFO - trainer.finetune_evaluator - Epoch 53 Eval Result: R@10:0.10436882078647614, R@50:0.24688100814819336, NDCG@10:0.052233483642339706, NDCG@50:0.08330167829990387
11/30/2023 10:06:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:06:16 - INFO - trainer.finetune_evaluator - Epoch 54 Eval Result: R@10:0.10606805980205536, R@50:0.24701514840126038, NDCG@10:0.053001243621110916, NDCG@50:0.08371220529079437
11/30/2023 10:06:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:06:57 - INFO - trainer.finetune_evaluator - Epoch 55 Eval Result: R@10:0.10557617247104645, R@50:0.24522648751735687, NDCG@10:0.05282296612858772, NDCG@50:0.08328186720609665
11/30/2023 10:07:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:07:38 - INFO - trainer.finetune_evaluator - Epoch 56 Eval Result: R@10:0.10571032017469406, R@50:0.24647855758666992, NDCG@10:0.05339200794696808, NDCG@50:0.08407571911811829
11/30/2023 10:08:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:08:19 - INFO - trainer.finetune_evaluator - Epoch 57 Eval Result: R@10:0.10633635520935059, R@50:0.24777533113956451, NDCG@10:0.05271545797586441, NDCG@50:0.08355008065700531
11/30/2023 10:08:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:09:01 - INFO - trainer.finetune_evaluator - Epoch 58 Eval Result: R@10:0.10875105857849121, R@50:0.24893797934055328, NDCG@10:0.053580693900585175, NDCG@50:0.08401048928499222
11/30/2023 10:09:01 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 58 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 10:09:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:09:42 - INFO - trainer.finetune_evaluator - Epoch 59 Eval Result: R@10:0.10678352415561676, R@50:0.24567365646362305, NDCG@10:0.0538148507475853, NDCG@50:0.0840519517660141
11/30/2023 10:10:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:10:23 - INFO - trainer.finetune_evaluator - Epoch 60 Eval Result: R@10:0.10584447532892227, R@50:0.2463444024324417, NDCG@10:0.052929818630218506, NDCG@50:0.08355527371168137
11/30/2023 10:10:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:11:04 - INFO - trainer.finetune_evaluator - Epoch 61 Eval Result: R@10:0.10633635520935059, R@50:0.24804364144802094, NDCG@10:0.053074005991220474, NDCG@50:0.08403745293617249
11/30/2023 10:11:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:11:46 - INFO - trainer.finetune_evaluator - Epoch 62 Eval Result: R@10:0.10714125633239746, R@50:0.24679157137870789, NDCG@10:0.053299326449632645, NDCG@50:0.08381766825914383
11/30/2023 10:12:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:12:27 - INFO - trainer.finetune_evaluator - Epoch 63 Eval Result: R@10:0.10669408738613129, R@50:0.24379554390907288, NDCG@10:0.053161803632974625, NDCG@50:0.08307664096355438
11/30/2023 10:13:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:13:08 - INFO - trainer.finetune_evaluator - Epoch 64 Eval Result: R@10:0.10901936143636703, R@50:0.24790948629379272, NDCG@10:0.05394468829035759, NDCG@50:0.08411165326833725
11/30/2023 10:13:08 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 64 to ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 10:13:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:13:50 - INFO - trainer.finetune_evaluator - Epoch 65 Eval Result: R@10:0.1075437068939209, R@50:0.24831193685531616, NDCG@10:0.0535627156496048, NDCG@50:0.08427045494318008
11/30/2023 10:14:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:14:31 - INFO - trainer.finetune_evaluator - Epoch 66 Eval Result: R@10:0.1064705103635788, R@50:0.24710458517074585, NDCG@10:0.05324859544634819, NDCG@50:0.08391726016998291
11/30/2023 10:15:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:15:12 - INFO - trainer.finetune_evaluator - Epoch 67 Eval Result: R@10:0.10727541148662567, R@50:0.24616552889347076, NDCG@10:0.05353514850139618, NDCG@50:0.08385736495256424
11/30/2023 10:15:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:15:54 - INFO - trainer.finetune_evaluator - Epoch 68 Eval Result: R@10:0.10749898850917816, R@50:0.24737288057804108, NDCG@10:0.054146792739629745, NDCG@50:0.08463707566261292
11/30/2023 10:16:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:16:35 - INFO - trainer.finetune_evaluator - Epoch 69 Eval Result: R@10:0.10736484080553055, R@50:0.2479989230632782, NDCG@10:0.05339151620864868, NDCG@50:0.08401951938867569
11/30/2023 10:17:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:17:16 - INFO - trainer.finetune_evaluator - Epoch 70 Eval Result: R@10:0.10687296092510223, R@50:0.24589723348617554, NDCG@10:0.05361832678318024, NDCG@50:0.08406985551118851
11/30/2023 10:17:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:17:58 - INFO - trainer.finetune_evaluator - Epoch 71 Eval Result: R@10:0.10736484080553055, R@50:0.2452712059020996, NDCG@10:0.05371449515223503, NDCG@50:0.08373115211725235
11/30/2023 10:18:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:18:39 - INFO - trainer.finetune_evaluator - Epoch 72 Eval Result: R@10:0.1075437068939209, R@50:0.24486875534057617, NDCG@10:0.05373673513531685, NDCG@50:0.08365738391876221
11/30/2023 10:19:15 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:19:20 - INFO - trainer.finetune_evaluator - Epoch 73 Eval Result: R@10:0.10606805980205536, R@50:0.24558421969413757, NDCG@10:0.05364469811320305, NDCG@50:0.08410423249006271
11/30/2023 10:19:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
11/30/2023 10:20:01 - INFO - trainer.finetune_evaluator - Epoch 74 Eval Result: R@10:0.10892992466688156, R@50:0.2467021346092224, NDCG@10:0.053982384502887726, NDCG@50:0.0840112641453743
11/30/2023 10:20:01 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Beauty-8192batch-ngcf
11/30/2023 10:20:01 - INFO - trainer.finetune_evaluator - ***** Run test *****
11/30/2023 10:20:06 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.09649867564439774, R@50:0.22465679049491882, NDCG@10:0.047468025237321854, NDCG@50:0.07538729161024094
11/30/2023 10:27:11 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/30/2023 10:27:30 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/30/2023 10:27:30 - INFO - trainer.finetune_trainer - ***** Run training *****
11/30/2023 10:27:30 - INFO - trainer.finetune_trainer -   Num examples = 131413
11/30/2023 10:27:30 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/30/2023 10:27:30 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/30/2023 10:27:30 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
11/30/2023 10:27:30 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/01/2023 01:51:55 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/01/2023 01:52:23 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/01/2023 01:52:23 - INFO - trainer.finetune_trainer - ***** Run training *****
12/01/2023 01:52:23 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/01/2023 01:52:23 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/01/2023 01:52:23 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/01/2023 01:52:23 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/01/2023 01:52:23 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/01/2023 01:53:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 01:53:44 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.03080981969833374, R@50:0.08348610997200012, NDCG@10:0.016223231330513954, NDCG@50:0.027620557695627213
12/01/2023 01:53:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 01:54:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 01:54:58 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.04968027397990227, R@50:0.137816920876503, NDCG@10:0.024103408679366112, NDCG@50:0.04316853731870651
12/01/2023 01:54:58 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 01:56:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 01:56:13 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.05853418633341789, R@50:0.1614273488521576, NDCG@10:0.028538502752780914, NDCG@50:0.05082490295171738
12/01/2023 01:56:13 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 01:57:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 01:57:27 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.06416849046945572, R@50:0.17757008969783783, NDCG@10:0.031053222715854645, NDCG@50:0.055470772087574005
12/01/2023 01:57:27 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 01:58:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 01:58:42 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.07181505113840103, R@50:0.18691588938236237, NDCG@10:0.035878222435712814, NDCG@50:0.060696080327034
12/01/2023 01:58:42 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 01:59:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 01:59:56 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.0767786055803299, R@50:0.19657468795776367, NDCG@10:0.038033511489629745, NDCG@50:0.06382260471582413
12/01/2023 01:59:56 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:01:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:01:10 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.07834368944168091, R@50:0.20140409469604492, NDCG@10:0.03887316957116127, NDCG@50:0.06554107367992401
12/01/2023 02:01:10 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:02:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:02:25 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.08218932896852493, R@50:0.20578633248806, NDCG@10:0.04060821607708931, NDCG@50:0.06737852096557617
12/01/2023 02:02:25 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:03:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:03:39 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.08657156676054001, R@50:0.21526628732681274, NDCG@10:0.04321179911494255, NDCG@50:0.0710342526435852
12/01/2023 02:03:39 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:04:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:04:54 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.08585610240697861, R@50:0.21361176669597626, NDCG@10:0.043616123497486115, NDCG@50:0.071248359978199
12/01/2023 02:05:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:06:09 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.08809193223714828, R@50:0.2173679620027542, NDCG@10:0.043729379773139954, NDCG@50:0.07173765450716019
12/01/2023 02:06:09 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:07:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:07:23 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.0889415517449379, R@50:0.22085587680339813, NDCG@10:0.044741202145814896, NDCG@50:0.07334595173597336
12/01/2023 02:07:23 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 11 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:08:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:08:37 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.09166927635669708, R@50:0.22322586178779602, NDCG@10:0.045808278024196625, NDCG@50:0.07433630526065826
12/01/2023 02:08:37 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 12 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:09:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:09:52 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.09479944407939911, R@50:0.22532755136489868, NDCG@10:0.04751476272940636, NDCG@50:0.07580769062042236
12/01/2023 02:09:52 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 13 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:10:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:11:06 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.09403926134109497, R@50:0.22640074789524078, NDCG@10:0.047441933304071426, NDCG@50:0.0761387050151825
12/01/2023 02:12:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:12:21 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.09493359178304672, R@50:0.22550641000270844, NDCG@10:0.047896552830934525, NDCG@50:0.07613413035869598
12/01/2023 02:12:21 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 15 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:13:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:13:35 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.09775074571371078, R@50:0.22979921102523804, NDCG@10:0.04952957481145859, NDCG@50:0.07819665968418121
12/01/2023 02:13:35 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:14:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:14:50 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.09605151414871216, R@50:0.23055939376354218, NDCG@10:0.04819435998797417, NDCG@50:0.07743388414382935
12/01/2023 02:15:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:16:04 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.09882394969463348, R@50:0.23494164645671844, NDCG@10:0.04940522089600563, NDCG@50:0.07900633662939072
12/01/2023 02:16:04 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:17:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:17:18 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.0996735692024231, R@50:0.23328712582588196, NDCG@10:0.04980127513408661, NDCG@50:0.07885438203811646
12/01/2023 02:17:18 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 19 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:18:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:18:33 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.09855564683675766, R@50:0.2346286177635193, NDCG@10:0.04868117347359657, NDCG@50:0.07814577966928482
12/01/2023 02:19:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:19:47 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.0996735692024231, R@50:0.23337654769420624, NDCG@10:0.04916820302605629, NDCG@50:0.07816456258296967
12/01/2023 02:20:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:21:02 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.09877923130989075, R@50:0.2366855889558792, NDCG@10:0.04992527887225151, NDCG@50:0.07986361533403397
12/01/2023 02:22:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:22:16 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.10213298350572586, R@50:0.23865312337875366, NDCG@10:0.0504993237555027, NDCG@50:0.08019370585680008
12/01/2023 02:22:16 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 23 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:23:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:23:31 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.10235656797885895, R@50:0.239547461271286, NDCG@10:0.05129838362336159, NDCG@50:0.08108716458082199
12/01/2023 02:23:31 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 24 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:24:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:24:45 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.10065733641386032, R@50:0.23673030734062195, NDCG@10:0.050502266734838486, NDCG@50:0.08003527671098709
12/01/2023 02:25:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:26:00 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.10150694847106934, R@50:0.2416938692331314, NDCG@10:0.050988905131816864, NDCG@50:0.08142656832933426
12/01/2023 02:27:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:27:14 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.10262487083673477, R@50:0.23994991183280945, NDCG@10:0.05105336010456085, NDCG@50:0.08096726983785629
12/01/2023 02:27:14 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 27 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:28:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:28:29 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.10258015245199203, R@50:0.2431247979402542, NDCG@10:0.0517389290034771, NDCG@50:0.08224876970052719
12/01/2023 02:29:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:29:44 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.10392165184020996, R@50:0.2385636866092682, NDCG@10:0.05176056921482086, NDCG@50:0.08118017017841339
12/01/2023 02:29:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 29 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:30:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:30:58 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.103608638048172, R@50:0.24173858761787415, NDCG@10:0.051550157368183136, NDCG@50:0.08151902258396149
12/01/2023 02:32:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:32:12 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.10579975694417953, R@50:0.24182800948619843, NDCG@10:0.052296895533800125, NDCG@50:0.08177962154150009
12/01/2023 02:32:12 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 31 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:33:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:33:27 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.1053973063826561, R@50:0.24075481295585632, NDCG@10:0.051900628954172134, NDCG@50:0.08135908842086792
12/01/2023 02:34:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:34:41 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.10709653794765472, R@50:0.24339309334754944, NDCG@10:0.052804406732320786, NDCG@50:0.08237429708242416
12/01/2023 02:34:41 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 33 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:35:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:35:56 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.10767785459756851, R@50:0.24209631979465485, NDCG@10:0.05419665202498436, NDCG@50:0.08344385027885437
12/01/2023 02:35:56 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 34 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:37:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:37:11 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.10588918626308441, R@50:0.24254348874092102, NDCG@10:0.05272216722369194, NDCG@50:0.08245941996574402
12/01/2023 02:38:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:38:25 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.10673880577087402, R@50:0.24223046004772186, NDCG@10:0.05335479602217674, NDCG@50:0.082924023270607
12/01/2023 02:39:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:39:40 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.10562089085578918, R@50:0.24486875534057617, NDCG@10:0.05322469025850296, NDCG@50:0.0834929347038269
12/01/2023 02:40:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:40:54 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.10624692589044571, R@50:0.24531592428684235, NDCG@10:0.05302589014172554, NDCG@50:0.08321377635002136
12/01/2023 02:41:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:42:09 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.10620220750570297, R@50:0.24545006453990936, NDCG@10:0.05298065394163132, NDCG@50:0.08325240015983582
12/01/2023 02:43:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:43:23 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.10772257298231125, R@50:0.24433214962482452, NDCG@10:0.053784653544425964, NDCG@50:0.0834498479962349
12/01/2023 02:43:23 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 40 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:44:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:44:38 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.10673880577087402, R@50:0.24661269783973694, NDCG@10:0.054194457828998566, NDCG@50:0.08464030921459198
12/01/2023 02:45:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:45:52 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.10870634019374847, R@50:0.24737288057804108, NDCG@10:0.05489630997180939, NDCG@50:0.08503659069538116
12/01/2023 02:45:52 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 42 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:46:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:47:07 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.10615748912096024, R@50:0.24719402194023132, NDCG@10:0.0529945082962513, NDCG@50:0.0837189257144928
12/01/2023 02:48:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:48:21 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.10606805980205536, R@50:0.24504761397838593, NDCG@10:0.05334129557013512, NDCG@50:0.08360660821199417
12/01/2023 02:49:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:49:36 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.10696239024400711, R@50:0.24755175411701202, NDCG@10:0.05384751036763191, NDCG@50:0.08451484143733978
12/01/2023 02:50:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:50:50 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.10660465806722641, R@50:0.24786476790905, NDCG@10:0.05378229171037674, NDCG@50:0.08452390134334564
12/01/2023 02:51:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:52:05 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.10615748912096024, R@50:0.2456289380788803, NDCG@10:0.05354065075516701, NDCG@50:0.08404664695262909
12/01/2023 02:53:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:53:19 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.1064705103635788, R@50:0.24759647250175476, NDCG@10:0.053028449416160583, NDCG@50:0.08386201411485672
12/01/2023 02:54:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:54:34 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.109332375228405, R@50:0.24719402194023132, NDCG@10:0.054455067962408066, NDCG@50:0.08455134183168411
12/01/2023 02:54:34 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 49 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 02:55:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:55:48 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.1075437068939209, R@50:0.24433214962482452, NDCG@10:0.05400529503822327, NDCG@50:0.08376885950565338
12/01/2023 02:56:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:57:03 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.10884049534797668, R@50:0.24679157137870789, NDCG@10:0.0539650097489357, NDCG@50:0.08396948128938675
12/01/2023 02:58:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:58:17 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.10799087584018707, R@50:0.24580779671669006, NDCG@10:0.05438655614852905, NDCG@50:0.08443629741668701
12/01/2023 02:59:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 02:59:32 - INFO - trainer.finetune_evaluator - Epoch 53 Eval Result: R@10:0.1079014390707016, R@50:0.24866966903209686, NDCG@10:0.054454825818538666, NDCG@50:0.08522418886423111
12/01/2023 03:00:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:00:46 - INFO - trainer.finetune_evaluator - Epoch 54 Eval Result: R@10:0.10736484080553055, R@50:0.2446451634168625, NDCG@10:0.054573554545640945, NDCG@50:0.08468155562877655
12/01/2023 03:01:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:02:01 - INFO - trainer.finetune_evaluator - Epoch 55 Eval Result: R@10:0.10830388963222504, R@50:0.24746231734752655, NDCG@10:0.054061409085989, NDCG@50:0.0844164490699768
12/01/2023 03:03:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:03:15 - INFO - trainer.finetune_evaluator - Epoch 56 Eval Result: R@10:0.1089746430516243, R@50:0.24482403695583344, NDCG@10:0.05477020889520645, NDCG@50:0.08436385542154312
12/01/2023 03:04:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:04:30 - INFO - trainer.finetune_evaluator - Epoch 57 Eval Result: R@10:0.1075437068939209, R@50:0.24612082540988922, NDCG@10:0.05437380075454712, NDCG@50:0.08469582349061966
12/01/2023 03:05:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:05:44 - INFO - trainer.finetune_evaluator - Epoch 58 Eval Result: R@10:0.10857219249010086, R@50:0.24625496566295624, NDCG@10:0.055018987506628036, NDCG@50:0.08510714024305344
12/01/2023 03:06:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:06:59 - INFO - trainer.finetune_evaluator - Epoch 59 Eval Result: R@10:0.10857219249010086, R@50:0.24683628976345062, NDCG@10:0.05506609380245209, NDCG@50:0.08524265140295029
12/01/2023 03:06:59 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 03:06:59 - INFO - trainer.finetune_evaluator - ***** Run test *****
12/01/2023 03:07:08 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.09345794469118118, R@50:0.225103959441185, NDCG@10:0.04703629016876221, NDCG@50:0.07577826082706451
12/01/2023 03:46:59 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/01/2023 03:47:21 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/01/2023 03:47:21 - INFO - trainer.finetune_trainer - ***** Run training *****
12/01/2023 03:47:21 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/01/2023 03:47:21 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/01/2023 03:47:21 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/01/2023 03:47:21 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/01/2023 03:47:21 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/01/2023 03:48:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:48:53 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.03170415386557579, R@50:0.08983588963747025, NDCG@10:0.016153089702129364, NDCG@50:0.02878141961991787
12/01/2023 03:48:53 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 03:50:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:50:18 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.04731028899550438, R@50:0.13531279563903809, NDCG@10:0.022834356874227524, NDCG@50:0.041834235191345215
12/01/2023 03:50:18 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 03:51:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:51:44 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.05826588347554207, R@50:0.16388677060604095, NDCG@10:0.02903999388217926, NDCG@50:0.05185727775096893
12/01/2023 03:51:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 03:53:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:53:10 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.06600187718868256, R@50:0.1803872436285019, NDCG@10:0.0322999469935894, NDCG@50:0.05706006661057472
12/01/2023 03:53:10 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 03:54:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:54:35 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.06966865062713623, R@50:0.18857039511203766, NDCG@10:0.03470035269856453, NDCG@50:0.06037246063351631
12/01/2023 03:54:35 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 03:55:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:56:01 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.0767786055803299, R@50:0.19693243503570557, NDCG@10:0.037954457104206085, NDCG@50:0.0638766661286354
12/01/2023 03:56:01 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 03:57:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:57:27 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.08116084337234497, R@50:0.2005544900894165, NDCG@10:0.04000052437186241, NDCG@50:0.06588447093963623
12/01/2023 03:57:27 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 03:58:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 03:58:53 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.08563251793384552, R@50:0.20681482553482056, NDCG@10:0.043017223477363586, NDCG@50:0.06921401619911194
12/01/2023 03:58:53 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:00:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:00:18 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.08549836277961731, R@50:0.2111523449420929, NDCG@10:0.042840808629989624, NDCG@50:0.0699978768825531
12/01/2023 04:01:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:01:44 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.0875106155872345, R@50:0.21374592185020447, NDCG@10:0.044818099588155746, NDCG@50:0.07212841510772705
12/01/2023 04:01:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 9 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:03:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:03:10 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.09104324132204056, R@50:0.21969324350357056, NDCG@10:0.045642681419849396, NDCG@50:0.0734206810593605
12/01/2023 04:03:10 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:04:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:04:36 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.0900147557258606, R@50:0.22246567904949188, NDCG@10:0.04467801749706268, NDCG@50:0.07326336205005646
12/01/2023 04:05:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:06:01 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.09256360679864883, R@50:0.2198721021413803, NDCG@10:0.04592876881361008, NDCG@50:0.07355259358882904
12/01/2023 04:06:01 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 12 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:07:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:07:27 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.09283190965652466, R@50:0.22577470541000366, NDCG@10:0.0462750568985939, NDCG@50:0.07508902996778488
12/01/2023 04:07:27 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 13 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:08:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:08:53 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.0953807607293129, R@50:0.22693735361099243, NDCG@10:0.04797009378671646, NDCG@50:0.07644147425889969
12/01/2023 04:08:53 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 14 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:10:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:10:19 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.09372624009847641, R@50:0.22671376168727875, NDCG@10:0.04704826697707176, NDCG@50:0.0759345218539238
12/01/2023 04:11:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:11:44 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.09766131639480591, R@50:0.23199033737182617, NDCG@10:0.04905368387699127, NDCG@50:0.078152596950531
12/01/2023 04:11:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:13:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:13:10 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.0964539647102356, R@50:0.22912846505641937, NDCG@10:0.04827651381492615, NDCG@50:0.07707980275154114
12/01/2023 04:14:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:14:36 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.09882394969463348, R@50:0.23391315340995789, NDCG@10:0.04997192695736885, NDCG@50:0.07919511944055557
12/01/2023 04:14:36 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:15:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:16:02 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.10128336399793625, R@50:0.2370433211326599, NDCG@10:0.050514500588178635, NDCG@50:0.0799163430929184
12/01/2023 04:16:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 19 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:17:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:17:27 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.10208826512098312, R@50:0.2358359694480896, NDCG@10:0.05139210820198059, NDCG@50:0.08018843829631805
12/01/2023 04:17:27 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 20 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:18:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:18:53 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.10092563182115555, R@50:0.2347627729177475, NDCG@10:0.050238266587257385, NDCG@50:0.07936803251504898
12/01/2023 04:20:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:20:19 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.10231184959411621, R@50:0.23766936361789703, NDCG@10:0.0506620779633522, NDCG@50:0.07996790111064911
12/01/2023 04:20:19 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 22 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:21:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:21:45 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.10159638524055481, R@50:0.23878727853298187, NDCG@10:0.051641665399074554, NDCG@50:0.08139669895172119
12/01/2023 04:23:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:23:10 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.10029959678649902, R@50:0.23914501070976257, NDCG@10:0.050053250044584274, NDCG@50:0.08020522445440292
12/01/2023 04:24:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:24:36 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.10280373692512512, R@50:0.2374010533094406, NDCG@10:0.05105540528893471, NDCG@50:0.08037687093019485
12/01/2023 04:24:36 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 25 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:25:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:26:02 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.10302732139825821, R@50:0.2369091808795929, NDCG@10:0.05163221061229706, NDCG@50:0.08072302490472794
12/01/2023 04:26:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 26 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:27:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:27:28 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.10436882078647614, R@50:0.23892143368721008, NDCG@10:0.05237487331032753, NDCG@50:0.08163890987634659
12/01/2023 04:27:28 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 27 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:28:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:28:54 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.10423467308282852, R@50:0.23878727853298187, NDCG@10:0.052613355219364166, NDCG@50:0.0818091630935669
12/01/2023 04:30:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:30:19 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.10347449034452438, R@50:0.24111254513263702, NDCG@10:0.051658712327480316, NDCG@50:0.08147259056568146
12/01/2023 04:31:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:31:45 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.10369806736707687, R@50:0.23950274288654327, NDCG@10:0.05168164148926735, NDCG@50:0.08126892149448395
12/01/2023 04:33:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:33:11 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.1043241024017334, R@50:0.23771408200263977, NDCG@10:0.05220557749271393, NDCG@50:0.08114271610975266
12/01/2023 04:34:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:34:36 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.10463712364435196, R@50:0.2408442497253418, NDCG@10:0.05324774235486984, NDCG@50:0.08294117450714111
12/01/2023 04:34:36 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 32 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:35:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:36:02 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.1068282425403595, R@50:0.24236461520195007, NDCG@10:0.05365205556154251, NDCG@50:0.08315528184175491
12/01/2023 04:36:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 33 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:37:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:37:28 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.1071859747171402, R@50:0.24285650253295898, NDCG@10:0.05395406857132912, NDCG@50:0.08347315341234207
12/01/2023 04:37:28 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 34 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:38:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:38:54 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.1053973063826561, R@50:0.24124670028686523, NDCG@10:0.053378473967313766, NDCG@50:0.0829029530286789
12/01/2023 04:40:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:40:20 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.10624692589044571, R@50:0.24451102316379547, NDCG@10:0.05371754616498947, NDCG@50:0.08370742946863174
12/01/2023 04:41:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:41:45 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.10629163682460785, R@50:0.2438402622938156, NDCG@10:0.053612519055604935, NDCG@50:0.08349499106407166
12/01/2023 04:43:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:43:11 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.10584447532892227, R@50:0.2449134737253189, NDCG@10:0.05389685928821564, NDCG@50:0.08415026217699051
12/01/2023 04:44:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:44:37 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.10463712364435196, R@50:0.24325895309448242, NDCG@10:0.05323047190904617, NDCG@50:0.08345238864421844
12/01/2023 04:45:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:46:02 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.10316146910190582, R@50:0.24129141867160797, NDCG@10:0.05301186814904213, NDCG@50:0.08312175422906876
12/01/2023 04:47:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:47:28 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.10427938401699066, R@50:0.24129141867160797, NDCG@10:0.05287782475352287, NDCG@50:0.08279798179864883
12/01/2023 04:48:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:48:54 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.10696239024400711, R@50:0.2439296990633011, NDCG@10:0.054059140384197235, NDCG@50:0.08389899134635925
12/01/2023 04:50:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:50:20 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.10651522129774094, R@50:0.24589723348617554, NDCG@10:0.053242236375808716, NDCG@50:0.08356822282075882
12/01/2023 04:51:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:51:46 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.10808030515909195, R@50:0.24486875534057617, NDCG@10:0.0548371821641922, NDCG@50:0.08460807055234909
12/01/2023 04:51:46 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 44 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 04:53:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:53:11 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.10597862303256989, R@50:0.24504761397838593, NDCG@10:0.05381515622138977, NDCG@50:0.08409399539232254
12/01/2023 04:54:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:54:37 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.10687296092510223, R@50:0.2427670657634735, NDCG@10:0.054170768707990646, NDCG@50:0.08382958173751831
12/01/2023 04:55:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:56:03 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.10459240525960922, R@50:0.24446630477905273, NDCG@10:0.05262334644794464, NDCG@50:0.08315244317054749
12/01/2023 04:57:19 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:57:29 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.10535258799791336, R@50:0.24451102316379547, NDCG@10:0.05316359922289848, NDCG@50:0.08350148797035217
12/01/2023 04:58:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 04:58:54 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.10799087584018707, R@50:0.24607610702514648, NDCG@10:0.05485014244914055, NDCG@50:0.08491260558366776
12/01/2023 05:00:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:00:20 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.10629163682460785, R@50:0.2431247979402542, NDCG@10:0.05385413020849228, NDCG@50:0.08363775163888931
12/01/2023 05:01:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:01:46 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.10852747410535812, R@50:0.2441979944705963, NDCG@10:0.055077679455280304, NDCG@50:0.08450062572956085
12/01/2023 05:01:46 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 51 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:03:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:03:12 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.10973482578992844, R@50:0.2453606277704239, NDCG@10:0.055793922394514084, NDCG@50:0.08535588532686234
12/01/2023 05:03:12 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 52 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:04:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:04:37 - INFO - trainer.finetune_evaluator - Epoch 53 Eval Result: R@10:0.10544202476739883, R@50:0.24147027730941772, NDCG@10:0.05373267084360123, NDCG@50:0.08336659520864487
12/01/2023 05:05:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:06:03 - INFO - trainer.finetune_evaluator - Epoch 54 Eval Result: R@10:0.10714125633239746, R@50:0.24281178414821625, NDCG@10:0.05485718324780464, NDCG@50:0.08450653403997421
12/01/2023 05:07:19 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:07:29 - INFO - trainer.finetune_evaluator - Epoch 55 Eval Result: R@10:0.10803559422492981, R@50:0.24308007955551147, NDCG@10:0.05420277640223503, NDCG@50:0.08358274400234222
12/01/2023 05:08:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:08:55 - INFO - trainer.finetune_evaluator - Epoch 56 Eval Result: R@10:0.1068282425403595, R@50:0.24375082552433014, NDCG@10:0.05422058701515198, NDCG@50:0.08405820280313492
12/01/2023 05:10:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:10:20 - INFO - trainer.finetune_evaluator - Epoch 57 Eval Result: R@10:0.10696239024400711, R@50:0.24361668527126312, NDCG@10:0.0532006174325943, NDCG@50:0.0831165462732315
12/01/2023 05:11:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:11:46 - INFO - trainer.finetune_evaluator - Epoch 58 Eval Result: R@10:0.10772257298231125, R@50:0.2441979944705963, NDCG@10:0.054530128836631775, NDCG@50:0.08433419466018677
12/01/2023 05:13:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:13:12 - INFO - trainer.finetune_evaluator - Epoch 59 Eval Result: R@10:0.10691767185926437, R@50:0.24357196688652039, NDCG@10:0.05442148074507713, NDCG@50:0.08426014333963394
12/01/2023 05:14:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:14:38 - INFO - trainer.finetune_evaluator - Epoch 60 Eval Result: R@10:0.1089746430516243, R@50:0.24558421969413757, NDCG@10:0.0556396059691906, NDCG@50:0.08541111648082733
12/01/2023 05:15:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:16:03 - INFO - trainer.finetune_evaluator - Epoch 61 Eval Result: R@10:0.10772257298231125, R@50:0.2452712059020996, NDCG@10:0.054698698222637177, NDCG@50:0.08469854295253754
12/01/2023 05:17:19 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:17:29 - INFO - trainer.finetune_evaluator - Epoch 62 Eval Result: R@10:0.10776729136705399, R@50:0.24187272787094116, NDCG@10:0.05435711890459061, NDCG@50:0.08366671949625015
12/01/2023 05:17:29 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:17:29 - INFO - trainer.finetune_evaluator - ***** Run test *****
12/01/2023 05:17:39 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.09269775450229645, R@50:0.22170549631118774, NDCG@10:0.045909587293863297, NDCG@50:0.07412935048341751
12/01/2023 05:23:09 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/01/2023 05:23:33 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/01/2023 05:23:33 - INFO - trainer.finetune_trainer - ***** Run training *****
12/01/2023 05:23:33 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/01/2023 05:23:33 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/01/2023 05:23:33 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/01/2023 05:23:33 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/01/2023 05:23:33 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/01/2023 05:25:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:25:11 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.024773061275482178, R@50:0.06886374950408936, NDCG@10:0.013049396686255932, NDCG@50:0.02246086485683918
12/01/2023 05:25:11 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:26:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:26:44 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.04574520140886307, R@50:0.12976792454719543, NDCG@10:0.022095948457717896, NDCG@50:0.0402357280254364
12/01/2023 05:26:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:28:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:28:17 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.058668334037065506, R@50:0.15937037765979767, NDCG@10:0.02916179597377777, NDCG@50:0.05090925097465515
12/01/2023 05:28:17 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:29:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:29:50 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.06703036278486252, R@50:0.18235477805137634, NDCG@10:0.03305262327194214, NDCG@50:0.05781463533639908
12/01/2023 05:29:50 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:31:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:31:23 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.0726199522614479, R@50:0.18781021237373352, NDCG@10:0.03626188635826111, NDCG@50:0.06116360053420067
12/01/2023 05:31:23 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:32:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:32:56 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.07615257054567337, R@50:0.1982739269733429, NDCG@10:0.03766873851418495, NDCG@50:0.06413155049085617
12/01/2023 05:32:56 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:34:19 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:34:29 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.08232347667217255, R@50:0.20516030490398407, NDCG@10:0.04023551195859909, NDCG@50:0.06677167862653732
12/01/2023 05:34:29 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:35:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:36:02 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.08612439781427383, R@50:0.2091400921344757, NDCG@10:0.0431174673140049, NDCG@50:0.06968201696872711
12/01/2023 05:36:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:37:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:37:35 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.08710816502571106, R@50:0.2112865000963211, NDCG@10:0.04365795478224754, NDCG@50:0.07058898359537125
12/01/2023 05:37:35 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:38:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:39:09 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.08804722130298615, R@50:0.21696551144123077, NDCG@10:0.04433233663439751, NDCG@50:0.07225832343101501
12/01/2023 05:39:09 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 9 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:40:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:40:42 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.09184814244508743, R@50:0.22291284799575806, NDCG@10:0.046444982290267944, NDCG@50:0.07468556612730026
12/01/2023 05:40:42 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:42:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:42:15 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.09166927635669708, R@50:0.2233152985572815, NDCG@10:0.04635041207075119, NDCG@50:0.07491609454154968
12/01/2023 05:43:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:43:48 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.0957384929060936, R@50:0.2213924676179886, NDCG@10:0.04780587926506996, NDCG@50:0.07500342279672623
12/01/2023 05:43:48 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 12 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:45:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:45:21 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.0946652963757515, R@50:0.22505924105644226, NDCG@10:0.04765995591878891, NDCG@50:0.07597505301237106
12/01/2023 05:46:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:46:55 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.09578321129083633, R@50:0.22899430990219116, NDCG@10:0.048181068152189255, NDCG@50:0.07701916247606277
12/01/2023 05:46:55 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 14 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:48:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:48:28 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.09547019749879837, R@50:0.2288154512643814, NDCG@10:0.04791325330734253, NDCG@50:0.07683444023132324
12/01/2023 05:49:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:50:01 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.09766131639480591, R@50:0.2326163649559021, NDCG@10:0.049497805535793304, NDCG@50:0.07873020321130753
12/01/2023 05:50:01 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:51:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:51:34 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.09918168187141418, R@50:0.2361937016248703, NDCG@10:0.050564948469400406, NDCG@50:0.08041546493768692
12/01/2023 05:51:34 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 17 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:52:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:53:08 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.10065733641386032, R@50:0.2376246452331543, NDCG@10:0.05134935677051544, NDCG@50:0.08099176734685898
12/01/2023 05:53:08 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:54:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:54:41 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.10173053294420242, R@50:0.23771408200263977, NDCG@10:0.05111061409115791, NDCG@50:0.08055758476257324
12/01/2023 05:54:41 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 19 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 05:56:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:56:14 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.1007467657327652, R@50:0.23485220968723297, NDCG@10:0.05052797496318817, NDCG@50:0.07967671006917953
12/01/2023 05:57:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:57:47 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.10079148411750793, R@50:0.23972633481025696, NDCG@10:0.05031569302082062, NDCG@50:0.08047851175069809
12/01/2023 05:59:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 05:59:20 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.10128336399793625, R@50:0.23901085555553436, NDCG@10:0.05094318464398384, NDCG@50:0.080841563642025
12/01/2023 06:00:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:00:53 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.1014622375369072, R@50:0.23878727853298187, NDCG@10:0.050832975655794144, NDCG@50:0.08069071173667908
12/01/2023 06:02:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:02:26 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.10034431517124176, R@50:0.23927916586399078, NDCG@10:0.05035169795155525, NDCG@50:0.08062530308961868
12/01/2023 06:03:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:04:00 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.10374278575181961, R@50:0.23972633481025696, NDCG@10:0.051966678351163864, NDCG@50:0.08149106800556183
12/01/2023 06:04:00 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 25 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 06:05:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:05:33 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.10289316624403, R@50:0.24066537618637085, NDCG@10:0.051814090460538864, NDCG@50:0.08176363259553909
12/01/2023 06:06:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:07:06 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.10441353917121887, R@50:0.2402629256248474, NDCG@10:0.051971327513456345, NDCG@50:0.08162838220596313
12/01/2023 06:07:06 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 27 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 06:08:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:08:39 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.10190939903259277, R@50:0.2413361370563507, NDCG@10:0.05079907551407814, NDCG@50:0.08115832507610321
12/01/2023 06:10:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:10:12 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.10450296849012375, R@50:0.24030764400959015, NDCG@10:0.0529789961874485, NDCG@50:0.08257310092449188
12/01/2023 06:10:12 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 29 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 06:11:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:11:45 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.10450296849012375, R@50:0.24267762899398804, NDCG@10:0.05307978764176369, NDCG@50:0.08313097059726715
12/01/2023 06:13:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:13:18 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.10499485582113266, R@50:0.2416938692331314, NDCG@10:0.05262511596083641, NDCG@50:0.08232339471578598
12/01/2023 06:13:18 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 31 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 06:14:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:14:52 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.10486070811748505, R@50:0.2417832911014557, NDCG@10:0.05298764258623123, NDCG@50:0.08281224966049194
12/01/2023 06:16:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:16:25 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.10562089085578918, R@50:0.24102310836315155, NDCG@10:0.05303727090358734, NDCG@50:0.08256860077381134
12/01/2023 06:16:25 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 33 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 06:17:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:17:58 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.10651522129774094, R@50:0.24446630477905273, NDCG@10:0.05407445505261421, NDCG@50:0.08410631120204926
12/01/2023 06:17:58 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 34 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 06:19:21 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:19:31 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.1061127707362175, R@50:0.24446630477905273, NDCG@10:0.053157392889261246, NDCG@50:0.08325368165969849
12/01/2023 06:20:54 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:21:04 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.10602334141731262, R@50:0.24285650253295898, NDCG@10:0.05376654863357544, NDCG@50:0.08358504623174667
12/01/2023 06:22:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:22:37 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.10633635520935059, R@50:0.24151499569416046, NDCG@10:0.05310541391372681, NDCG@50:0.08268218487501144
12/01/2023 06:24:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:24:11 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.10727541148662567, R@50:0.2458525151014328, NDCG@10:0.05437305197119713, NDCG@50:0.08460547775030136
12/01/2023 06:24:11 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 38 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 06:25:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:25:44 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.1061127707362175, R@50:0.24285650253295898, NDCG@10:0.053279194980859756, NDCG@50:0.08313372731208801
12/01/2023 06:27:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:27:17 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.103608638048172, R@50:0.24209631979465485, NDCG@10:0.05226188898086548, NDCG@50:0.08238247781991959
12/01/2023 06:28:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:28:50 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.10669408738613129, R@50:0.24254348874092102, NDCG@10:0.05425682291388512, NDCG@50:0.08394195139408112
12/01/2023 06:30:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:30:23 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.10727541148662567, R@50:0.24571837484836578, NDCG@10:0.05390913784503937, NDCG@50:0.08410109579563141
12/01/2023 06:31:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:31:57 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.10870634019374847, R@50:0.24647855758666992, NDCG@10:0.055171795189380646, NDCG@50:0.08518754690885544
12/01/2023 06:31:57 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 43 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 06:33:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:33:30 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.10839332640171051, R@50:0.24325895309448242, NDCG@10:0.05393249914050102, NDCG@50:0.08339165896177292
12/01/2023 06:34:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:35:03 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.10736484080553055, R@50:0.24285650253295898, NDCG@10:0.05417396500706673, NDCG@50:0.08373594284057617
12/01/2023 06:36:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:36:36 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.10852747410535812, R@50:0.24509233236312866, NDCG@10:0.05436123535037041, NDCG@50:0.08418171852827072
12/01/2023 06:37:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:38:09 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.10441353917121887, R@50:0.24357196688652039, NDCG@10:0.05232175812125206, NDCG@50:0.08272716403007507
12/01/2023 06:39:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:39:42 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.10512900352478027, R@50:0.24330367147922516, NDCG@10:0.052722636610269547, NDCG@50:0.08280430734157562
12/01/2023 06:41:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:41:16 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.10785672813653946, R@50:0.24495817720890045, NDCG@10:0.05410156399011612, NDCG@50:0.08403448760509491
12/01/2023 06:42:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:42:49 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.10781200975179672, R@50:0.24442158639431, NDCG@10:0.05394534021615982, NDCG@50:0.08372081816196442
12/01/2023 06:44:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:44:22 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.10866162925958633, R@50:0.2452712059020996, NDCG@10:0.05466456711292267, NDCG@50:0.0845191702246666
12/01/2023 06:45:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:45:55 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.1086169108748436, R@50:0.2446451634168625, NDCG@10:0.05454842001199722, NDCG@50:0.08418338000774384
12/01/2023 06:47:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 06:47:28 - INFO - trainer.finetune_evaluator - Epoch 53 Eval Result: R@10:0.10579975694417953, R@50:0.24281178414821625, NDCG@10:0.053602561354637146, NDCG@50:0.08354673534631729
12/01/2023 06:47:28 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 06:47:28 - INFO - trainer.finetune_evaluator - ***** Run test *****
12/01/2023 06:47:39 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.09488887339830399, R@50:0.22501452267169952, NDCG@10:0.047990940511226654, NDCG@50:0.07627030462026596
12/01/2023 08:52:08 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/01/2023 08:52:33 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/01/2023 08:52:33 - INFO - trainer.finetune_trainer - ***** Run training *****
12/01/2023 08:52:33 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/01/2023 08:52:33 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/01/2023 08:52:33 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/01/2023 08:52:33 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/01/2023 08:52:33 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/01/2023 09:01:18 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/01/2023 09:01:51 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/01/2023 09:01:51 - INFO - trainer.finetune_trainer - ***** Run training *****
12/01/2023 09:01:51 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/01/2023 09:01:51 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/01/2023 09:01:51 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/01/2023 09:01:51 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/01/2023 09:01:51 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/01/2023 09:03:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:21:16 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/01/2023 09:21:42 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/01/2023 09:21:42 - INFO - trainer.finetune_trainer - ***** Run training *****
12/01/2023 09:21:42 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/01/2023 09:21:42 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/01/2023 09:21:42 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/01/2023 09:21:42 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/01/2023 09:21:42 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/01/2023 09:23:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:23:50 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.03174886852502823, R@50:0.08666100353002548, NDCG@10:0.016433123499155045, NDCG@50:0.028249360620975494
12/01/2023 09:23:50 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 09:25:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:25:54 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.04449313506484032, R@50:0.12176362425088882, NDCG@10:0.02197827771306038, NDCG@50:0.03866947069764137
12/01/2023 09:25:54 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 09:27:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:27:58 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.05495684593915939, R@50:0.15852077305316925, NDCG@10:0.02719349041581154, NDCG@50:0.04952479898929596
12/01/2023 09:27:58 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 09:29:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:30:02 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.06211152300238609, R@50:0.17166748642921448, NDCG@10:0.030499637126922607, NDCG@50:0.054171495139598846
12/01/2023 09:30:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 09:31:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:32:06 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.06694092601537704, R@50:0.17877744138240814, NDCG@10:0.03285439684987068, NDCG@50:0.056973204016685486
12/01/2023 09:32:06 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 09:33:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:34:10 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.07293296605348587, R@50:0.19331037998199463, NDCG@10:0.03601933270692825, NDCG@50:0.062054745852947235
12/01/2023 09:34:10 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 09:36:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:36:14 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.07950632274150848, R@50:0.20180654525756836, NDCG@10:0.039067063480615616, NDCG@50:0.06543240696191788
12/01/2023 09:36:14 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 09:38:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:38:17 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.08196574449539185, R@50:0.20703840255737305, NDCG@10:0.041102051734924316, NDCG@50:0.06812455505132675
12/01/2023 09:38:17 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 09:40:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:40:22 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.07919330894947052, R@50:0.20453427731990814, NDCG@10:0.03911412134766579, NDCG@50:0.06616358458995819
12/01/2023 09:42:15 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:42:26 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.0860796868801117, R@50:0.21137592196464539, NDCG@10:0.04366443306207657, NDCG@50:0.07077587395906448
12/01/2023 09:42:26 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 9 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 09:44:19 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:44:30 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.08903098851442337, R@50:0.21598175168037415, NDCG@10:0.044272519648075104, NDCG@50:0.0716494768857956
12/01/2023 09:44:30 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 09:46:23 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:46:34 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.08880740404129028, R@50:0.22031927108764648, NDCG@10:0.044223882257938385, NDCG@50:0.07270998507738113
12/01/2023 09:48:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:48:37 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.09068550169467926, R@50:0.21969324350357056, NDCG@10:0.04501315951347351, NDCG@50:0.07291236519813538
12/01/2023 09:48:37 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 12 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 09:50:31 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:50:41 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.08943343907594681, R@50:0.21982738375663757, NDCG@10:0.04457138851284981, NDCG@50:0.07294733822345734
12/01/2023 09:52:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:52:45 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.09229530394077301, R@50:0.22072172164916992, NDCG@10:0.046000950038433075, NDCG@50:0.07378215342760086
12/01/2023 09:52:45 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 14 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 09:54:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:54:49 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.09497831016778946, R@50:0.22590886056423187, NDCG@10:0.046463385224342346, NDCG@50:0.07483527809381485
12/01/2023 09:54:49 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 15 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 09:56:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:56:53 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.09471000730991364, R@50:0.2278316766023636, NDCG@10:0.046498071402311325, NDCG@50:0.07533198595046997
12/01/2023 09:58:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 09:58:57 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.09439699351787567, R@50:0.22532755136489868, NDCG@10:0.0464928112924099, NDCG@50:0.07489872723817825
12/01/2023 10:00:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:01:01 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.09833206236362457, R@50:0.2336895763874054, NDCG@10:0.049319975078105927, NDCG@50:0.07857956737279892
12/01/2023 10:01:01 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 10:02:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:03:05 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.0964539647102356, R@50:0.22850243747234344, NDCG@10:0.04821046441793442, NDCG@50:0.07692073285579681
12/01/2023 10:04:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:05:09 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.09936054795980453, R@50:0.2322586327791214, NDCG@10:0.049575649201869965, NDCG@50:0.0783163458108902
12/01/2023 10:05:09 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 20 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 10:07:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:07:13 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.09976299852132797, R@50:0.233108252286911, NDCG@10:0.049204230308532715, NDCG@50:0.07807596027851105
12/01/2023 10:07:13 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 21 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 10:09:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:09:17 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.09837678074836731, R@50:0.23422616720199585, NDCG@10:0.04874061048030853, NDCG@50:0.078239805996418
12/01/2023 10:11:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:11:20 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.0996735692024231, R@50:0.23708803951740265, NDCG@10:0.04976526275277138, NDCG@50:0.07966245710849762
12/01/2023 10:13:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:13:24 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.09949469566345215, R@50:0.23887671530246735, NDCG@10:0.049249958246946335, NDCG@50:0.07952915132045746
12/01/2023 10:15:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:15:28 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.09944998472929001, R@50:0.233108252286911, NDCG@10:0.04912293702363968, NDCG@50:0.07812947034835815
12/01/2023 10:17:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:17:32 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.09953941404819489, R@50:0.23588068783283234, NDCG@10:0.05008108541369438, NDCG@50:0.07972018420696259
12/01/2023 10:19:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:19:36 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.10043375194072723, R@50:0.24124670028686523, NDCG@10:0.04996149614453316, NDCG@50:0.08055878430604935
12/01/2023 10:19:36 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 27 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 10:21:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:21:40 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.10128336399793625, R@50:0.23766936361789703, NDCG@10:0.05066831037402153, NDCG@50:0.08031508326530457
12/01/2023 10:21:40 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 28 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 10:23:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:23:44 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.1025354340672493, R@50:0.23807181417942047, NDCG@10:0.05108493193984032, NDCG@50:0.0806271880865097
12/01/2023 10:23:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 29 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 10:25:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:25:48 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.10137280076742172, R@50:0.23865312337875366, NDCG@10:0.05041217803955078, NDCG@50:0.08021143078804016
12/01/2023 10:27:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:27:51 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.10097035020589828, R@50:0.2342708855867386, NDCG@10:0.050186771899461746, NDCG@50:0.0791536495089531
12/01/2023 10:29:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:29:55 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.10378750413656235, R@50:0.2409783899784088, NDCG@10:0.051557525992393494, NDCG@50:0.08134427666664124
12/01/2023 10:29:55 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 32 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 10:31:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:31:59 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.10311675071716309, R@50:0.23807181417942047, NDCG@10:0.05089800804853439, NDCG@50:0.08029188215732574
12/01/2023 10:33:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:34:03 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.1032509058713913, R@50:0.23959217965602875, NDCG@10:0.053336646407842636, NDCG@50:0.08302531391382217
12/01/2023 10:35:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:36:07 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.10043375194072723, R@50:0.23816123604774475, NDCG@10:0.05042903870344162, NDCG@50:0.08047258108854294
12/01/2023 10:38:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:38:11 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.1032509058713913, R@50:0.2407100945711136, NDCG@10:0.05102980509400368, NDCG@50:0.0809936448931694
12/01/2023 10:40:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:40:15 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.10418995469808578, R@50:0.2402629256248474, NDCG@10:0.05115526169538498, NDCG@50:0.08073655515909195
12/01/2023 10:40:15 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 37 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 10:42:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:42:19 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.10222242027521133, R@50:0.24267762899398804, NDCG@10:0.051827576011419296, NDCG@50:0.08250248432159424
12/01/2023 10:44:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:44:23 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.10329561680555344, R@50:0.23865312337875366, NDCG@10:0.0514201745390892, NDCG@50:0.08097989857196808
12/01/2023 10:46:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:46:26 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.1014622375369072, R@50:0.23936858773231506, NDCG@10:0.05084000900387764, NDCG@50:0.08085639774799347
12/01/2023 10:48:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:48:30 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.10334033519029617, R@50:0.23699860274791718, NDCG@10:0.05140615999698639, NDCG@50:0.0805085077881813
12/01/2023 10:50:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:50:34 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.10517372190952301, R@50:0.24164915084838867, NDCG@10:0.052421148866415024, NDCG@50:0.08208707720041275
12/01/2023 10:50:34 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 42 to ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 10:52:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:52:38 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.1043241024017334, R@50:0.24164915084838867, NDCG@10:0.051918234676122665, NDCG@50:0.0818544551730156
12/01/2023 10:54:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:54:42 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.10441353917121887, R@50:0.2404865175485611, NDCG@10:0.052031777799129486, NDCG@50:0.08174342662096024
12/01/2023 10:56:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:56:46 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.10459240525960922, R@50:0.2382059544324875, NDCG@10:0.05189599469304085, NDCG@50:0.08103864639997482
12/01/2023 10:58:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 10:58:50 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.10293788462877274, R@50:0.2409783899784088, NDCG@10:0.05227304622530937, NDCG@50:0.08236349374055862
12/01/2023 11:00:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 11:00:54 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.10226713865995407, R@50:0.24209631979465485, NDCG@10:0.051348984241485596, NDCG@50:0.08174652606248856
12/01/2023 11:02:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 11:02:58 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.10222242027521133, R@50:0.24147027730941772, NDCG@10:0.05084382742643356, NDCG@50:0.08123988658189774
12/01/2023 11:04:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 11:05:01 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.1046818345785141, R@50:0.24115726351737976, NDCG@10:0.05209517478942871, NDCG@50:0.08205487579107285
12/01/2023 11:06:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 11:07:06 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.10472655296325684, R@50:0.24079953134059906, NDCG@10:0.052191320806741714, NDCG@50:0.08180265128612518
12/01/2023 11:08:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 11:09:09 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.10249071568250656, R@50:0.2404865175485611, NDCG@10:0.05121313035488129, NDCG@50:0.0814751610159874
12/01/2023 11:11:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/01/2023 11:11:13 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.10392165184020996, R@50:0.2407100945711136, NDCG@10:0.05244726687669754, NDCG@50:0.08224332332611084
12/01/2023 11:11:13 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Beauty-8192batch-ngcf
12/01/2023 11:11:13 - INFO - trainer.finetune_evaluator - ***** Run test *****
12/01/2023 11:11:24 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.08795778453350067, R@50:0.22031927108764648, NDCG@10:0.044114094227552414, NDCG@50:0.07289887964725494
12/01/2023 11:53:41 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/01/2023 11:54:07 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/01/2023 11:54:07 - INFO - trainer.finetune_trainer - ***** Run training *****
12/01/2023 11:54:07 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/01/2023 11:54:07 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/01/2023 11:54:07 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/01/2023 11:54:07 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/01/2023 11:54:07 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/01/2023 11:58:17 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/01/2023 11:58:33 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/01/2023 11:58:34 - INFO - trainer.finetune_trainer - ***** Run training *****
12/01/2023 11:58:34 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/01/2023 11:58:34 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/01/2023 11:58:34 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/01/2023 11:58:34 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/01/2023 11:58:34 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/01/2023 12:01:13 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/01/2023 12:01:29 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/01/2023 12:01:29 - INFO - trainer.finetune_trainer - ***** Run training *****
12/01/2023 12:01:29 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/01/2023 12:01:29 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/01/2023 12:01:29 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/01/2023 12:01:29 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/01/2023 12:01:29 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/01/2023 12:10:37 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/01/2023 12:10:58 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/01/2023 12:10:58 - INFO - trainer.finetune_trainer - ***** Run training *****
12/01/2023 12:10:58 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/01/2023 12:10:58 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/01/2023 12:10:58 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/01/2023 12:10:58 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/01/2023 12:10:58 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/01/2023 12:18:27 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/01/2023 12:18:43 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/01/2023 12:18:43 - INFO - trainer.finetune_trainer - ***** Run training *****
12/01/2023 12:18:43 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/01/2023 12:18:43 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/01/2023 12:18:43 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/01/2023 12:18:43 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/01/2023 12:18:43 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/01/2023 12:30:44 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/01/2023 12:30:59 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/01/2023 12:30:59 - INFO - trainer.finetune_trainer - ***** Run training *****
12/01/2023 12:30:59 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/01/2023 12:30:59 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/01/2023 12:30:59 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/01/2023 12:30:59 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/01/2023 12:30:59 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/03/2023 22:45:07 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/03/2023 22:45:32 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/03/2023 22:45:32 - INFO - trainer.finetune_trainer - ***** Run training *****
12/03/2023 22:45:32 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/03/2023 22:45:32 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/03/2023 22:45:32 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/03/2023 22:45:32 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/03/2023 22:45:32 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/03/2023 22:56:03 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/03/2023 22:56:26 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/03/2023 22:56:26 - INFO - trainer.finetune_trainer - ***** Run training *****
12/03/2023 22:56:26 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/03/2023 22:56:26 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/03/2023 22:56:26 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/03/2023 22:56:26 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/03/2023 22:56:26 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/03/2023 23:40:08 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/03/2023 23:40:32 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/03/2023 23:40:32 - INFO - trainer.finetune_trainer - ***** Run training *****
12/03/2023 23:40:32 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/03/2023 23:40:32 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/03/2023 23:40:32 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/03/2023 23:40:32 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/03/2023 23:40:32 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/04/2023 00:02:15 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/04/2023 00:02:37 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/04/2023 00:02:37 - INFO - trainer.finetune_trainer - ***** Run training *****
12/04/2023 00:02:37 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/04/2023 00:02:37 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/04/2023 00:02:37 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/04/2023 00:02:37 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/04/2023 00:02:37 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/04/2023 00:04:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:04:19 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.031078118830919266, R@50:0.08701873570680618, NDCG@10:0.015837164595723152, NDCG@50:0.027920080348849297
12/04/2023 00:04:19 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:05:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:05:55 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.047757454216480255, R@50:0.13338996469974518, NDCG@10:0.02318299375474453, NDCG@50:0.0416702963411808
12/04/2023 00:05:55 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:07:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:07:31 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.05804229900240898, R@50:0.16397620737552643, NDCG@10:0.028571300208568573, NDCG@50:0.05140601471066475
12/04/2023 00:07:31 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:08:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:09:08 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.06573357433080673, R@50:0.1801636517047882, NDCG@10:0.032448846846818924, NDCG@50:0.05719295144081116
12/04/2023 00:09:08 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:10:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:10:45 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.07092071324586868, R@50:0.18628984689712524, NDCG@10:0.035190943628549576, NDCG@50:0.06009707599878311
12/04/2023 00:10:45 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:12:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:12:22 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.0753476694226265, R@50:0.19487546384334564, NDCG@10:0.03742576017975807, NDCG@50:0.0633290559053421
12/04/2023 00:12:22 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:13:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:14:00 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.080847829580307, R@50:0.20068863034248352, NDCG@10:0.039746593683958054, NDCG@50:0.06564515829086304
12/04/2023 00:14:00 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:15:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:15:37 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.08308365941047668, R@50:0.20466841757297516, NDCG@10:0.04093253239989281, NDCG@50:0.06732168048620224
12/04/2023 00:15:37 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:17:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:17:14 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.08469346165657043, R@50:0.20779858529567719, NDCG@10:0.0422731414437294, NDCG@50:0.06899266690015793
12/04/2023 00:17:14 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:18:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:18:50 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.08844967186450958, R@50:0.21553458273410797, NDCG@10:0.04451630264520645, NDCG@50:0.0719924345612526
12/04/2023 00:18:50 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 9 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:20:15 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:20:26 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.09077493846416473, R@50:0.21642892062664032, NDCG@10:0.045064087957143784, NDCG@50:0.07231675833463669
12/04/2023 00:20:26 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:21:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:22:03 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.09050663560628891, R@50:0.21611590683460236, NDCG@10:0.04524178430438042, NDCG@50:0.07249146699905396
12/04/2023 00:23:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:23:39 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.09193757176399231, R@50:0.22103473544120789, NDCG@10:0.04559030383825302, NDCG@50:0.07362300157546997
12/04/2023 00:23:39 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 12 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:25:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:25:15 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.09439699351787567, R@50:0.22492510080337524, NDCG@10:0.04763035848736763, NDCG@50:0.07586778700351715
12/04/2023 00:25:15 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 13 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:26:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:26:52 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.09488887339830399, R@50:0.2234494388103485, NDCG@10:0.04756801947951317, NDCG@50:0.07544209808111191
12/04/2023 00:26:52 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 14 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:28:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:28:28 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.0943075567483902, R@50:0.22599829733371735, NDCG@10:0.04821852967143059, NDCG@50:0.07666849344968796
12/04/2023 00:29:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:30:04 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.0975271612405777, R@50:0.22993336617946625, NDCG@10:0.04869600385427475, NDCG@50:0.07739172875881195
12/04/2023 00:30:04 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:31:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:31:40 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.09851092845201492, R@50:0.23006752133369446, NDCG@10:0.049013782292604446, NDCG@50:0.07748749107122421
12/04/2023 00:31:40 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 17 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:33:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:33:16 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.09775074571371078, R@50:0.23422616720199585, NDCG@10:0.04914300888776779, NDCG@50:0.07869432121515274
12/04/2023 00:34:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:34:52 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.09985243529081345, R@50:0.23431560397148132, NDCG@10:0.05015169456601143, NDCG@50:0.0792975202202797
12/04/2023 00:34:52 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 19 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:36:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:36:29 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.09940526634454727, R@50:0.23485220968723297, NDCG@10:0.04973241314291954, NDCG@50:0.07913263887166977
12/04/2023 00:37:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:38:05 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.09936054795980453, R@50:0.23360013961791992, NDCG@10:0.04951776564121246, NDCG@50:0.0786675289273262
12/04/2023 00:39:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:39:41 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.10284845530986786, R@50:0.23673030734062195, NDCG@10:0.05111918970942497, NDCG@50:0.08011014014482498
12/04/2023 00:39:41 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 22 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:41:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:41:18 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.10222242027521133, R@50:0.2384742647409439, NDCG@10:0.0511925145983696, NDCG@50:0.08075115084648132
12/04/2023 00:42:42 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:42:54 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.10012073069810867, R@50:0.23507578670978546, NDCG@10:0.0501527413725853, NDCG@50:0.07944998145103455
12/04/2023 00:44:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:44:30 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.10307203978300095, R@50:0.2352546602487564, NDCG@10:0.05124128237366676, NDCG@50:0.07999873161315918
12/04/2023 00:44:30 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 25 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:45:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:46:06 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.10195411741733551, R@50:0.2370433211326599, NDCG@10:0.050638966262340546, NDCG@50:0.07996200770139694
12/04/2023 00:47:31 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:47:43 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.10334033519029617, R@50:0.23802709579467773, NDCG@10:0.051632110029459, NDCG@50:0.08092061430215836
12/04/2023 00:47:43 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 27 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:49:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:49:19 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.10298260301351547, R@50:0.24111254513263702, NDCG@10:0.05194230005145073, NDCG@50:0.0819813534617424
12/04/2023 00:50:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:50:55 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.10369806736707687, R@50:0.24017348885536194, NDCG@10:0.05200686305761337, NDCG@50:0.0816616341471672
12/04/2023 00:50:55 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 29 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:52:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:52:31 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.10222242027521133, R@50:0.24066537618637085, NDCG@10:0.05100211501121521, NDCG@50:0.08116477727890015
12/04/2023 00:53:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:54:07 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.10410051792860031, R@50:0.24079953134059906, NDCG@10:0.052086248993873596, NDCG@50:0.0818123072385788
12/04/2023 00:54:07 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 31 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:55:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:55:44 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.10562089085578918, R@50:0.23914501070976257, NDCG@10:0.05326763913035393, NDCG@50:0.08238827437162399
12/04/2023 00:55:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 32 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 00:57:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:57:20 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.103608638048172, R@50:0.2416938692331314, NDCG@10:0.051644906401634216, NDCG@50:0.08171889930963516
12/04/2023 00:58:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 00:58:56 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.10732012242078781, R@50:0.2427670657634735, NDCG@10:0.05359688028693199, NDCG@50:0.0831204354763031
12/04/2023 00:58:56 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 34 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 01:00:21 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:00:32 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.10405580699443817, R@50:0.2409783899784088, NDCG@10:0.052327994257211685, NDCG@50:0.08217022567987442
12/04/2023 01:01:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:02:09 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.10655993968248367, R@50:0.24482403695583344, NDCG@10:0.05334145948290825, NDCG@50:0.08335845917463303
12/04/2023 01:03:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:03:45 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.10584447532892227, R@50:0.24468988180160522, NDCG@10:0.053147125989198685, NDCG@50:0.08336706459522247
12/04/2023 01:05:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:05:21 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.10664937645196915, R@50:0.24473460018634796, NDCG@10:0.05345993861556053, NDCG@50:0.08364392817020416
12/04/2023 01:06:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:06:57 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.10696239024400711, R@50:0.24460044503211975, NDCG@10:0.05426514521241188, NDCG@50:0.08424097299575806
12/04/2023 01:08:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:08:34 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.1061127707362175, R@50:0.24580779671669006, NDCG@10:0.05375754088163376, NDCG@50:0.08418232202529907
12/04/2023 01:09:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:10:10 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.10615748912096024, R@50:0.24468988180160522, NDCG@10:0.05375629663467407, NDCG@50:0.08407122641801834
12/04/2023 01:11:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:11:46 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.10772257298231125, R@50:0.24759647250175476, NDCG@10:0.05412851646542549, NDCG@50:0.08455358445644379
12/04/2023 01:11:46 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 42 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 01:13:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:13:22 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.10821446031332016, R@50:0.24460044503211975, NDCG@10:0.053587090224027634, NDCG@50:0.08332477509975433
12/04/2023 01:13:22 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 43 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 01:14:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:14:59 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.10906407982110977, R@50:0.2467021346092224, NDCG@10:0.05421322584152222, NDCG@50:0.08406553417444229
12/04/2023 01:14:59 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 44 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 01:16:23 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:16:35 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.10732012242078781, R@50:0.24759647250175476, NDCG@10:0.0537266805768013, NDCG@50:0.08425384014844894
12/04/2023 01:18:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:18:11 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.10906407982110977, R@50:0.24777533113956451, NDCG@10:0.05434374883770943, NDCG@50:0.08448781818151474
12/04/2023 01:19:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:19:48 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.10794615745544434, R@50:0.2456289380788803, NDCG@10:0.05358334630727768, NDCG@50:0.08353868871927261
12/04/2023 01:21:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:21:24 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.10799087584018707, R@50:0.2471493035554886, NDCG@10:0.05403720587491989, NDCG@50:0.08432598412036896
12/04/2023 01:22:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:23:00 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.10624692589044571, R@50:0.2463444024324417, NDCG@10:0.053362149745225906, NDCG@50:0.08388852328062057
12/04/2023 01:24:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:24:36 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.10548673570156097, R@50:0.24495817720890045, NDCG@10:0.053140345960855484, NDCG@50:0.08363340049982071
12/04/2023 01:26:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:26:13 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.10866162925958633, R@50:0.24652327597141266, NDCG@10:0.05454893782734871, NDCG@50:0.08460763096809387
12/04/2023 01:27:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:27:49 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.1089746430516243, R@50:0.24540534615516663, NDCG@10:0.05501750111579895, NDCG@50:0.08477143198251724
12/04/2023 01:29:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:29:25 - INFO - trainer.finetune_evaluator - Epoch 53 Eval Result: R@10:0.10620220750570297, R@50:0.24473460018634796, NDCG@10:0.05320386216044426, NDCG@50:0.08345236629247665
12/04/2023 01:30:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:31:01 - INFO - trainer.finetune_evaluator - Epoch 54 Eval Result: R@10:0.10875105857849121, R@50:0.2449134737253189, NDCG@10:0.0544588565826416, NDCG@50:0.08423251658678055
12/04/2023 01:31:01 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 01:31:01 - INFO - trainer.finetune_evaluator - ***** Run test *****
12/04/2023 01:31:13 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.09184814244508743, R@50:0.22183963656425476, NDCG@10:0.04563243314623833, NDCG@50:0.07393771409988403
12/04/2023 01:51:16 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/04/2023 01:51:40 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/04/2023 01:51:40 - INFO - trainer.finetune_trainer - ***** Run training *****
12/04/2023 01:51:40 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/04/2023 01:51:40 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/04/2023 01:51:40 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/04/2023 01:51:40 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/04/2023 01:51:40 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/04/2023 01:53:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:53:21 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.030720384791493416, R@50:0.08688458055257797, NDCG@10:0.015673138201236725, NDCG@50:0.02774226665496826
12/04/2023 01:53:21 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 01:54:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:54:57 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.05102177709341049, R@50:0.13839824497699738, NDCG@10:0.02496752329170704, NDCG@50:0.04381459951400757
12/04/2023 01:54:57 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 01:56:21 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:56:33 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.05790815129876137, R@50:0.1561954915523529, NDCG@10:0.027514725923538208, NDCG@50:0.04877045005559921
12/04/2023 01:56:33 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 01:57:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:58:09 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.06443679332733154, R@50:0.17198050022125244, NDCG@10:0.031233958899974823, NDCG@50:0.054366838186979294
12/04/2023 01:58:09 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 01:59:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 01:59:45 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.06609130650758743, R@50:0.17640745639801025, NDCG@10:0.032541342079639435, NDCG@50:0.056367356330156326
12/04/2023 01:59:45 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:01:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:01:21 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.06743281334638596, R@50:0.1776595264673233, NDCG@10:0.032730311155319214, NDCG@50:0.05647953599691391
12/04/2023 02:01:21 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:02:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:02:56 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.07038411498069763, R@50:0.17940346896648407, NDCG@10:0.03481166064739227, NDCG@50:0.05832032859325409
12/04/2023 02:02:56 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:04:21 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:04:32 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.07324598729610443, R@50:0.19129812717437744, NDCG@10:0.03689074516296387, NDCG@50:0.06233722344040871
12/04/2023 02:04:32 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:05:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:06:08 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.0764208734035492, R@50:0.1926843374967575, NDCG@10:0.0379151925444603, NDCG@50:0.0629512369632721
12/04/2023 02:06:08 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:07:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:07:44 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.07579483836889267, R@50:0.19107453525066376, NDCG@10:0.03672531247138977, NDCG@50:0.06154188513755798
12/04/2023 02:09:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:09:20 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.0778518095612526, R@50:0.20059919357299805, NDCG@10:0.03832017630338669, NDCG@50:0.06488920748233795
12/04/2023 02:09:20 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:10:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:10:56 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.07771765440702438, R@50:0.19845280051231384, NDCG@10:0.03842093423008919, NDCG@50:0.06455732882022858
12/04/2023 02:12:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:12:32 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.08080311119556427, R@50:0.20243258774280548, NDCG@10:0.0395352877676487, NDCG@50:0.06587141752243042
12/04/2023 02:12:32 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 12 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:13:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:14:08 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.08120556175708771, R@50:0.20395295321941376, NDCG@10:0.03930424153804779, NDCG@50:0.0658104345202446
12/04/2023 02:14:08 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 13 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:15:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:15:44 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.08093725889921188, R@50:0.2034163475036621, NDCG@10:0.040174417197704315, NDCG@50:0.0665985494852066
12/04/2023 02:17:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:17:20 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.08201046288013458, R@50:0.20560747385025024, NDCG@10:0.040747225284576416, NDCG@50:0.06751108914613724
12/04/2023 02:17:20 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 15 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:18:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:18:56 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.08326253294944763, R@50:0.2022089958190918, NDCG@10:0.040858909487724304, NDCG@50:0.06674409657716751
12/04/2023 02:18:56 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:20:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:20:32 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.08303894847631454, R@50:0.2044895589351654, NDCG@10:0.04044536501169205, NDCG@50:0.0666993111371994
12/04/2023 02:21:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:22:08 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.08509591221809387, R@50:0.2090059369802475, NDCG@10:0.041962821036577225, NDCG@50:0.06882660835981369
12/04/2023 02:22:08 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:23:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:23:43 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.08473818004131317, R@50:0.20390823483467102, NDCG@10:0.04156903177499771, NDCG@50:0.06745938211679459
12/04/2023 02:25:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:25:19 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.08523006737232208, R@50:0.20632293820381165, NDCG@10:0.0420035794377327, NDCG@50:0.06829249113798141
12/04/2023 02:25:19 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 20 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:26:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:26:55 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.08675043284893036, R@50:0.20609936118125916, NDCG@10:0.04262249544262886, NDCG@50:0.0686035007238388
12/04/2023 02:26:55 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 21 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:28:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:28:31 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.08344139903783798, R@50:0.2097214162349701, NDCG@10:0.04157322272658348, NDCG@50:0.0689181461930275
12/04/2023 02:29:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:30:07 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.08907570689916611, R@50:0.21289630234241486, NDCG@10:0.043395642191171646, NDCG@50:0.07019762694835663
12/04/2023 02:30:07 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 23 to ./weights/finetune-Beauty-8192batch-ngcf
12/04/2023 02:31:31 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/04/2023 02:31:43 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.08657156676054001, R@50:0.2061440795660019, NDCG@10:0.04156047850847244, NDCG@50:0.06760025024414062
12/06/2023 13:02:11 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/06/2023 13:02:45 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/06/2023 13:02:45 - INFO - trainer.finetune_trainer - ***** Run training *****
12/06/2023 13:02:45 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/06/2023 13:02:45 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/06/2023 13:02:45 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/06/2023 13:02:45 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/06/2023 13:02:45 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/06/2023 13:04:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:04:53 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.029960202053189278, R@50:0.08590081334114075, NDCG@10:0.015856413170695305, NDCG@50:0.02792964316904545
12/06/2023 13:04:53 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:06:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:06:45 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.04802575707435608, R@50:0.13540221750736237, NDCG@10:0.023292027413845062, NDCG@50:0.042105965316295624
12/06/2023 13:06:45 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:08:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:08:37 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.057639848440885544, R@50:0.16706165671348572, NDCG@10:0.02869383804500103, NDCG@50:0.0523761548101902
12/06/2023 13:08:37 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:10:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:10:29 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.06613602489233017, R@50:0.18190760910511017, NDCG@10:0.03238401561975479, NDCG@50:0.05739862471818924
12/06/2023 13:10:29 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:12:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:12:21 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.07230693101882935, R@50:0.19000133872032166, NDCG@10:0.03567929193377495, NDCG@50:0.06107832118868828
12/06/2023 13:12:21 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:13:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:14:12 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.07910387217998505, R@50:0.19957071542739868, NDCG@10:0.03900934383273125, NDCG@50:0.06506597995758057
12/06/2023 13:14:12 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:15:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:16:04 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.08209989219903946, R@50:0.20475785434246063, NDCG@10:0.040930453687906265, NDCG@50:0.06752381473779678
12/06/2023 13:16:04 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:17:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:17:56 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.08612439781427383, R@50:0.20891651511192322, NDCG@10:0.04353763535618782, NDCG@50:0.07011149823665619
12/06/2023 13:17:56 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:19:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:19:48 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.08760005235671997, R@50:0.21334347128868103, NDCG@10:0.04422075301408768, NDCG@50:0.07142763584852219
12/06/2023 13:19:48 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:21:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:21:39 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.08867325633764267, R@50:0.21835173666477203, NDCG@10:0.04495973885059357, NDCG@50:0.07301736623048782
12/06/2023 13:21:39 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 9 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:23:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:23:31 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.09234002232551575, R@50:0.22251039743423462, NDCG@10:0.04654524475336075, NDCG@50:0.07482173293828964
12/06/2023 13:23:31 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:25:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:25:23 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.09099852293729782, R@50:0.22362831234931946, NDCG@10:0.04529151692986488, NDCG@50:0.0740598812699318
12/06/2023 13:27:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:27:15 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.09292133897542953, R@50:0.22233152389526367, NDCG@10:0.046400245279073715, NDCG@50:0.07448087632656097
12/06/2023 13:27:15 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 12 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:28:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:29:06 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.09421812742948532, R@50:0.22657960653305054, NDCG@10:0.047631483525037766, NDCG@50:0.07635314017534256
12/06/2023 13:29:06 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 13 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:30:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:30:58 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.09515717625617981, R@50:0.22756338119506836, NDCG@10:0.04791782423853874, NDCG@50:0.07658148556947708
12/06/2023 13:30:58 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 14 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:32:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:32:50 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.0950230285525322, R@50:0.22693735361099243, NDCG@10:0.047527145594358444, NDCG@50:0.07604439556598663
12/06/2023 13:34:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:34:42 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.09770602732896805, R@50:0.2314090132713318, NDCG@10:0.04878048226237297, NDCG@50:0.07771550863981247
12/06/2023 13:34:42 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:36:19 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:36:34 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.09667754918336868, R@50:0.23243750631809235, NDCG@10:0.04818030074238777, NDCG@50:0.07776955515146255
12/06/2023 13:38:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:38:26 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.09775074571371078, R@50:0.23449447751045227, NDCG@10:0.04964412376284599, NDCG@50:0.07929494976997375
12/06/2023 13:38:26 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:40:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:40:18 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.09953941404819489, R@50:0.2329740971326828, NDCG@10:0.049802836030721664, NDCG@50:0.07883916050195694
12/06/2023 13:40:18 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 19 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:41:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:42:09 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.09976299852132797, R@50:0.236551433801651, NDCG@10:0.05064764618873596, NDCG@50:0.08044882863759995
12/06/2023 13:42:09 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 20 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:43:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:44:01 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.10097035020589828, R@50:0.23802709579467773, NDCG@10:0.05048169940710068, NDCG@50:0.0803251788020134
12/06/2023 13:44:01 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 21 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:45:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:45:53 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.10177525132894516, R@50:0.23753520846366882, NDCG@10:0.050627753138542175, NDCG@50:0.0801561251282692
12/06/2023 13:45:53 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 22 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:47:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:47:45 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.10320618748664856, R@50:0.2399051934480667, NDCG@10:0.051899686455726624, NDCG@50:0.0815492793917656
12/06/2023 13:47:45 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 23 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:49:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:49:36 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.09994186460971832, R@50:0.23731163144111633, NDCG@10:0.05018352344632149, NDCG@50:0.07995878905057907
12/06/2023 13:51:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:51:28 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.1032509058713913, R@50:0.23681974411010742, NDCG@10:0.051652368158102036, NDCG@50:0.08068960160017014
12/06/2023 13:51:28 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 25 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:53:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:53:20 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.10266958922147751, R@50:0.23994991183280945, NDCG@10:0.051609691232442856, NDCG@50:0.08152274787425995
12/06/2023 13:54:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:55:11 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.1025354340672493, R@50:0.24164915084838867, NDCG@10:0.05163251608610153, NDCG@50:0.08179169148206711
12/06/2023 13:56:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:57:03 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.1039663702249527, R@50:0.23968161642551422, NDCG@10:0.05225151777267456, NDCG@50:0.08179399371147156
12/06/2023 13:57:03 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 28 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 13:58:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 13:58:55 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.10526315867900848, R@50:0.2397710382938385, NDCG@10:0.052848074585199356, NDCG@50:0.08205558359622955
12/06/2023 13:58:55 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 29 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 14:00:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:00:46 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.10271430015563965, R@50:0.239547461271286, NDCG@10:0.05163715034723282, NDCG@50:0.08148930966854095
12/06/2023 14:02:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:02:38 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.10226713865995407, R@50:0.23766936361789703, NDCG@10:0.052051085978746414, NDCG@50:0.0814959928393364
12/06/2023 14:04:15 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:04:30 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.10562089085578918, R@50:0.2408442497253418, NDCG@10:0.05353841930627823, NDCG@50:0.08291763812303543
12/06/2023 14:04:30 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 32 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 14:06:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:06:21 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.10463712364435196, R@50:0.24196216464042664, NDCG@10:0.052548084408044815, NDCG@50:0.08245423436164856
12/06/2023 14:07:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:08:13 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.10495013743638992, R@50:0.24245405197143555, NDCG@10:0.053183019161224365, NDCG@50:0.08310806751251221
12/06/2023 14:09:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:10:05 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.10271430015563965, R@50:0.24325895309448242, NDCG@10:0.05245243385434151, NDCG@50:0.08311790972948074
12/06/2023 14:11:42 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:11:57 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.10620220750570297, R@50:0.24267762899398804, NDCG@10:0.0532233752310276, NDCG@50:0.08297323435544968
12/06/2023 14:11:57 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 36 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 14:13:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:13:49 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.10517372190952301, R@50:0.24267762899398804, NDCG@10:0.053187161684036255, NDCG@50:0.0831514373421669
12/06/2023 14:15:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:15:40 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.10512900352478027, R@50:0.24200688302516937, NDCG@10:0.05267268046736717, NDCG@50:0.08248823136091232
12/06/2023 14:17:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:17:32 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.10526315867900848, R@50:0.24410857260227203, NDCG@10:0.05285026878118515, NDCG@50:0.08308764547109604
12/06/2023 14:19:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:19:24 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.10696239024400711, R@50:0.24308007955551147, NDCG@10:0.054458893835544586, NDCG@50:0.08407124876976013
12/06/2023 14:19:24 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 40 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 14:21:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:21:16 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.10410051792860031, R@50:0.24111254513263702, NDCG@10:0.05280185118317604, NDCG@50:0.08270396292209625
12/06/2023 14:22:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:23:07 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.10566560924053192, R@50:0.24254348874092102, NDCG@10:0.05375818535685539, NDCG@50:0.0835699662566185
12/06/2023 14:24:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:24:59 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.1075437068939209, R@50:0.24281178414821625, NDCG@10:0.054539211094379425, NDCG@50:0.0840214416384697
12/06/2023 14:24:59 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 43 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 14:26:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:26:51 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.10785672813653946, R@50:0.24397441744804382, NDCG@10:0.05454225838184357, NDCG@50:0.08420222252607346
12/06/2023 14:26:51 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 44 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 14:28:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:28:42 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.10566560924053192, R@50:0.2419174462556839, NDCG@10:0.05355295538902283, NDCG@50:0.08327173441648483
12/06/2023 14:30:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:30:34 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.10544202476739883, R@50:0.2415597140789032, NDCG@10:0.05380652844905853, NDCG@50:0.08349325507879257
12/06/2023 14:32:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:32:26 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.10629163682460785, R@50:0.24245405197143555, NDCG@10:0.054197657853364944, NDCG@50:0.08392468094825745
12/06/2023 14:34:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:34:18 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.10660465806722641, R@50:0.24151499569416046, NDCG@10:0.05414875969290733, NDCG@50:0.08359863609075546
12/06/2023 14:35:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:36:10 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.10423467308282852, R@50:0.2409783899784088, NDCG@10:0.05302554741501808, NDCG@50:0.08298265933990479
12/06/2023 14:37:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:38:01 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.10481598973274231, R@50:0.24053123593330383, NDCG@10:0.052873168140649796, NDCG@50:0.08262168616056442
12/06/2023 14:39:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:39:53 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.10709653794765472, R@50:0.2437061220407486, NDCG@10:0.05420522019267082, NDCG@50:0.08400864899158478
12/06/2023 14:41:31 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:41:45 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.10758842527866364, R@50:0.2433483749628067, NDCG@10:0.05363193899393082, NDCG@50:0.08325764536857605
12/06/2023 14:43:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:43:37 - INFO - trainer.finetune_evaluator - Epoch 53 Eval Result: R@10:0.10687296092510223, R@50:0.24075481295585632, NDCG@10:0.053255099803209305, NDCG@50:0.0824241042137146
12/06/2023 14:45:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 14:45:29 - INFO - trainer.finetune_evaluator - Epoch 54 Eval Result: R@10:0.10732012242078781, R@50:0.24267762899398804, NDCG@10:0.05412142723798752, NDCG@50:0.08357112854719162
12/06/2023 14:45:29 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 14:45:29 - INFO - trainer.finetune_evaluator - ***** Run test *****
12/06/2023 14:45:43 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.09269775450229645, R@50:0.21821758151054382, NDCG@10:0.046314120292663574, NDCG@50:0.07367287576198578
12/06/2023 15:02:25 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/06/2023 15:02:54 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/06/2023 15:02:54 - INFO - trainer.finetune_trainer - ***** Run training *****
12/06/2023 15:02:54 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/06/2023 15:02:54 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/06/2023 15:02:54 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/06/2023 15:02:54 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/06/2023 15:02:54 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/06/2023 15:04:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:05:09 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.030899252742528915, R@50:0.08531949669122696, NDCG@10:0.015712281689047813, NDCG@50:0.0274910107254982
12/06/2023 15:05:09 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:06:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:07:03 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.047220855951309204, R@50:0.13267450034618378, NDCG@10:0.022622443735599518, NDCG@50:0.040944572538137436
12/06/2023 15:07:03 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:08:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:08:58 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.05804229900240898, R@50:0.16379733383655548, NDCG@10:0.02879077009856701, NDCG@50:0.051605742424726486
12/06/2023 15:08:58 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:10:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:10:53 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.06703036278486252, R@50:0.1789563149213791, NDCG@10:0.03338779881596565, NDCG@50:0.05754896625876427
12/06/2023 15:10:53 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:12:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:12:48 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.07145731896162033, R@50:0.18781021237373352, NDCG@10:0.035125795751810074, NDCG@50:0.060285571962594986
12/06/2023 15:12:48 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:14:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:14:43 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.07557125389575958, R@50:0.1962616741657257, NDCG@10:0.03743176534771919, NDCG@50:0.06359312683343887
12/06/2023 15:14:43 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:16:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:16:38 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.0799982100725174, R@50:0.2019854187965393, NDCG@10:0.03955734148621559, NDCG@50:0.0659298449754715
12/06/2023 15:16:38 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:18:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:18:33 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.0846487507224083, R@50:0.2062782198190689, NDCG@10:0.04268362373113632, NDCG@50:0.06901167333126068
12/06/2023 15:18:33 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:20:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:20:28 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.08554308116436005, R@50:0.21168895065784454, NDCG@10:0.04269471764564514, NDCG@50:0.06999816000461578
12/06/2023 15:20:28 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:22:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:22:23 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.08795778453350067, R@50:0.2154451459646225, NDCG@10:0.044910918921232224, NDCG@50:0.07246339321136475
12/06/2023 15:22:23 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 9 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:24:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:24:17 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.09140097349882126, R@50:0.21996153891086578, NDCG@10:0.046262871474027634, NDCG@50:0.07414432615041733
12/06/2023 15:24:17 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:25:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:26:12 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.09064079076051712, R@50:0.2230917066335678, NDCG@10:0.04568645730614662, NDCG@50:0.07445033639669418
12/06/2023 15:27:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:28:07 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.09064079076051712, R@50:0.2190224826335907, NDCG@10:0.04485565796494484, NDCG@50:0.07266104221343994
12/06/2023 15:29:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:30:02 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.09283190965652466, R@50:0.2249698042869568, NDCG@10:0.04664287343621254, NDCG@50:0.07536239922046661
12/06/2023 15:30:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 13 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:31:42 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:31:57 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.09529132395982742, R@50:0.22733980417251587, NDCG@10:0.04826921969652176, NDCG@50:0.07676929235458374
12/06/2023 15:31:57 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 14 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:33:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:33:52 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.09350265562534332, R@50:0.2268926352262497, NDCG@10:0.047618038952350616, NDCG@50:0.07655473798513412
12/06/2023 15:35:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:35:47 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.09515717625617981, R@50:0.23069354891777039, NDCG@10:0.04860864579677582, NDCG@50:0.07794960588216782
12/06/2023 15:37:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:37:42 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.09846621751785278, R@50:0.23109599947929382, NDCG@10:0.049403976649045944, NDCG@50:0.07817571610212326
12/06/2023 15:37:42 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 17 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:39:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:39:37 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.09868979454040527, R@50:0.23686446249485016, NDCG@10:0.050454918295145035, NDCG@50:0.08032107353210449
12/06/2023 15:39:37 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:41:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:41:32 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.09913696348667145, R@50:0.23337654769420624, NDCG@10:0.050234489142894745, NDCG@50:0.07938243448734283
12/06/2023 15:41:32 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 19 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:43:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:43:27 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.09882394969463348, R@50:0.2342708855867386, NDCG@10:0.05009272322058678, NDCG@50:0.07940871268510818
12/06/2023 15:45:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:45:22 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.10137280076742172, R@50:0.23829539120197296, NDCG@10:0.05016258358955383, NDCG@50:0.07984098047018051
12/06/2023 15:45:22 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 21 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:47:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:47:17 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.10061261802911758, R@50:0.2385636866092682, NDCG@10:0.050587382167577744, NDCG@50:0.08041771501302719
12/06/2023 15:48:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:49:12 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.10208826512098312, R@50:0.24093368649482727, NDCG@10:0.051633477210998535, NDCG@50:0.08182982355356216
12/06/2023 15:49:12 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 23 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:50:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:51:06 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.0989580973982811, R@50:0.23838482797145844, NDCG@10:0.04970505088567734, NDCG@50:0.07995136827230453
12/06/2023 15:52:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:53:01 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.10334033519029617, R@50:0.23780350387096405, NDCG@10:0.05239168927073479, NDCG@50:0.08162305504083633
12/06/2023 15:53:01 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 25 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 15:54:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:54:56 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.1021777018904686, R@50:0.23923444747924805, NDCG@10:0.0519133061170578, NDCG@50:0.08171005547046661
12/06/2023 15:56:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:56:51 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.10298260301351547, R@50:0.241425558924675, NDCG@10:0.051816511899232864, NDCG@50:0.08197412639856339
12/06/2023 15:58:31 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 15:58:46 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.10459240525960922, R@50:0.24057593941688538, NDCG@10:0.05253886803984642, NDCG@50:0.08196700364351273
12/06/2023 15:58:46 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 28 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 16:00:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:00:41 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.10526315867900848, R@50:0.2406206578016281, NDCG@10:0.052685242146253586, NDCG@50:0.08217649161815643
12/06/2023 16:00:41 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 29 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 16:02:21 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:02:36 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.10258015245199203, R@50:0.2402629256248474, NDCG@10:0.05228316783905029, NDCG@50:0.08228930830955505
12/06/2023 16:04:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:04:31 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.10258015245199203, R@50:0.2413361370563507, NDCG@10:0.05114487186074257, NDCG@50:0.08135338872671127
12/06/2023 16:06:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:06:27 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.10526315867900848, R@50:0.2409783899784088, NDCG@10:0.052875686436891556, NDCG@50:0.08233374357223511
12/06/2023 16:08:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:08:21 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.10606805980205536, R@50:0.24236461520195007, NDCG@10:0.05288304015994072, NDCG@50:0.08258258551359177
12/06/2023 16:08:21 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 33 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 16:10:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:10:16 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.10664937645196915, R@50:0.24129141867160797, NDCG@10:0.05335663631558418, NDCG@50:0.08266399055719376
12/06/2023 16:10:16 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 34 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 16:11:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:12:11 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.10714125633239746, R@50:0.24316951632499695, NDCG@10:0.05367264524102211, NDCG@50:0.08332894742488861
12/06/2023 16:12:11 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 35 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 16:13:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:14:06 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.10584447532892227, R@50:0.24509233236312866, NDCG@10:0.05330183357000351, NDCG@50:0.08362880349159241
12/06/2023 16:15:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:16:01 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.10499485582113266, R@50:0.24066537618637085, NDCG@10:0.052744701504707336, NDCG@50:0.0822954848408699
12/06/2023 16:17:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:17:56 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.10593390464782715, R@50:0.2449134737253189, NDCG@10:0.05357853323221207, NDCG@50:0.08388242870569229
12/06/2023 16:19:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:19:51 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.10642579197883606, R@50:0.24294593930244446, NDCG@10:0.0535493828356266, NDCG@50:0.0833650603890419
12/06/2023 16:21:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:21:46 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.10638107359409332, R@50:0.24401913583278656, NDCG@10:0.05386515334248543, NDCG@50:0.0838780403137207
12/06/2023 16:23:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:23:41 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.10687296092510223, R@50:0.24366140365600586, NDCG@10:0.05434650182723999, NDCG@50:0.08416366577148438
12/06/2023 16:25:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:25:36 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.1061127707362175, R@50:0.24558421969413757, NDCG@10:0.05342080816626549, NDCG@50:0.08375577628612518
12/06/2023 16:27:15 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:27:30 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.10593390464782715, R@50:0.24223046004772186, NDCG@10:0.05313311144709587, NDCG@50:0.08283230662345886
12/06/2023 16:29:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:29:25 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.10843804478645325, R@50:0.2453606277704239, NDCG@10:0.05420393496751785, NDCG@50:0.08409728854894638
12/06/2023 16:29:25 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 44 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 16:31:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:31:20 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.10602334141731262, R@50:0.24388498067855835, NDCG@10:0.05329398810863495, NDCG@50:0.08339613676071167
12/06/2023 16:33:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:33:15 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.1075437068939209, R@50:0.2446451634168625, NDCG@10:0.05444930121302605, NDCG@50:0.08441907912492752
12/06/2023 16:34:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:35:10 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.10709653794765472, R@50:0.24415327608585358, NDCG@10:0.053769297897815704, NDCG@50:0.08369499444961548
12/06/2023 16:36:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:37:05 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.10745427757501602, R@50:0.24460044503211975, NDCG@10:0.054124947637319565, NDCG@50:0.08396536856889725
12/06/2023 16:38:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:39:00 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.10664937645196915, R@50:0.24308007955551147, NDCG@10:0.05372993275523186, NDCG@50:0.08345487713813782
12/06/2023 16:40:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:40:55 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.10606805980205536, R@50:0.2438402622938156, NDCG@10:0.05393717437982559, NDCG@50:0.08400000631809235
12/06/2023 16:42:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:42:49 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.10857219249010086, R@50:0.24415327608585358, NDCG@10:0.0549001470208168, NDCG@50:0.08445112407207489
12/06/2023 16:42:49 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 51 to ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 16:44:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:44:44 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.10664937645196915, R@50:0.24366140365600586, NDCG@10:0.05422857776284218, NDCG@50:0.08413735777139664
12/06/2023 16:46:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:46:39 - INFO - trainer.finetune_evaluator - Epoch 53 Eval Result: R@10:0.10758842527866364, R@50:0.24339309334754944, NDCG@10:0.05402460694313049, NDCG@50:0.08357832580804825
12/06/2023 16:48:19 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:48:34 - INFO - trainer.finetune_evaluator - Epoch 54 Eval Result: R@10:0.10597862303256989, R@50:0.24303536117076874, NDCG@10:0.05396902933716774, NDCG@50:0.08382796496152878
12/06/2023 16:50:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:50:29 - INFO - trainer.finetune_evaluator - Epoch 55 Eval Result: R@10:0.10655993968248367, R@50:0.24236461520195007, NDCG@10:0.05346454307436943, NDCG@50:0.0830143466591835
12/06/2023 16:52:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:52:24 - INFO - trainer.finetune_evaluator - Epoch 56 Eval Result: R@10:0.10705182701349258, R@50:0.24290122091770172, NDCG@10:0.05414991453289986, NDCG@50:0.08368507027626038
12/06/2023 16:54:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:54:19 - INFO - trainer.finetune_evaluator - Epoch 57 Eval Result: R@10:0.10521844029426575, R@50:0.24254348874092102, NDCG@10:0.05367244407534599, NDCG@50:0.08378055691719055
12/06/2023 16:55:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:56:14 - INFO - trainer.finetune_evaluator - Epoch 58 Eval Result: R@10:0.10655993968248367, R@50:0.24495817720890045, NDCG@10:0.053867407143116, NDCG@50:0.08404073119163513
12/06/2023 16:57:54 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 16:58:09 - INFO - trainer.finetune_evaluator - Epoch 59 Eval Result: R@10:0.10799087584018707, R@50:0.24173858761787415, NDCG@10:0.055381469428539276, NDCG@50:0.08459603786468506
12/06/2023 16:59:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 17:00:04 - INFO - trainer.finetune_evaluator - Epoch 60 Eval Result: R@10:0.10785672813653946, R@50:0.24200688302516937, NDCG@10:0.055235229432582855, NDCG@50:0.08451090008020401
12/06/2023 17:01:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/06/2023 17:01:59 - INFO - trainer.finetune_evaluator - Epoch 61 Eval Result: R@10:0.10530786961317062, R@50:0.24446630477905273, NDCG@10:0.05353487655520439, NDCG@50:0.08398725837469101
12/06/2023 17:01:59 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Beauty-8192batch-ngcf
12/06/2023 17:01:59 - INFO - trainer.finetune_evaluator - ***** Run test *****
12/06/2023 17:02:14 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.09292133897542953, R@50:0.22000625729560852, NDCG@10:0.04622965678572655, NDCG@50:0.07387596368789673
12/08/2023 03:38:34 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 4, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'path': './adj_mat/Beauty', 'seed': 42, 'log_file': './logs/finetune-amazon-2layer-ngcf-beauty.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-ngcf', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
12/08/2023 03:39:59 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
12/08/2023 03:39:59 - INFO - trainer.finetune_trainer - ***** Run training *****
12/08/2023 03:39:59 - INFO - trainer.finetune_trainer -   Num examples = 131413
12/08/2023 03:39:59 - INFO - trainer.finetune_trainer -   Num Epochs = 500
12/08/2023 03:39:59 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
12/08/2023 03:39:59 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
12/08/2023 03:39:59 - INFO - trainer.finetune_trainer -   Total steps = 32500
12/08/2023 03:42:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
12/08/2023 03:42:31 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.030899252742528915, R@50:0.08531949669122696, NDCG@10:0.015712281689047813, NDCG@50:0.0274910107254982
12/08/2023 03:42:31 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch-ngcf
