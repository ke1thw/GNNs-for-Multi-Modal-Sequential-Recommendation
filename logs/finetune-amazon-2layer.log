10/28/2023 05:49:02 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 8, 'train_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Sports/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Sports/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Sports/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Sports-8192batch', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 8, 'device': device(type='cuda', index=0)}
10/28/2023 22:42:41 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 8, 'train_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Sports/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Sports/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Sports/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Sports-8192batch', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 8, 'device': device(type='cuda', index=0)}
10/29/2023 01:02:47 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Sports/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Sports/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Sports/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Sports/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Sports-8192batch', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
10/29/2023 01:03:31 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
10/29/2023 01:03:32 - INFO - trainer.finetune_trainer - ***** Run training *****
10/29/2023 01:03:32 - INFO - trainer.finetune_trainer -   Num examples = 189543
10/29/2023 01:03:32 - INFO - trainer.finetune_trainer -   Num Epochs = 500
10/29/2023 01:03:32 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
10/29/2023 01:03:32 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
10/29/2023 01:03:32 - INFO - trainer.finetune_trainer -   Total steps = 46500
10/29/2023 01:04:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:04:06 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.03297938033938408, R@50:0.09629754722118378, NDCG@10:0.017057666555047035, NDCG@50:0.030624879524111748
10/29/2023 01:04:06 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Sports-8192batch
10/29/2023 01:04:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:04:35 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.04239002242684364, R@50:0.11801224946975708, NDCG@10:0.021401669830083847, NDCG@50:0.03770206868648529
10/29/2023 01:04:35 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Sports-8192batch
10/29/2023 01:05:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:05:04 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.044749706983566284, R@50:0.12705770134925842, NDCG@10:0.023081060498952866, NDCG@50:0.04081927239894867
10/29/2023 01:05:04 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Sports-8192batch
10/29/2023 01:05:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:05:34 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.047586943954229355, R@50:0.13388392329216003, NDCG@10:0.02443120814859867, NDCG@50:0.04300544783473015
10/29/2023 01:05:34 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Sports-8192batch
10/29/2023 01:06:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:06:03 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.05036799982190132, R@50:0.13787291944026947, NDCG@10:0.02527707628905773, NDCG@50:0.0441046766936779
10/29/2023 01:06:03 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Sports-8192batch
10/29/2023 01:06:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:06:33 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.05118265002965927, R@50:0.14132817089557648, NDCG@10:0.025714095681905746, NDCG@50:0.04508962482213974
10/29/2023 01:06:33 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Sports-8192batch
10/29/2023 01:06:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:07:02 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.0533737875521183, R@50:0.1448395997285843, NDCG@10:0.026672836393117905, NDCG@50:0.0463980995118618
10/29/2023 01:07:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Sports-8192batch
10/29/2023 01:07:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:07:32 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.05387943238019943, R@50:0.14686219394207, NDCG@10:0.027574583888053894, NDCG@50:0.04761083796620369
10/29/2023 01:07:32 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Sports-8192batch
10/29/2023 01:07:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:08:01 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.05323332920670509, R@50:0.14790156483650208, NDCG@10:0.026769177988171577, NDCG@50:0.04720696806907654
10/29/2023 01:08:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:08:30 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.05522782355546951, R@50:0.15048599243164062, NDCG@10:0.02770429290831089, NDCG@50:0.04826665297150612
10/29/2023 01:08:30 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 9 to ./weights/finetune-Sports-8192batch
10/29/2023 01:08:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:08:59 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.0566604882478714, R@50:0.15360413491725922, NDCG@10:0.02852444350719452, NDCG@50:0.04933062940835953
10/29/2023 01:08:59 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Sports-8192batch
10/29/2023 01:09:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:09:29 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.05702567845582962, R@50:0.15453115105628967, NDCG@10:0.02882215939462185, NDCG@50:0.049849968403577805
10/29/2023 01:09:29 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 11 to ./weights/finetune-Sports-8192batch
10/29/2023 01:09:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:09:58 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.05916062742471695, R@50:0.15801450610160828, NDCG@10:0.029673758894205093, NDCG@50:0.05094829201698303
10/29/2023 01:09:58 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 12 to ./weights/finetune-Sports-8192batch
10/29/2023 01:10:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:10:28 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.05946963280439377, R@50:0.15736839175224304, NDCG@10:0.03000708669424057, NDCG@50:0.051068179309368134
10/29/2023 01:10:28 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 13 to ./weights/finetune-Sports-8192batch
10/29/2023 01:10:54 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:10:57 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.05885162204504013, R@50:0.156722292304039, NDCG@10:0.029640303924679756, NDCG@50:0.05079387128353119
10/29/2023 01:11:23 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:11:26 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.059750549495220184, R@50:0.1583235114812851, NDCG@10:0.02986150234937668, NDCG@50:0.05114857107400894
10/29/2023 01:11:26 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 15 to ./weights/finetune-Sports-8192batch
10/29/2023 01:11:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:11:55 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.06078993156552315, R@50:0.1598123461008072, NDCG@10:0.03054114431142807, NDCG@50:0.05191023275256157
10/29/2023 01:11:55 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Sports-8192batch
10/29/2023 01:12:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:12:25 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.06135176122188568, R@50:0.16048654913902283, NDCG@10:0.03073142282664776, NDCG@50:0.0521245077252388
10/29/2023 01:12:25 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 17 to ./weights/finetune-Sports-8192batch
10/29/2023 01:12:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:12:54 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.06196977570652962, R@50:0.1616383045911789, NDCG@10:0.0310019813477993, NDCG@50:0.052505627274513245
10/29/2023 01:12:54 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Sports-8192batch
10/29/2023 01:13:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:13:24 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.06188550218939781, R@50:0.1635485142469406, NDCG@10:0.03127683699131012, NDCG@50:0.0531860888004303
10/29/2023 01:13:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:13:53 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.06289679557085037, R@50:0.16396988928318024, NDCG@10:0.03166797012090683, NDCG@50:0.05355539172887802
10/29/2023 01:13:53 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 20 to ./weights/finetune-Sports-8192batch
10/29/2023 01:14:19 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:14:22 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.06351480633020401, R@50:0.16427889466285706, NDCG@10:0.0318482406437397, NDCG@50:0.05366792529821396
10/29/2023 01:14:22 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 21 to ./weights/finetune-Sports-8192batch
10/29/2023 01:14:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:14:51 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.06373953819274902, R@50:0.16610483825206757, NDCG@10:0.03196695074439049, NDCG@50:0.05407482758164406
10/29/2023 01:14:51 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 22 to ./weights/finetune-Sports-8192batch
10/29/2023 01:15:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:15:21 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.0633743479847908, R@50:0.16543065011501312, NDCG@10:0.031753767281770706, NDCG@50:0.05385708063840866
10/29/2023 01:15:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:15:50 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.06466655433177948, R@50:0.1664419323205948, NDCG@10:0.03261949121952057, NDCG@50:0.05470483377575874
10/29/2023 01:15:50 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 24 to ./weights/finetune-Sports-8192batch
10/29/2023 01:16:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:16:19 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.06486319750547409, R@50:0.16604866087436676, NDCG@10:0.03282782807946205, NDCG@50:0.05481760948896408
10/29/2023 01:16:19 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 25 to ./weights/finetune-Sports-8192batch
10/29/2023 01:16:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:16:49 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.06449800729751587, R@50:0.16750942170619965, NDCG@10:0.03237738460302353, NDCG@50:0.054665569216012955
10/29/2023 01:17:15 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:17:18 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.06548120826482773, R@50:0.16728468239307404, NDCG@10:0.03301732987165451, NDCG@50:0.054979078471660614
10/29/2023 01:17:18 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 27 to ./weights/finetune-Sports-8192batch
10/29/2023 01:17:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:17:47 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.0666891410946846, R@50:0.17054329812526703, NDCG@10:0.033301934599876404, NDCG@50:0.0557536743581295
10/29/2023 01:17:47 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 28 to ./weights/finetune-Sports-8192batch
10/29/2023 01:18:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:18:17 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.06632395088672638, R@50:0.16911062598228455, NDCG@10:0.03328894451260567, NDCG@50:0.05547431856393814
10/29/2023 01:18:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:18:46 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.06466655433177948, R@50:0.16877353191375732, NDCG@10:0.032456595450639725, NDCG@50:0.054983023554086685
10/29/2023 01:19:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:19:15 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.06694196164608002, R@50:0.17113322019577026, NDCG@10:0.03346557170152664, NDCG@50:0.055908333510160446
10/29/2023 01:19:15 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 31 to ./weights/finetune-Sports-8192batch
10/29/2023 01:19:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:19:44 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.06795325875282288, R@50:0.1700095534324646, NDCG@10:0.03381120041012764, NDCG@50:0.05587809160351753
10/29/2023 01:19:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 32 to ./weights/finetune-Sports-8192batch
10/29/2023 01:20:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:20:14 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.06708241999149323, R@50:0.16950391232967377, NDCG@10:0.03340495750308037, NDCG@50:0.0555807426571846
10/29/2023 01:20:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:20:43 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.06741952151060104, R@50:0.1717793196439743, NDCG@10:0.03403870388865471, NDCG@50:0.05656738206744194
10/29/2023 01:21:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:21:12 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.0684027224779129, R@50:0.17228496074676514, NDCG@10:0.03418754041194916, NDCG@50:0.05661230906844139
10/29/2023 01:21:12 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 35 to ./weights/finetune-Sports-8192batch
10/29/2023 01:21:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:21:42 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.06730715185403824, R@50:0.17222878336906433, NDCG@10:0.03378362953662872, NDCG@50:0.05648276209831238
10/29/2023 01:22:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:22:11 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.06809371709823608, R@50:0.1719197779893875, NDCG@10:0.03413199633359909, NDCG@50:0.05654969811439514
10/29/2023 01:22:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:22:40 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.06722287833690643, R@50:0.17132985591888428, NDCG@10:0.03404104337096214, NDCG@50:0.05654284358024597
10/29/2023 01:23:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:23:09 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.06699814647436142, R@50:0.17107702791690826, NDCG@10:0.03367560729384422, NDCG@50:0.05623943731188774
10/29/2023 01:23:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:23:39 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.06873981654644012, R@50:0.17068375647068024, NDCG@10:0.034637451171875, NDCG@50:0.05669114366173744
10/29/2023 01:23:39 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 40 to ./weights/finetune-Sports-8192batch
10/29/2023 01:24:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:24:08 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.06952638179063797, R@50:0.17245350778102875, NDCG@10:0.034912627190351486, NDCG@50:0.057154104113578796
10/29/2023 01:24:08 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 41 to ./weights/finetune-Sports-8192batch
10/29/2023 01:24:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:24:37 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.0684308111667633, R@50:0.17242541909217834, NDCG@10:0.034086376428604126, NDCG@50:0.05658947303891182
10/29/2023 01:25:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:25:07 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.06851508468389511, R@50:0.17385809123516083, NDCG@10:0.0343942828476429, NDCG@50:0.05721437931060791
10/29/2023 01:25:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:25:36 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.06888027489185333, R@50:0.17242541909217834, NDCG@10:0.0347059965133667, NDCG@50:0.057094041258096695
10/29/2023 01:26:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:26:05 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.06775661557912827, R@50:0.17284679412841797, NDCG@10:0.03423392027616501, NDCG@50:0.05694907531142235
10/29/2023 01:26:31 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:26:34 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.06809371709823608, R@50:0.1734648048877716, NDCG@10:0.034127578139305115, NDCG@50:0.05689481273293495
10/29/2023 01:27:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:27:04 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.06899264454841614, R@50:0.17360526323318481, NDCG@10:0.0347268208861351, NDCG@50:0.05728334188461304
10/29/2023 01:27:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:27:33 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.06961065530776978, R@50:0.17309962213039398, NDCG@10:0.034938182681798935, NDCG@50:0.05729156360030174
10/29/2023 01:27:33 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 48 to ./weights/finetune-Sports-8192batch
10/29/2023 01:27:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:28:02 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.06848699599504471, R@50:0.17416709661483765, NDCG@10:0.03442135453224182, NDCG@50:0.05723988637328148
10/29/2023 01:28:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:28:31 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.06781280040740967, R@50:0.17222878336906433, NDCG@10:0.034098945558071136, NDCG@50:0.056712567806243896
10/29/2023 01:28:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:29:01 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.0682903528213501, R@50:0.17537502944469452, NDCG@10:0.03394800424575806, NDCG@50:0.05706007778644562
10/29/2023 01:29:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:29:30 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.06857126951217651, R@50:0.17557166516780853, NDCG@10:0.034054312855005264, NDCG@50:0.05721653625369072
10/29/2023 01:29:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:29:59 - INFO - trainer.finetune_evaluator - Epoch 53 Eval Result: R@10:0.06862745434045792, R@50:0.17422327399253845, NDCG@10:0.034227676689624786, NDCG@50:0.05702708289027214
10/29/2023 01:30:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:30:28 - INFO - trainer.finetune_evaluator - Epoch 54 Eval Result: R@10:0.06977920234203339, R@50:0.1748693734407425, NDCG@10:0.035031870007514954, NDCG@50:0.057765018194913864
10/29/2023 01:30:28 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 54 to ./weights/finetune-Sports-8192batch
10/29/2023 01:30:54 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:30:58 - INFO - trainer.finetune_evaluator - Epoch 55 Eval Result: R@10:0.0684308111667633, R@50:0.17450419068336487, NDCG@10:0.034004952758550644, NDCG@50:0.056971605867147446
10/29/2023 01:31:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:31:27 - INFO - trainer.finetune_evaluator - Epoch 56 Eval Result: R@10:0.06859935820102692, R@50:0.176751509308815, NDCG@10:0.03431839495897293, NDCG@50:0.057745274156332016
10/29/2023 01:31:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:31:56 - INFO - trainer.finetune_evaluator - Epoch 57 Eval Result: R@10:0.06851508468389511, R@50:0.17610540986061096, NDCG@10:0.03421783447265625, NDCG@50:0.05743524059653282
10/29/2023 01:32:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:32:25 - INFO - trainer.finetune_evaluator - Epoch 58 Eval Result: R@10:0.06944210827350616, R@50:0.17621776461601257, NDCG@10:0.0347009040415287, NDCG@50:0.057780921459198
10/29/2023 01:32:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:32:55 - INFO - trainer.finetune_evaluator - Epoch 59 Eval Result: R@10:0.06859935820102692, R@50:0.17478510737419128, NDCG@10:0.03440336138010025, NDCG@50:0.05739831551909447
10/29/2023 01:33:21 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:33:24 - INFO - trainer.finetune_evaluator - Epoch 60 Eval Result: R@10:0.06927355378866196, R@50:0.17574021220207214, NDCG@10:0.034281473606824875, NDCG@50:0.057225268334150314
10/29/2023 01:33:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:33:53 - INFO - trainer.finetune_evaluator - Epoch 61 Eval Result: R@10:0.06963874399662018, R@50:0.17464464902877808, NDCG@10:0.0346687026321888, NDCG@50:0.05736314505338669
10/29/2023 01:34:19 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:34:22 - INFO - trainer.finetune_evaluator - Epoch 62 Eval Result: R@10:0.06932973861694336, R@50:0.17475701868534088, NDCG@10:0.03429241105914116, NDCG@50:0.05720589682459831
10/29/2023 01:34:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:34:52 - INFO - trainer.finetune_evaluator - Epoch 63 Eval Result: R@10:0.06902073323726654, R@50:0.1750379204750061, NDCG@10:0.03458155691623688, NDCG@50:0.05755273625254631
10/29/2023 01:35:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:35:21 - INFO - trainer.finetune_evaluator - Epoch 64 Eval Result: R@10:0.06986347585916519, R@50:0.17554357647895813, NDCG@10:0.034797072410583496, NDCG@50:0.05772486329078674
10/29/2023 01:35:21 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 64 to ./weights/finetune-Sports-8192batch
10/29/2023 01:35:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:35:50 - INFO - trainer.finetune_evaluator - Epoch 65 Eval Result: R@10:0.06854318082332611, R@50:0.1749536544084549, NDCG@10:0.034076280891895294, NDCG@50:0.05707637220621109
10/29/2023 01:36:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:36:19 - INFO - trainer.finetune_evaluator - Epoch 66 Eval Result: R@10:0.06952638179063797, R@50:0.17548738420009613, NDCG@10:0.034359417855739594, NDCG@50:0.05729609355330467
10/29/2023 01:36:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:36:49 - INFO - trainer.finetune_evaluator - Epoch 67 Eval Result: R@10:0.07014439254999161, R@50:0.17588067054748535, NDCG@10:0.03496411442756653, NDCG@50:0.05784160643815994
10/29/2023 01:36:49 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 67 to ./weights/finetune-Sports-8192batch
10/29/2023 01:37:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:37:18 - INFO - trainer.finetune_evaluator - Epoch 68 Eval Result: R@10:0.06893645972013474, R@50:0.1732681691646576, NDCG@10:0.03458462283015251, NDCG@50:0.0572228766977787
10/29/2023 01:37:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:37:47 - INFO - trainer.finetune_evaluator - Epoch 69 Eval Result: R@10:0.06910500675439835, R@50:0.1748974770307541, NDCG@10:0.03455504775047302, NDCG@50:0.057448115199804306
10/29/2023 01:38:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:38:16 - INFO - trainer.finetune_evaluator - Epoch 70 Eval Result: R@10:0.06873981654644012, R@50:0.1752626597881317, NDCG@10:0.0340939462184906, NDCG@50:0.0571577325463295
10/29/2023 01:38:42 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:38:46 - INFO - trainer.finetune_evaluator - Epoch 71 Eval Result: R@10:0.06851508468389511, R@50:0.17725715041160583, NDCG@10:0.034027814865112305, NDCG@50:0.05755666643381119
10/29/2023 01:39:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:39:15 - INFO - trainer.finetune_evaluator - Epoch 72 Eval Result: R@10:0.06918928027153015, R@50:0.1749817430973053, NDCG@10:0.034260645508766174, NDCG@50:0.05714525654911995
10/29/2023 01:39:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:39:44 - INFO - trainer.finetune_evaluator - Epoch 73 Eval Result: R@10:0.06941401213407516, R@50:0.17397044599056244, NDCG@10:0.03437165543437004, NDCG@50:0.056994494050741196
10/29/2023 01:40:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:40:13 - INFO - trainer.finetune_evaluator - Epoch 74 Eval Result: R@10:0.06854318082332611, R@50:0.17582449316978455, NDCG@10:0.0340200811624527, NDCG@50:0.05719545856118202
10/29/2023 01:40:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:40:42 - INFO - trainer.finetune_evaluator - Epoch 75 Eval Result: R@10:0.06868363916873932, R@50:0.17568403482437134, NDCG@10:0.03424128144979477, NDCG@50:0.057462986558675766
10/29/2023 01:41:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:41:12 - INFO - trainer.finetune_evaluator - Epoch 76 Eval Result: R@10:0.06955447047948837, R@50:0.1748131960630417, NDCG@10:0.03476635739207268, NDCG@50:0.0575266033411026
10/29/2023 01:41:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:41:41 - INFO - trainer.finetune_evaluator - Epoch 77 Eval Result: R@10:0.07050958275794983, R@50:0.17599304020404816, NDCG@10:0.034240223467350006, NDCG@50:0.05695479363203049
10/29/2023 01:41:41 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 77 to ./weights/finetune-Sports-8192batch
10/29/2023 01:42:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:42:10 - INFO - trainer.finetune_evaluator - Epoch 78 Eval Result: R@10:0.07025675475597382, R@50:0.17627395689487457, NDCG@10:0.03498898446559906, NDCG@50:0.05791626498103142
10/29/2023 01:42:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:42:39 - INFO - trainer.finetune_evaluator - Epoch 79 Eval Result: R@10:0.06983538717031479, R@50:0.17531883716583252, NDCG@10:0.03465352579951286, NDCG@50:0.05750822648406029
10/29/2023 01:43:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:43:09 - INFO - trainer.finetune_evaluator - Epoch 80 Eval Result: R@10:0.07067812979221344, R@50:0.17568403482437134, NDCG@10:0.03489743918180466, NDCG@50:0.05752754211425781
10/29/2023 01:43:09 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 80 to ./weights/finetune-Sports-8192batch
10/29/2023 01:43:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:43:38 - INFO - trainer.finetune_evaluator - Epoch 81 Eval Result: R@10:0.07034102827310562, R@50:0.17585258185863495, NDCG@10:0.034547436982393265, NDCG@50:0.05729101225733757
10/29/2023 01:44:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:44:07 - INFO - trainer.finetune_evaluator - Epoch 82 Eval Result: R@10:0.0700039342045784, R@50:0.17433564364910126, NDCG@10:0.034576207399368286, NDCG@50:0.05718154460191727
10/29/2023 01:44:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:44:36 - INFO - trainer.finetune_evaluator - Epoch 83 Eval Result: R@10:0.06823417544364929, R@50:0.1735771745443344, NDCG@10:0.03370541334152222, NDCG@50:0.05658014118671417
10/29/2023 01:45:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:45:05 - INFO - trainer.finetune_evaluator - Epoch 84 Eval Result: R@10:0.06896454840898514, R@50:0.17571212351322174, NDCG@10:0.0341731458902359, NDCG@50:0.05734509229660034
10/29/2023 01:45:31 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:45:35 - INFO - trainer.finetune_evaluator - Epoch 85 Eval Result: R@10:0.0682622641324997, R@50:0.17475701868534088, NDCG@10:0.03378136828541756, NDCG@50:0.05688446760177612
10/29/2023 01:46:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:46:04 - INFO - trainer.finetune_evaluator - Epoch 86 Eval Result: R@10:0.0700882077217102, R@50:0.1765267699956894, NDCG@10:0.03450094163417816, NDCG@50:0.05745931714773178
10/29/2023 01:46:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:46:33 - INFO - trainer.finetune_evaluator - Epoch 87 Eval Result: R@10:0.06882409006357193, R@50:0.17554357647895813, NDCG@10:0.033829107880592346, NDCG@50:0.056902337819337845
10/29/2023 01:46:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:47:02 - INFO - trainer.finetune_evaluator - Epoch 88 Eval Result: R@10:0.0682622641324997, R@50:0.17593684792518616, NDCG@10:0.0339125320315361, NDCG@50:0.05724998936057091
10/29/2023 01:47:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:47:32 - INFO - trainer.finetune_evaluator - Epoch 89 Eval Result: R@10:0.06893645972013474, R@50:0.17607730627059937, NDCG@10:0.03390895947813988, NDCG@50:0.05705834925174713
10/29/2023 01:47:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 01:48:01 - INFO - trainer.finetune_evaluator - Epoch 90 Eval Result: R@10:0.06904882192611694, R@50:0.17576830089092255, NDCG@10:0.03417326882481575, NDCG@50:0.0572316013276577
10/29/2023 01:48:01 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Sports-8192batch
10/29/2023 01:48:01 - INFO - trainer.finetune_evaluator - ***** Run test *****
10/29/2023 01:48:04 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.06199786812067032, R@50:0.1615540236234665, NDCG@10:0.031248511746525764, NDCG@50:0.05291282758116722
10/29/2023 04:02:53 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
10/29/2023 04:03:20 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
10/29/2023 04:03:20 - INFO - trainer.finetune_trainer - ***** Run training *****
10/29/2023 04:03:20 - INFO - trainer.finetune_trainer -   Num examples = 131413
10/29/2023 04:03:20 - INFO - trainer.finetune_trainer -   Num Epochs = 500
10/29/2023 04:03:20 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
10/29/2023 04:03:20 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
10/29/2023 04:03:20 - INFO - trainer.finetune_trainer -   Total steps = 32500
10/29/2023 04:03:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:03:42 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.043419934809207916, R@50:0.12346286326646805, NDCG@10:0.021555984392762184, NDCG@50:0.03884207829833031
10/29/2023 04:03:42 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:03:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:03:58 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.056745514273643494, R@50:0.16129320859909058, NDCG@10:0.027500437572598457, NDCG@50:0.04996320977807045
10/29/2023 04:03:58 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:04:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:04:15 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.06416849046945572, R@50:0.1794481873512268, NDCG@10:0.031636130064725876, NDCG@50:0.056289974600076675
10/29/2023 04:04:15 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:04:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:04:32 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.07011581212282181, R@50:0.1891070008277893, NDCG@10:0.03480217978358269, NDCG@50:0.06040604040026665
10/29/2023 04:04:32 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:04:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:04:49 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.07409559935331345, R@50:0.19407056272029877, NDCG@10:0.03589519485831261, NDCG@50:0.06181525066494942
10/29/2023 04:04:49 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:05:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:05:06 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.07990877330303192, R@50:0.20033089816570282, NDCG@10:0.038622040301561356, NDCG@50:0.06470794975757599
10/29/2023 04:05:06 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:05:21 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:05:22 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.08514063060283661, R@50:0.21052631735801697, NDCG@10:0.04140445217490196, NDCG@50:0.06868032366037369
10/29/2023 04:05:22 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:05:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:05:39 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.08625855296850204, R@50:0.2150874137878418, NDCG@10:0.0418473482131958, NDCG@50:0.06981372833251953
10/29/2023 04:05:39 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:05:54 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:05:56 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.08813665062189102, R@50:0.21705494821071625, NDCG@10:0.04288617894053459, NDCG@50:0.07088243216276169
10/29/2023 04:05:56 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:06:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:06:13 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.08755533397197723, R@50:0.21692080795764923, NDCG@10:0.04244062304496765, NDCG@50:0.07046175003051758
10/29/2023 04:06:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:06:30 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.0910879522562027, R@50:0.2248803824186325, NDCG@10:0.04374800622463226, NDCG@50:0.07279033213853836
10/29/2023 04:06:30 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:06:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:06:46 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.09175870567560196, R@50:0.22505924105644226, NDCG@10:0.044253647327423096, NDCG@50:0.07325931638479233
10/29/2023 04:06:46 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 11 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:07:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:07:03 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.0946652963757515, R@50:0.22711621224880219, NDCG@10:0.04576127603650093, NDCG@50:0.0745140016078949
10/29/2023 04:07:03 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 12 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:07:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:07:20 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.09421812742948532, R@50:0.23181146383285522, NDCG@10:0.04596627131104469, NDCG@50:0.0758274719119072
10/29/2023 04:07:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:07:37 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.09511245787143707, R@50:0.2314090132713318, NDCG@10:0.0457800030708313, NDCG@50:0.07540369778871536
10/29/2023 04:07:37 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 14 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:07:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:07:53 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.09614094346761703, R@50:0.23212449252605438, NDCG@10:0.04603083059191704, NDCG@50:0.07555469125509262
10/29/2023 04:07:53 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 15 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:08:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:08:10 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.09511245787143707, R@50:0.23248222470283508, NDCG@10:0.04558037966489792, NDCG@50:0.07539570331573486
10/29/2023 04:08:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:08:27 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.09775074571371078, R@50:0.2358359694480896, NDCG@10:0.04745431989431381, NDCG@50:0.07750561088323593
10/29/2023 04:08:27 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 17 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:08:42 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:08:44 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.09891337901353836, R@50:0.2356123924255371, NDCG@10:0.048150353133678436, NDCG@50:0.07782701402902603
10/29/2023 04:08:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:08:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:09:01 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.09810847789049149, R@50:0.24075481295585632, NDCG@10:0.04813859611749649, NDCG@50:0.07925918698310852
10/29/2023 04:09:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:09:17 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.10204355418682098, R@50:0.24066537618637085, NDCG@10:0.049606774002313614, NDCG@50:0.07956919819116592
10/29/2023 04:09:17 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 20 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:09:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:09:34 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.10083620250225067, R@50:0.23923444747924805, NDCG@10:0.0486755296587944, NDCG@50:0.0787227675318718
10/29/2023 04:09:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:09:51 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.10114921629428864, R@50:0.23910029232501984, NDCG@10:0.048588886857032776, NDCG@50:0.07857132703065872
10/29/2023 04:10:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:10:07 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.10132808238267899, R@50:0.24258819222450256, NDCG@10:0.04872024431824684, NDCG@50:0.0793779194355011
10/29/2023 04:10:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:10:24 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.1039663702249527, R@50:0.24652327597141266, NDCG@10:0.04995202273130417, NDCG@50:0.0809716209769249
10/29/2023 04:10:24 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 24 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:10:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:10:41 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.1039663702249527, R@50:0.24272234737873077, NDCG@10:0.049376748502254486, NDCG@50:0.07958324253559113
10/29/2023 04:10:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:10:58 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.10365335643291473, R@50:0.24366140365600586, NDCG@10:0.04998958855867386, NDCG@50:0.08043454587459564
10/29/2023 04:11:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:11:14 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.10445825755596161, R@50:0.24603138864040375, NDCG@10:0.050790999084711075, NDCG@50:0.0816202461719513
10/29/2023 04:11:14 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 27 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:11:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:11:31 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.10374278575181961, R@50:0.24518176913261414, NDCG@10:0.05013076961040497, NDCG@50:0.08097419142723083
10/29/2023 04:11:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:11:48 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.10642579197883606, R@50:0.24616552889347076, NDCG@10:0.051586467772722244, NDCG@50:0.08196613937616348
10/29/2023 04:11:48 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 29 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:12:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:12:05 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.10553145408630371, R@50:0.24531592428684235, NDCG@10:0.05107235535979271, NDCG@50:0.0815475732088089
10/29/2023 04:12:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:12:21 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.10597862303256989, R@50:0.24840137362480164, NDCG@10:0.05106333643198013, NDCG@50:0.08204369246959686
10/29/2023 04:12:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:12:38 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.1053973063826561, R@50:0.24576307833194733, NDCG@10:0.050889745354652405, NDCG@50:0.08151821047067642
10/29/2023 04:12:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:12:55 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.10544202476739883, R@50:0.24424271285533905, NDCG@10:0.05093565210700035, NDCG@50:0.08122727274894714
10/29/2023 04:13:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:13:11 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.1061127707362175, R@50:0.24580779671669006, NDCG@10:0.051473505795001984, NDCG@50:0.08198754489421844
10/29/2023 04:13:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:13:28 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.10673880577087402, R@50:0.2471493035554886, NDCG@10:0.051387589424848557, NDCG@50:0.08202135562896729
10/29/2023 04:13:28 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 35 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:13:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:13:45 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.10812502354383469, R@50:0.2472834587097168, NDCG@10:0.05244666337966919, NDCG@50:0.08279362320899963
10/29/2023 04:13:45 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 36 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:14:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:14:02 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.10915350914001465, R@50:0.2474175989627838, NDCG@10:0.05270395800471306, NDCG@50:0.08289045095443726
10/29/2023 04:14:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 37 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:14:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:14:19 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.10808030515909195, R@50:0.2465679794549942, NDCG@10:0.05226370319724083, NDCG@50:0.08236141502857208
10/29/2023 04:14:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:14:35 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.10973482578992844, R@50:0.2500111758708954, NDCG@10:0.052687253803014755, NDCG@50:0.08323600143194199
10/29/2023 04:14:35 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 39 to ./weights/finetune-Beauty-8192batch
10/29/2023 04:14:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:14:52 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.10571032017469406, R@50:0.2456289380788803, NDCG@10:0.05140021815896034, NDCG@50:0.08177196234464645
10/29/2023 04:15:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:15:09 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.1079014390707016, R@50:0.24831193685531616, NDCG@10:0.05187099054455757, NDCG@50:0.08245059847831726
10/29/2023 04:15:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:15:25 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.10723069310188293, R@50:0.2474175989627838, NDCG@10:0.05186891555786133, NDCG@50:0.08245082944631577
10/29/2023 04:15:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:15:42 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.10763314366340637, R@50:0.25045832991600037, NDCG@10:0.05215788260102272, NDCG@50:0.08340863138437271
10/29/2023 04:15:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:15:59 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.10732012242078781, R@50:0.2476411908864975, NDCG@10:0.051067523658275604, NDCG@50:0.08166643977165222
10/29/2023 04:16:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:16:15 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.10803559422492981, R@50:0.2502794861793518, NDCG@10:0.052454784512519836, NDCG@50:0.0834488496184349
10/29/2023 04:16:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:16:32 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.1082591786980629, R@50:0.24902740120887756, NDCG@10:0.05182057246565819, NDCG@50:0.08244744688272476
10/29/2023 04:16:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:16:49 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.10758842527866364, R@50:0.25032418966293335, NDCG@10:0.05211210623383522, NDCG@50:0.08316311985254288
10/29/2023 04:17:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:17:05 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.10857219249010086, R@50:0.25005587935447693, NDCG@10:0.05275570601224899, NDCG@50:0.08359195291996002
10/29/2023 04:17:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 04:17:22 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.10830388963222504, R@50:0.252873033285141, NDCG@10:0.051815878599882126, NDCG@50:0.08336083590984344
10/29/2023 04:17:22 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Beauty-8192batch
10/29/2023 04:17:22 - INFO - trainer.finetune_evaluator - ***** Run test *****
10/29/2023 04:17:24 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.09560434520244598, R@50:0.22801055014133453, NDCG@10:0.046153269708156586, NDCG@50:0.07492157071828842
10/29/2023 07:03:01 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Clothing/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Clothing/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Clothing/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Clothing/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Clothing/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Clothing/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Clothing-8192batch', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
10/29/2023 07:03:41 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
10/29/2023 07:03:41 - INFO - trainer.finetune_trainer - ***** Run training *****
10/29/2023 07:03:41 - INFO - trainer.finetune_trainer -   Num examples = 160516
10/29/2023 07:03:41 - INFO - trainer.finetune_trainer -   Num Epochs = 500
10/29/2023 07:03:41 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
10/29/2023 07:03:41 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
10/29/2023 07:03:41 - INFO - trainer.finetune_trainer -   Total steps = 39500
10/29/2023 07:04:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:04:16 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.0151826748624444, R@50:0.04839160293340683, NDCG@10:0.007717289496213198, NDCG@50:0.014774755574762821
10/29/2023 07:04:16 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:04:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:04:44 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.026683932170271873, R@50:0.0757356509566307, NDCG@10:0.01360716950148344, NDCG@50:0.024192679673433304
10/29/2023 07:04:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:05:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:05:13 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.031203189864754677, R@50:0.09124838560819626, NDCG@10:0.015824470669031143, NDCG@50:0.02874765731394291
10/29/2023 07:05:13 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:05:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:05:41 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.032904259860515594, R@50:0.09505674988031387, NDCG@10:0.016476033255457878, NDCG@50:0.029833242297172546
10/29/2023 07:05:41 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:06:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:06:09 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.03793129697442055, R@50:0.10625333338975906, NDCG@10:0.01874154806137085, NDCG@50:0.03347055986523628
10/29/2023 07:06:09 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:06:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:06:37 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.03892147168517113, R@50:0.11044253408908844, NDCG@10:0.019178546965122223, NDCG@50:0.034569915384054184
10/29/2023 07:06:37 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:07:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:07:06 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.041511159390211105, R@50:0.11295605450868607, NDCG@10:0.020490318536758423, NDCG@50:0.03596187010407448
10/29/2023 07:07:06 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:07:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:07:34 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.04217127710580826, R@50:0.11501257121562958, NDCG@10:0.02083585411310196, NDCG@50:0.036620453000068665
10/29/2023 07:07:34 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:07:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:08:02 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.04336456209421158, R@50:0.11991266161203384, NDCG@10:0.02109362743794918, NDCG@50:0.03758849948644638
10/29/2023 07:08:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:08:27 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:08:31 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.04272983595728874, R@50:0.12095361948013306, NDCG@10:0.02076064608991146, NDCG@50:0.03771544247865677
10/29/2023 07:08:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:08:59 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.044583238661289215, R@50:0.1208774521946907, NDCG@10:0.02161627635359764, NDCG@50:0.038061656057834625
10/29/2023 07:08:59 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:09:23 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:09:27 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.044989462941884995, R@50:0.12097900360822678, NDCG@10:0.0218415018171072, NDCG@50:0.038248952478170395
10/29/2023 07:09:27 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 11 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:09:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:09:56 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.04496407508850098, R@50:0.12280701845884323, NDCG@10:0.021545380353927612, NDCG@50:0.03842157498002052
10/29/2023 07:10:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:10:24 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.04443090409040451, R@50:0.12361947447061539, NDCG@10:0.02139628306031227, NDCG@50:0.038519904017448425
10/29/2023 07:10:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:10:52 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.04620813950896263, R@50:0.12458425760269165, NDCG@10:0.02226525917649269, NDCG@50:0.03919517993927002
10/29/2023 07:10:52 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 14 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:11:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:11:20 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.04531952366232872, R@50:0.12636148929595947, NDCG@10:0.02194439247250557, NDCG@50:0.03946452960371971
10/29/2023 07:11:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:11:48 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.04648742079734802, R@50:0.12768173217773438, NDCG@10:0.022332575172185898, NDCG@50:0.03993683680891991
10/29/2023 07:11:48 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:12:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:12:17 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.04671592265367508, R@50:0.1253713220357895, NDCG@10:0.02261105366051197, NDCG@50:0.03963715210556984
10/29/2023 07:12:17 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 17 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:12:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:12:45 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.04702059179544449, R@50:0.12671694159507751, NDCG@10:0.022597938776016235, NDCG@50:0.03990570455789566
10/29/2023 07:12:45 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:13:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:13:13 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.0468936450779438, R@50:0.1291796863079071, NDCG@10:0.022637054324150085, NDCG@50:0.04049094021320343
10/29/2023 07:13:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:13:41 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.047655317932367325, R@50:0.1263868808746338, NDCG@10:0.023227518424391747, NDCG@50:0.040260277688503265
10/29/2023 07:13:41 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 20 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:14:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:14:10 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.046868257224559784, R@50:0.12773250043392181, NDCG@10:0.022505315020680428, NDCG@50:0.04001646116375923
10/29/2023 07:14:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:14:38 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.047959987074136734, R@50:0.1297382414340973, NDCG@10:0.022959960624575615, NDCG@50:0.040672946721315384
10/29/2023 07:14:38 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 22 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:15:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:15:06 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.04773148521780968, R@50:0.1284434050321579, NDCG@10:0.022952307015657425, NDCG@50:0.040488023310899734
10/29/2023 07:15:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:15:34 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.04818848893046379, R@50:0.12864650785923004, NDCG@10:0.022926103323698044, NDCG@50:0.04038077965378761
10/29/2023 07:15:34 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 24 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:15:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:16:02 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.04801076650619507, R@50:0.129890576004982, NDCG@10:0.02326378971338272, NDCG@50:0.04107092320919037
10/29/2023 07:16:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:16:30 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.046284306794404984, R@50:0.12953512370586395, NDCG@10:0.022130638360977173, NDCG@50:0.04024537652730942
10/29/2023 07:16:55 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:16:59 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.048543937504291534, R@50:0.13202325999736786, NDCG@10:0.023196198046207428, NDCG@50:0.04126716032624245
10/29/2023 07:16:59 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 27 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:17:23 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:17:27 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.04920405521988869, R@50:0.13108386099338531, NDCG@10:0.023529842495918274, NDCG@50:0.04127204045653343
10/29/2023 07:17:27 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 28 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:17:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:17:55 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.04928022250533104, R@50:0.13146470487117767, NDCG@10:0.023408986628055573, NDCG@50:0.04121120274066925
10/29/2023 07:17:55 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 29 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:18:19 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:18:23 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.04976261407136917, R@50:0.13143931329250336, NDCG@10:0.02405441924929619, NDCG@50:0.04179131239652634
10/29/2023 07:18:23 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 30 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:18:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:18:52 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.048543937504291534, R@50:0.13291187584400177, NDCG@10:0.023214900866150856, NDCG@50:0.04153236374258995
10/29/2023 07:19:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:19:20 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.04968644678592682, R@50:0.1319217085838318, NDCG@10:0.023463580757379532, NDCG@50:0.04129515960812569
10/29/2023 07:19:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:19:48 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.048924773931503296, R@50:0.13291187584400177, NDCG@10:0.02340882271528244, NDCG@50:0.04162565991282463
10/29/2023 07:20:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:20:16 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.049737222492694855, R@50:0.13286109268665314, NDCG@10:0.023504143580794334, NDCG@50:0.041561052203178406
10/29/2023 07:20:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:20:44 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.05016883835196495, R@50:0.13235332071781158, NDCG@10:0.02339700609445572, NDCG@50:0.04122204706072807
10/29/2023 07:20:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 35 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:21:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:21:12 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.05014345049858093, R@50:0.13204865157604218, NDCG@10:0.023486029356718063, NDCG@50:0.041254691779613495
10/29/2023 07:21:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:21:41 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.05006728321313858, R@50:0.13301342725753784, NDCG@10:0.02377224713563919, NDCG@50:0.041741084307432175
10/29/2023 07:22:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:22:09 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.04999111592769623, R@50:0.13387666642665863, NDCG@10:0.023885630071163177, NDCG@50:0.042159710079431534
10/29/2023 07:22:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:22:37 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.05085434392094612, R@50:0.13402900099754333, NDCG@10:0.0240484531968832, NDCG@50:0.04206085205078125
10/29/2023 07:22:37 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 39 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:23:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:23:05 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.05054967477917671, R@50:0.13288648426532745, NDCG@10:0.02403450384736061, NDCG@50:0.04195740446448326
10/29/2023 07:23:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:23:33 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.05136212706565857, R@50:0.13232792913913727, NDCG@10:0.024189148098230362, NDCG@50:0.041774701327085495
10/29/2023 07:23:33 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 41 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:23:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:24:02 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.05075278878211975, R@50:0.13372433185577393, NDCG@10:0.024166366085410118, NDCG@50:0.04219934716820717
10/29/2023 07:24:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:24:30 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.050321172922849655, R@50:0.1323787122964859, NDCG@10:0.02376374788582325, NDCG@50:0.0416567362844944
10/29/2023 07:24:54 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:24:58 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.05077817663550377, R@50:0.1342574954032898, NDCG@10:0.02414581924676895, NDCG@50:0.042295727878808975
10/29/2023 07:25:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:25:26 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.05027039349079132, R@50:0.1341305524110794, NDCG@10:0.02378445863723755, NDCG@50:0.042021188884973526
10/29/2023 07:25:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:25:54 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.04986416921019554, R@50:0.13633941113948822, NDCG@10:0.023713313043117523, NDCG@50:0.04250996187329292
10/29/2023 07:26:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:26:22 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.05181913077831268, R@50:0.1341305524110794, NDCG@10:0.02415080927312374, NDCG@50:0.042018111795186996
10/29/2023 07:26:22 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 47 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:26:47 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:26:51 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.05133673548698425, R@50:0.13466373085975647, NDCG@10:0.024276642128825188, NDCG@50:0.0423760823905468
10/29/2023 07:27:15 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:27:19 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.051032066345214844, R@50:0.13329271972179413, NDCG@10:0.024185873568058014, NDCG@50:0.04209050163626671
10/29/2023 07:27:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:27:47 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.05166679620742798, R@50:0.13443522155284882, NDCG@10:0.02435731515288353, NDCG@50:0.042268265038728714
10/29/2023 07:28:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:28:15 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.050930511206388474, R@50:0.13562850654125214, NDCG@10:0.02407207153737545, NDCG@50:0.042496081441640854
10/29/2023 07:28:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:28:43 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.050905123353004456, R@50:0.13618707656860352, NDCG@10:0.02390933968126774, NDCG@50:0.042472902685403824
10/29/2023 07:29:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:29:11 - INFO - trainer.finetune_evaluator - Epoch 53 Eval Result: R@10:0.05115901306271553, R@50:0.1348414421081543, NDCG@10:0.02381816692650318, NDCG@50:0.04199332371354103
10/29/2023 07:29:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:29:40 - INFO - trainer.finetune_evaluator - Epoch 54 Eval Result: R@10:0.05222535505890846, R@50:0.13473989069461823, NDCG@10:0.024358218535780907, NDCG@50:0.04219893366098404
10/29/2023 07:29:40 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 54 to ./weights/finetune-Clothing-8192batch
10/29/2023 07:30:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:30:08 - INFO - trainer.finetune_evaluator - Epoch 55 Eval Result: R@10:0.0506766214966774, R@50:0.1364663541316986, NDCG@10:0.02385902963578701, NDCG@50:0.04249080270528793
10/29/2023 07:30:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:30:36 - INFO - trainer.finetune_evaluator - Epoch 56 Eval Result: R@10:0.05174296349287033, R@50:0.13575544953346252, NDCG@10:0.024324841797351837, NDCG@50:0.0425850935280323
10/29/2023 07:31:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:31:04 - INFO - trainer.finetune_evaluator - Epoch 57 Eval Result: R@10:0.05077817663550377, R@50:0.134993776679039, NDCG@10:0.02403295412659645, NDCG@50:0.04236816614866257
10/29/2023 07:31:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:31:32 - INFO - trainer.finetune_evaluator - Epoch 58 Eval Result: R@10:0.05019422620534897, R@50:0.13347043097019196, NDCG@10:0.023487187922000885, NDCG@50:0.04160303995013237
10/29/2023 07:31:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:32:00 - INFO - trainer.finetune_evaluator - Epoch 59 Eval Result: R@10:0.05186990648508072, R@50:0.13618707656860352, NDCG@10:0.02421552874147892, NDCG@50:0.04250204190611839
10/29/2023 07:32:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:32:28 - INFO - trainer.finetune_evaluator - Epoch 60 Eval Result: R@10:0.05156523734331131, R@50:0.13423210382461548, NDCG@10:0.024503193795681, NDCG@50:0.04247637838125229
10/29/2023 07:32:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:32:57 - INFO - trainer.finetune_evaluator - Epoch 61 Eval Result: R@10:0.05095589905977249, R@50:0.13613629341125488, NDCG@10:0.0241119135171175, NDCG@50:0.04266293719410896
10/29/2023 07:33:21 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:33:25 - INFO - trainer.finetune_evaluator - Epoch 62 Eval Result: R@10:0.05166679620742798, R@50:0.13677102327346802, NDCG@10:0.024606281891465187, NDCG@50:0.04305581748485565
10/29/2023 07:33:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:33:53 - INFO - trainer.finetune_evaluator - Epoch 63 Eval Result: R@10:0.05108284577727318, R@50:0.1361616849899292, NDCG@10:0.024283315986394882, NDCG@50:0.04273030161857605
10/29/2023 07:34:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/29/2023 07:34:21 - INFO - trainer.finetune_evaluator - Epoch 64 Eval Result: R@10:0.05057506263256073, R@50:0.1352730691432953, NDCG@10:0.023748105391860008, NDCG@50:0.04223109781742096
10/29/2023 07:34:21 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Clothing-8192batch
10/29/2023 07:34:21 - INFO - trainer.finetune_evaluator - ***** Run test *****
10/29/2023 07:34:25 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.04681747779250145, R@50:0.12978902459144592, NDCG@10:0.0223682913929224, NDCG@50:0.04040413722395897
10/30/2023 01:06:48 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Home-8192batch', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
10/30/2023 01:07:38 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
10/30/2023 01:07:38 - INFO - trainer.finetune_trainer - ***** Run training *****
10/30/2023 01:07:38 - INFO - trainer.finetune_trainer -   Num examples = 352125
10/30/2023 01:07:38 - INFO - trainer.finetune_trainer -   Num Epochs = 500
10/30/2023 01:07:38 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
10/30/2023 01:07:38 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
10/30/2023 01:07:38 - INFO - trainer.finetune_trainer -   Total steps = 86000
10/30/2023 01:08:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:08:52 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.0167771615087986, R@50:0.05360874533653259, NDCG@10:0.008194256573915482, NDCG@50:0.01609974354505539
10/30/2023 01:08:52 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Home-8192batch
10/30/2023 01:09:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:10:00 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.01993415504693985, R@50:0.060944993048906326, NDCG@10:0.01005537062883377, NDCG@50:0.01883283257484436
10/30/2023 01:10:00 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Home-8192batch
10/30/2023 01:11:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:11:08 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.02191855013370514, R@50:0.06614651530981064, NDCG@10:0.01099282968789339, NDCG@50:0.02051365002989769
10/30/2023 01:11:08 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Home-8192batch
10/30/2023 01:12:08 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:12:16 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.024414077401161194, R@50:0.07110750675201416, NDCG@10:0.012437151744961739, NDCG@50:0.022447070106863976
10/30/2023 01:12:16 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Home-8192batch
10/30/2023 01:13:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:13:24 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.025346141308546066, R@50:0.0745050311088562, NDCG@10:0.01284092292189598, NDCG@50:0.023340841755270958
10/30/2023 01:13:24 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Home-8192batch
10/30/2023 01:14:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:14:32 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.026894571259617805, R@50:0.07676002383232117, NDCG@10:0.013679095543920994, NDCG@50:0.024380765855312347
10/30/2023 01:14:32 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Home-8192batch
10/30/2023 01:15:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:15:40 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.026879537850618362, R@50:0.07709075510501862, NDCG@10:0.013540568761527538, NDCG@50:0.024320494383573532
10/30/2023 01:16:40 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:16:48 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.02760113775730133, R@50:0.07984185218811035, NDCG@10:0.013877023011446, NDCG@50:0.025072023272514343
10/30/2023 01:16:48 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Home-8192batch
10/30/2023 01:17:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:17:56 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.028848901391029358, R@50:0.08152557909488678, NDCG@10:0.01448562741279602, NDCG@50:0.025795184075832367
10/30/2023 01:17:56 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Home-8192batch
10/30/2023 01:18:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:19:04 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.02943519875407219, R@50:0.08340474218130112, NDCG@10:0.014522240497171879, NDCG@50:0.02612912841141224
10/30/2023 01:19:04 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 9 to ./weights/finetune-Home-8192batch
10/30/2023 01:20:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:20:12 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.030773162841796875, R@50:0.08448714017868042, NDCG@10:0.015750877559185028, NDCG@50:0.027296410873532295
10/30/2023 01:20:12 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Home-8192batch
10/30/2023 01:21:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:21:20 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.029946330934762955, R@50:0.08463747054338455, NDCG@10:0.01502204779535532, NDCG@50:0.02676359936594963
10/30/2023 01:22:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:22:27 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.031885627657175064, R@50:0.0880199670791626, NDCG@10:0.015856420621275902, NDCG@50:0.027936464175581932
10/30/2023 01:22:27 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 12 to ./weights/finetune-Home-8192batch
10/30/2023 01:23:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:23:35 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.03089343011379242, R@50:0.08826050162315369, NDCG@10:0.015493798069655895, NDCG@50:0.027890697121620178
10/30/2023 01:24:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:24:43 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.033388957381248474, R@50:0.08973376452922821, NDCG@10:0.016834374517202377, NDCG@50:0.028953351080417633
10/30/2023 01:24:43 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 14 to ./weights/finetune-Home-8192batch
10/30/2023 01:25:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:25:51 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.032757557928562164, R@50:0.09065078943967819, NDCG@10:0.016415121033787727, NDCG@50:0.028887996450066566
10/30/2023 01:26:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:26:59 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.03257715702056885, R@50:0.09001939743757248, NDCG@10:0.016340747475624084, NDCG@50:0.028727130964398384
10/30/2023 01:27:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:28:07 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.033629488199949265, R@50:0.09179332107305527, NDCG@10:0.01690833643078804, NDCG@50:0.029451649636030197
10/30/2023 01:28:07 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 17 to ./weights/finetune-Home-8192batch
10/30/2023 01:29:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:29:15 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.03352425619959831, R@50:0.09249988943338394, NDCG@10:0.016837064176797867, NDCG@50:0.02955014631152153
10/30/2023 01:30:15 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:30:22 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.034110553562641144, R@50:0.09283062070608139, NDCG@10:0.017139645293354988, NDCG@50:0.0298017431050539
10/30/2023 01:30:22 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 19 to ./weights/finetune-Home-8192batch
10/30/2023 01:31:23 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:31:30 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.034847188740968704, R@50:0.09251492470502853, NDCG@10:0.017345087602734566, NDCG@50:0.029808025807142258
10/30/2023 01:31:30 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 20 to ./weights/finetune-Home-8192batch
10/30/2023 01:32:31 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:32:38 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.03453148901462555, R@50:0.0938979834318161, NDCG@10:0.017543187364935875, NDCG@50:0.030355272814631462
10/30/2023 01:33:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:33:46 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.034125588834285736, R@50:0.09374765306711197, NDCG@10:0.0173735823482275, NDCG@50:0.03020603395998478
10/30/2023 01:34:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:34:54 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.03555375337600708, R@50:0.09574708342552185, NDCG@10:0.017761144787073135, NDCG@50:0.03073820471763611
10/30/2023 01:34:54 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 23 to ./weights/finetune-Home-8192batch
10/30/2023 01:35:54 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:36:02 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.035674016922712326, R@50:0.09422871470451355, NDCG@10:0.017873017117381096, NDCG@50:0.03051663562655449
10/30/2023 01:36:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 24 to ./weights/finetune-Home-8192batch
10/30/2023 01:37:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:37:10 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.03609495237469673, R@50:0.09478495270013809, NDCG@10:0.018072843551635742, NDCG@50:0.03074662759900093
10/30/2023 01:37:10 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 25 to ./weights/finetune-Home-8192batch
10/30/2023 01:38:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:38:18 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.03520798683166504, R@50:0.09642358124256134, NDCG@10:0.01765940524637699, NDCG@50:0.03084738925099373
10/30/2023 01:39:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:39:25 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.037222448736429214, R@50:0.09792690724134445, NDCG@10:0.018467821180820465, NDCG@50:0.031584784388542175
10/30/2023 01:39:25 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 27 to ./weights/finetune-Home-8192batch
10/30/2023 01:40:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:40:33 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.036395616829395294, R@50:0.09779161214828491, NDCG@10:0.018241040408611298, NDCG@50:0.03148717060685158
10/30/2023 01:41:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:41:41 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.03592958301305771, R@50:0.09679941087961197, NDCG@10:0.018075456842780113, NDCG@50:0.031258828938007355
10/30/2023 01:42:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:42:49 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.036455750465393066, R@50:0.09642358124256134, NDCG@10:0.018271759152412415, NDCG@50:0.031214740127325058
10/30/2023 01:43:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:43:57 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.037267547100782394, R@50:0.09849817305803299, NDCG@10:0.018703049048781395, NDCG@50:0.03193218633532524
10/30/2023 01:43:57 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 31 to ./weights/finetune-Home-8192batch
10/30/2023 01:44:57 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:45:04 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.03753814846277237, R@50:0.09863347560167313, NDCG@10:0.01885034702718258, NDCG@50:0.03203601762652397
10/30/2023 01:45:04 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 32 to ./weights/finetune-Home-8192batch
10/30/2023 01:46:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:46:12 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.03743291273713112, R@50:0.0993400365114212, NDCG@10:0.018801596015691757, NDCG@50:0.032189641147851944
10/30/2023 01:47:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:47:20 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.03842511028051376, R@50:0.09988123923540115, NDCG@10:0.019311560317873955, NDCG@50:0.032645534723997116
10/30/2023 01:47:20 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 34 to ./weights/finetune-Home-8192batch
10/30/2023 01:48:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:48:28 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.038575444370508194, R@50:0.09968580305576324, NDCG@10:0.019113225862383842, NDCG@50:0.032317034900188446
10/30/2023 01:48:28 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 35 to ./weights/finetune-Home-8192batch
10/30/2023 01:49:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:49:36 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.038635578006505966, R@50:0.09959560632705688, NDCG@10:0.019433490931987762, NDCG@50:0.032640717923641205
10/30/2023 01:49:36 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 36 to ./weights/finetune-Home-8192batch
10/30/2023 01:50:36 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:50:44 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.039357177913188934, R@50:0.10117410123348236, NDCG@10:0.019749542698264122, NDCG@50:0.033127561211586
10/30/2023 01:50:44 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 37 to ./weights/finetune-Home-8192batch
10/30/2023 01:51:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:51:51 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.03836498036980629, R@50:0.09968580305576324, NDCG@10:0.019273176789283752, NDCG@50:0.03253503888845444
10/30/2023 01:52:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:52:59 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.037913978099823, R@50:0.09893414378166199, NDCG@10:0.01883956789970398, NDCG@50:0.03202872350811958
10/30/2023 01:53:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:54:07 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.038094379007816315, R@50:0.10039237141609192, NDCG@10:0.01876112073659897, NDCG@50:0.03228240832686424
10/30/2023 01:55:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:55:15 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.038921210914850235, R@50:0.10126430541276932, NDCG@10:0.019313331693410873, NDCG@50:0.03279608488082886
10/30/2023 01:56:15 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:56:23 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.03831987828016281, R@50:0.09968580305576324, NDCG@10:0.019166355952620506, NDCG@50:0.032455965876579285
10/30/2023 01:57:23 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:57:30 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.03821464627981186, R@50:0.10100873559713364, NDCG@10:0.019396023824810982, NDCG@50:0.0330047681927681
10/30/2023 01:58:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:58:38 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.03862054646015167, R@50:0.10028713941574097, NDCG@10:0.019455503672361374, NDCG@50:0.03277469053864479
10/30/2023 01:59:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 01:59:46 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.039116643369197845, R@50:0.10007666796445847, NDCG@10:0.01956668496131897, NDCG@50:0.03279205784201622
10/30/2023 02:00:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:00:54 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.038966309279203415, R@50:0.1015198677778244, NDCG@10:0.01949223503470421, NDCG@50:0.03301418200135231
10/30/2023 02:01:54 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:02:02 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.04015394300222397, R@50:0.10142967104911804, NDCG@10:0.020039215683937073, NDCG@50:0.03331805765628815
10/30/2023 02:02:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 47 to ./weights/finetune-Home-8192batch
10/30/2023 02:03:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:03:09 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.03866564482450485, R@50:0.10154993087053299, NDCG@10:0.01970226876437664, NDCG@50:0.03331059589982033
10/30/2023 02:04:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:04:17 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.03985327482223511, R@50:0.10182053595781326, NDCG@10:0.01998327486217022, NDCG@50:0.033389683812856674
10/30/2023 02:05:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:05:25 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.03871074318885803, R@50:0.10182053595781326, NDCG@10:0.019451366737484932, NDCG@50:0.03311474621295929
10/30/2023 02:06:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:06:33 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.04034937545657158, R@50:0.10360949486494064, NDCG@10:0.020131995901465416, NDCG@50:0.033826813101768494
10/30/2023 02:06:33 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 51 to ./weights/finetune-Home-8192batch
10/30/2023 02:07:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:07:41 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.040078774094581604, R@50:0.10219636559486389, NDCG@10:0.020030366256833076, NDCG@50:0.033495962619781494
10/30/2023 02:08:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:08:48 - INFO - trainer.finetune_evaluator - Epoch 53 Eval Result: R@10:0.03995850682258606, R@50:0.10339903086423874, NDCG@10:0.019910022616386414, NDCG@50:0.03363699093461037
10/30/2023 02:09:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:09:56 - INFO - trainer.finetune_evaluator - Epoch 54 Eval Result: R@10:0.03941731154918671, R@50:0.10100873559713364, NDCG@10:0.019791124388575554, NDCG@50:0.033156197518110275
10/30/2023 02:10:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:11:04 - INFO - trainer.finetune_evaluator - Epoch 55 Eval Result: R@10:0.03995850682258606, R@50:0.10132443159818649, NDCG@10:0.019805682823061943, NDCG@50:0.03308701515197754
10/30/2023 02:12:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:12:12 - INFO - trainer.finetune_evaluator - Epoch 56 Eval Result: R@10:0.03949247673153877, R@50:0.10112900286912918, NDCG@10:0.019885187968611717, NDCG@50:0.03326772153377533
10/30/2023 02:13:12 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:13:20 - INFO - trainer.finetune_evaluator - Epoch 57 Eval Result: R@10:0.03962777554988861, R@50:0.10330882668495178, NDCG@10:0.020083341747522354, NDCG@50:0.03384705260396004
10/30/2023 02:14:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:14:28 - INFO - trainer.finetune_evaluator - Epoch 58 Eval Result: R@10:0.039206843823194504, R@50:0.10198590159416199, NDCG@10:0.01967030204832554, NDCG@50:0.03325517103075981
10/30/2023 02:15:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:15:35 - INFO - trainer.finetune_evaluator - Epoch 59 Eval Result: R@10:0.03967287763953209, R@50:0.10297809541225433, NDCG@10:0.019755590707063675, NDCG@50:0.03349466994404793
10/30/2023 02:16:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:16:43 - INFO - trainer.finetune_evaluator - Epoch 60 Eval Result: R@10:0.04065003991127014, R@50:0.1032487004995346, NDCG@10:0.020303530618548393, NDCG@50:0.03385049104690552
10/30/2023 02:16:43 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 60 to ./weights/finetune-Home-8192batch
10/30/2023 02:17:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:17:51 - INFO - trainer.finetune_evaluator - Epoch 61 Eval Result: R@10:0.0398683100938797, R@50:0.10293299704790115, NDCG@10:0.019816679880023003, NDCG@50:0.03349459171295166
10/30/2023 02:18:51 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:18:59 - INFO - trainer.finetune_evaluator - Epoch 62 Eval Result: R@10:0.04054480791091919, R@50:0.10344412922859192, NDCG@10:0.020536715164780617, NDCG@50:0.03412831947207451
10/30/2023 02:19:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:20:07 - INFO - trainer.finetune_evaluator - Epoch 63 Eval Result: R@10:0.040950708091259, R@50:0.10375983268022537, NDCG@10:0.020476296544075012, NDCG@50:0.03405043110251427
10/30/2023 02:20:07 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 63 to ./weights/finetune-Home-8192batch
10/30/2023 02:21:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:21:14 - INFO - trainer.finetune_evaluator - Epoch 64 Eval Result: R@10:0.04150693863630295, R@50:0.10394022613763809, NDCG@10:0.02063579671084881, NDCG@50:0.034153394401073456
10/30/2023 02:21:14 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 64 to ./weights/finetune-Home-8192batch
10/30/2023 02:22:15 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:22:22 - INFO - trainer.finetune_evaluator - Epoch 65 Eval Result: R@10:0.040138907730579376, R@50:0.10263232886791229, NDCG@10:0.020302388817071915, NDCG@50:0.03382280841469765
10/30/2023 02:23:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:23:30 - INFO - trainer.finetune_evaluator - Epoch 66 Eval Result: R@10:0.04055983945727348, R@50:0.10266239941120148, NDCG@10:0.02058146707713604, NDCG@50:0.0340522937476635
10/30/2023 02:24:30 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:24:38 - INFO - trainer.finetune_evaluator - Epoch 67 Eval Result: R@10:0.040815405547618866, R@50:0.1032787635922432, NDCG@10:0.02060973085463047, NDCG@50:0.0341704823076725
10/30/2023 02:25:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:25:46 - INFO - trainer.finetune_evaluator - Epoch 68 Eval Result: R@10:0.04019904136657715, R@50:0.10233166813850403, NDCG@10:0.020134981721639633, NDCG@50:0.033619124442338943
10/30/2023 02:26:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:26:53 - INFO - trainer.finetune_evaluator - Epoch 69 Eval Result: R@10:0.040905606001615524, R@50:0.10341406613588333, NDCG@10:0.0206514410674572, NDCG@50:0.03418075293302536
10/30/2023 02:27:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:28:01 - INFO - trainer.finetune_evaluator - Epoch 70 Eval Result: R@10:0.04099580645561218, R@50:0.10354936122894287, NDCG@10:0.020619183778762817, NDCG@50:0.034214798361063004
10/30/2023 02:29:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:29:09 - INFO - trainer.finetune_evaluator - Epoch 71 Eval Result: R@10:0.04060494154691696, R@50:0.10320359468460083, NDCG@10:0.02034151740372181, NDCG@50:0.03392820805311203
10/30/2023 02:30:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:30:17 - INFO - trainer.finetune_evaluator - Epoch 72 Eval Result: R@10:0.040755271911621094, R@50:0.1032487004995346, NDCG@10:0.020519549027085304, NDCG@50:0.03405884653329849
10/30/2023 02:31:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:31:24 - INFO - trainer.finetune_evaluator - Epoch 73 Eval Result: R@10:0.04049970582127571, R@50:0.10315849632024765, NDCG@10:0.020255986601114273, NDCG@50:0.03385381028056145
10/30/2023 02:32:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 02:32:32 - INFO - trainer.finetune_evaluator - Epoch 74 Eval Result: R@10:0.04126640409231186, R@50:0.1043461263179779, NDCG@10:0.02077612839639187, NDCG@50:0.03443213924765587
10/30/2023 02:32:32 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Home-8192batch
10/30/2023 02:32:32 - INFO - trainer.finetune_evaluator - ***** Run test *****
10/30/2023 02:32:40 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.038590479642152786, R@50:0.0943489819765091, NDCG@10:0.019570695236325264, NDCG@50:0.031613171100616455
10/30/2023 03:07:50 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Clothing/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Clothing/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Clothing/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Clothing/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Clothing/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Clothing/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Clothing-8192batch', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
10/30/2023 03:08:31 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
10/30/2023 03:08:31 - INFO - trainer.finetune_trainer - ***** Run training *****
10/30/2023 03:08:31 - INFO - trainer.finetune_trainer -   Num examples = 160516
10/30/2023 03:08:31 - INFO - trainer.finetune_trainer -   Num Epochs = 500
10/30/2023 03:08:31 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
10/30/2023 03:08:31 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
10/30/2023 03:08:31 - INFO - trainer.finetune_trainer -   Total steps = 39500
10/30/2023 03:09:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:09:05 - INFO - trainer.finetune_evaluator - Epoch 0 Eval Result: R@10:0.0151826748624444, R@50:0.04839160293340683, NDCG@10:0.007717289496213198, NDCG@50:0.014774755574762821
10/30/2023 03:09:05 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 0 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:09:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:09:33 - INFO - trainer.finetune_evaluator - Epoch 1 Eval Result: R@10:0.026683932170271873, R@50:0.0757356509566307, NDCG@10:0.01360716950148344, NDCG@50:0.024192679673433304
10/30/2023 03:09:33 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 1 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:09:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:10:02 - INFO - trainer.finetune_evaluator - Epoch 2 Eval Result: R@10:0.031203189864754677, R@50:0.09124838560819626, NDCG@10:0.015824470669031143, NDCG@50:0.02874765731394291
10/30/2023 03:10:02 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 2 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:10:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:10:30 - INFO - trainer.finetune_evaluator - Epoch 3 Eval Result: R@10:0.032904259860515594, R@50:0.09505674988031387, NDCG@10:0.016476033255457878, NDCG@50:0.029833242297172546
10/30/2023 03:10:30 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 3 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:10:54 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:10:58 - INFO - trainer.finetune_evaluator - Epoch 4 Eval Result: R@10:0.03793129697442055, R@50:0.10625333338975906, NDCG@10:0.01874154806137085, NDCG@50:0.03347055986523628
10/30/2023 03:10:58 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 4 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:11:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:11:26 - INFO - trainer.finetune_evaluator - Epoch 5 Eval Result: R@10:0.03892147168517113, R@50:0.11044253408908844, NDCG@10:0.019178546965122223, NDCG@50:0.034569915384054184
10/30/2023 03:11:26 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 5 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:11:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:11:54 - INFO - trainer.finetune_evaluator - Epoch 6 Eval Result: R@10:0.041511159390211105, R@50:0.11295605450868607, NDCG@10:0.020490318536758423, NDCG@50:0.03596187010407448
10/30/2023 03:11:54 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 6 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:12:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:12:22 - INFO - trainer.finetune_evaluator - Epoch 7 Eval Result: R@10:0.04217127710580826, R@50:0.11501257121562958, NDCG@10:0.02083585411310196, NDCG@50:0.036620453000068665
10/30/2023 03:12:22 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 7 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:12:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:12:50 - INFO - trainer.finetune_evaluator - Epoch 8 Eval Result: R@10:0.04336456209421158, R@50:0.11991266161203384, NDCG@10:0.02109362743794918, NDCG@50:0.03758849948644638
10/30/2023 03:12:50 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 8 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:13:14 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:13:18 - INFO - trainer.finetune_evaluator - Epoch 9 Eval Result: R@10:0.04272983595728874, R@50:0.12095361948013306, NDCG@10:0.02076064608991146, NDCG@50:0.03771544247865677
10/30/2023 03:13:42 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:13:46 - INFO - trainer.finetune_evaluator - Epoch 10 Eval Result: R@10:0.044583238661289215, R@50:0.1208774521946907, NDCG@10:0.02161627635359764, NDCG@50:0.038061656057834625
10/30/2023 03:13:46 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 10 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:14:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:14:15 - INFO - trainer.finetune_evaluator - Epoch 11 Eval Result: R@10:0.044989462941884995, R@50:0.12097900360822678, NDCG@10:0.0218415018171072, NDCG@50:0.038248952478170395
10/30/2023 03:14:15 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 11 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:14:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:14:43 - INFO - trainer.finetune_evaluator - Epoch 12 Eval Result: R@10:0.04496407508850098, R@50:0.12280701845884323, NDCG@10:0.021545380353927612, NDCG@50:0.03842157498002052
10/30/2023 03:15:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:15:11 - INFO - trainer.finetune_evaluator - Epoch 13 Eval Result: R@10:0.04443090409040451, R@50:0.12361947447061539, NDCG@10:0.02139628306031227, NDCG@50:0.038519904017448425
10/30/2023 03:15:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:15:39 - INFO - trainer.finetune_evaluator - Epoch 14 Eval Result: R@10:0.04620813950896263, R@50:0.12458425760269165, NDCG@10:0.02226525917649269, NDCG@50:0.03919517993927002
10/30/2023 03:15:39 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 14 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:16:03 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:16:07 - INFO - trainer.finetune_evaluator - Epoch 15 Eval Result: R@10:0.04531952366232872, R@50:0.12636148929595947, NDCG@10:0.02194439247250557, NDCG@50:0.03946452960371971
10/30/2023 03:16:31 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:16:35 - INFO - trainer.finetune_evaluator - Epoch 16 Eval Result: R@10:0.04648742079734802, R@50:0.12768173217773438, NDCG@10:0.022332575172185898, NDCG@50:0.03993683680891991
10/30/2023 03:16:35 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 16 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:16:59 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:17:03 - INFO - trainer.finetune_evaluator - Epoch 17 Eval Result: R@10:0.04671592265367508, R@50:0.1253713220357895, NDCG@10:0.02261105366051197, NDCG@50:0.03963715210556984
10/30/2023 03:17:03 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 17 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:17:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:17:32 - INFO - trainer.finetune_evaluator - Epoch 18 Eval Result: R@10:0.04702059179544449, R@50:0.12671694159507751, NDCG@10:0.022597938776016235, NDCG@50:0.03990570455789566
10/30/2023 03:17:32 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 18 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:17:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:18:00 - INFO - trainer.finetune_evaluator - Epoch 19 Eval Result: R@10:0.0468936450779438, R@50:0.1291796863079071, NDCG@10:0.022637054324150085, NDCG@50:0.04049094021320343
10/30/2023 03:18:24 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:18:28 - INFO - trainer.finetune_evaluator - Epoch 20 Eval Result: R@10:0.047655317932367325, R@50:0.1263868808746338, NDCG@10:0.023227518424391747, NDCG@50:0.040260277688503265
10/30/2023 03:18:28 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 20 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:18:52 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:18:56 - INFO - trainer.finetune_evaluator - Epoch 21 Eval Result: R@10:0.046868257224559784, R@50:0.12773250043392181, NDCG@10:0.022505315020680428, NDCG@50:0.04001646116375923
10/30/2023 03:19:20 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:19:24 - INFO - trainer.finetune_evaluator - Epoch 22 Eval Result: R@10:0.047959987074136734, R@50:0.1297382414340973, NDCG@10:0.022959960624575615, NDCG@50:0.040672946721315384
10/30/2023 03:19:24 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 22 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:19:48 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:19:52 - INFO - trainer.finetune_evaluator - Epoch 23 Eval Result: R@10:0.04773148521780968, R@50:0.1284434050321579, NDCG@10:0.022952307015657425, NDCG@50:0.040488023310899734
10/30/2023 03:20:16 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:20:20 - INFO - trainer.finetune_evaluator - Epoch 24 Eval Result: R@10:0.04818848893046379, R@50:0.12864650785923004, NDCG@10:0.022926103323698044, NDCG@50:0.04038077965378761
10/30/2023 03:20:20 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 24 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:20:44 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:20:48 - INFO - trainer.finetune_evaluator - Epoch 25 Eval Result: R@10:0.04801076650619507, R@50:0.129890576004982, NDCG@10:0.02326378971338272, NDCG@50:0.04107092320919037
10/30/2023 03:21:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:21:17 - INFO - trainer.finetune_evaluator - Epoch 26 Eval Result: R@10:0.046284306794404984, R@50:0.12953512370586395, NDCG@10:0.022130638360977173, NDCG@50:0.04024537652730942
10/30/2023 03:21:41 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:21:45 - INFO - trainer.finetune_evaluator - Epoch 27 Eval Result: R@10:0.048543937504291534, R@50:0.13202325999736786, NDCG@10:0.023196198046207428, NDCG@50:0.04126716032624245
10/30/2023 03:21:45 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 27 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:22:09 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:22:13 - INFO - trainer.finetune_evaluator - Epoch 28 Eval Result: R@10:0.04920405521988869, R@50:0.13108386099338531, NDCG@10:0.023529842495918274, NDCG@50:0.04127204045653343
10/30/2023 03:22:13 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 28 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:22:37 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:22:41 - INFO - trainer.finetune_evaluator - Epoch 29 Eval Result: R@10:0.04928022250533104, R@50:0.13146470487117767, NDCG@10:0.023408986628055573, NDCG@50:0.04121120274066925
10/30/2023 03:22:41 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 29 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:23:05 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:23:09 - INFO - trainer.finetune_evaluator - Epoch 30 Eval Result: R@10:0.04976261407136917, R@50:0.13143931329250336, NDCG@10:0.02405441924929619, NDCG@50:0.04179131239652634
10/30/2023 03:23:09 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 30 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:23:33 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:23:37 - INFO - trainer.finetune_evaluator - Epoch 31 Eval Result: R@10:0.048543937504291534, R@50:0.13291187584400177, NDCG@10:0.023214900866150856, NDCG@50:0.04153236374258995
10/30/2023 03:24:01 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:24:05 - INFO - trainer.finetune_evaluator - Epoch 32 Eval Result: R@10:0.04968644678592682, R@50:0.1319217085838318, NDCG@10:0.023463580757379532, NDCG@50:0.04129515960812569
10/30/2023 03:24:29 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:24:33 - INFO - trainer.finetune_evaluator - Epoch 33 Eval Result: R@10:0.048924773931503296, R@50:0.13291187584400177, NDCG@10:0.02340882271528244, NDCG@50:0.04162565991282463
10/30/2023 03:24:58 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:25:02 - INFO - trainer.finetune_evaluator - Epoch 34 Eval Result: R@10:0.049737222492694855, R@50:0.13286109268665314, NDCG@10:0.023504143580794334, NDCG@50:0.041561052203178406
10/30/2023 03:25:26 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:25:30 - INFO - trainer.finetune_evaluator - Epoch 35 Eval Result: R@10:0.05016883835196495, R@50:0.13235332071781158, NDCG@10:0.02339700609445572, NDCG@50:0.04122204706072807
10/30/2023 03:25:30 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 35 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:25:54 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:25:58 - INFO - trainer.finetune_evaluator - Epoch 36 Eval Result: R@10:0.05014345049858093, R@50:0.13204865157604218, NDCG@10:0.023486029356718063, NDCG@50:0.041254691779613495
10/30/2023 03:26:22 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:26:26 - INFO - trainer.finetune_evaluator - Epoch 37 Eval Result: R@10:0.05006728321313858, R@50:0.13301342725753784, NDCG@10:0.02377224713563919, NDCG@50:0.041741084307432175
10/30/2023 03:26:50 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:26:54 - INFO - trainer.finetune_evaluator - Epoch 38 Eval Result: R@10:0.04999111592769623, R@50:0.13387666642665863, NDCG@10:0.023885630071163177, NDCG@50:0.042159710079431534
10/30/2023 03:27:18 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:27:22 - INFO - trainer.finetune_evaluator - Epoch 39 Eval Result: R@10:0.05085434392094612, R@50:0.13402900099754333, NDCG@10:0.0240484531968832, NDCG@50:0.04206085205078125
10/30/2023 03:27:22 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 39 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:27:46 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:27:50 - INFO - trainer.finetune_evaluator - Epoch 40 Eval Result: R@10:0.05054967477917671, R@50:0.13288648426532745, NDCG@10:0.02403450384736061, NDCG@50:0.04195740446448326
10/30/2023 03:28:15 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:28:19 - INFO - trainer.finetune_evaluator - Epoch 41 Eval Result: R@10:0.05136212706565857, R@50:0.13232792913913727, NDCG@10:0.024189148098230362, NDCG@50:0.041774701327085495
10/30/2023 03:28:19 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 41 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:28:43 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:28:47 - INFO - trainer.finetune_evaluator - Epoch 42 Eval Result: R@10:0.05075278878211975, R@50:0.13372433185577393, NDCG@10:0.024166366085410118, NDCG@50:0.04219934716820717
10/30/2023 03:29:11 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:29:15 - INFO - trainer.finetune_evaluator - Epoch 43 Eval Result: R@10:0.050321172922849655, R@50:0.1323787122964859, NDCG@10:0.02376374788582325, NDCG@50:0.0416567362844944
10/30/2023 03:29:39 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:29:43 - INFO - trainer.finetune_evaluator - Epoch 44 Eval Result: R@10:0.05077817663550377, R@50:0.1342574954032898, NDCG@10:0.02414581924676895, NDCG@50:0.042295727878808975
10/30/2023 03:30:07 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:30:11 - INFO - trainer.finetune_evaluator - Epoch 45 Eval Result: R@10:0.05027039349079132, R@50:0.1341305524110794, NDCG@10:0.02378445863723755, NDCG@50:0.042021188884973526
10/30/2023 03:30:35 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:30:39 - INFO - trainer.finetune_evaluator - Epoch 46 Eval Result: R@10:0.04986416921019554, R@50:0.13633941113948822, NDCG@10:0.023713313043117523, NDCG@50:0.04250996187329292
10/30/2023 03:31:04 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:31:08 - INFO - trainer.finetune_evaluator - Epoch 47 Eval Result: R@10:0.05181913077831268, R@50:0.1341305524110794, NDCG@10:0.02415080927312374, NDCG@50:0.042018111795186996
10/30/2023 03:31:08 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 47 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:31:32 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:31:36 - INFO - trainer.finetune_evaluator - Epoch 48 Eval Result: R@10:0.05133673548698425, R@50:0.13466373085975647, NDCG@10:0.024276642128825188, NDCG@50:0.0423760823905468
10/30/2023 03:32:00 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:32:04 - INFO - trainer.finetune_evaluator - Epoch 49 Eval Result: R@10:0.051032066345214844, R@50:0.13329271972179413, NDCG@10:0.024185873568058014, NDCG@50:0.04209050163626671
10/30/2023 03:32:28 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:32:32 - INFO - trainer.finetune_evaluator - Epoch 50 Eval Result: R@10:0.05166679620742798, R@50:0.13443522155284882, NDCG@10:0.02435731515288353, NDCG@50:0.042268265038728714
10/30/2023 03:32:56 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:33:00 - INFO - trainer.finetune_evaluator - Epoch 51 Eval Result: R@10:0.050930511206388474, R@50:0.13562850654125214, NDCG@10:0.02407207153737545, NDCG@50:0.042496081441640854
10/30/2023 03:33:25 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:33:29 - INFO - trainer.finetune_evaluator - Epoch 52 Eval Result: R@10:0.050905123353004456, R@50:0.13618707656860352, NDCG@10:0.02390933968126774, NDCG@50:0.042472902685403824
10/30/2023 03:33:53 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:33:57 - INFO - trainer.finetune_evaluator - Epoch 53 Eval Result: R@10:0.05115901306271553, R@50:0.1348414421081543, NDCG@10:0.02381816692650318, NDCG@50:0.04199332371354103
10/30/2023 03:34:21 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:34:25 - INFO - trainer.finetune_evaluator - Epoch 54 Eval Result: R@10:0.05222535505890846, R@50:0.13473989069461823, NDCG@10:0.024358218535780907, NDCG@50:0.04219893366098404
10/30/2023 03:34:25 - INFO - trainer.finetune_trainer - ***** Saving model checkpoint 54 to ./weights/finetune-Clothing-8192batch
10/30/2023 03:34:49 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:34:53 - INFO - trainer.finetune_evaluator - Epoch 55 Eval Result: R@10:0.0506766214966774, R@50:0.1364663541316986, NDCG@10:0.02385902963578701, NDCG@50:0.04249080270528793
10/30/2023 03:35:17 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:35:21 - INFO - trainer.finetune_evaluator - Epoch 56 Eval Result: R@10:0.05174296349287033, R@50:0.13575544953346252, NDCG@10:0.024324841797351837, NDCG@50:0.0425850935280323
10/30/2023 03:35:45 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:35:49 - INFO - trainer.finetune_evaluator - Epoch 57 Eval Result: R@10:0.05077817663550377, R@50:0.134993776679039, NDCG@10:0.02403295412659645, NDCG@50:0.04236816614866257
10/30/2023 03:36:13 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:36:17 - INFO - trainer.finetune_evaluator - Epoch 58 Eval Result: R@10:0.05019422620534897, R@50:0.13347043097019196, NDCG@10:0.023487187922000885, NDCG@50:0.04160303995013237
10/30/2023 03:36:42 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:36:46 - INFO - trainer.finetune_evaluator - Epoch 59 Eval Result: R@10:0.05186990648508072, R@50:0.13618707656860352, NDCG@10:0.02421552874147892, NDCG@50:0.04250204190611839
10/30/2023 03:37:10 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:37:14 - INFO - trainer.finetune_evaluator - Epoch 60 Eval Result: R@10:0.05156523734331131, R@50:0.13423210382461548, NDCG@10:0.024503193795681, NDCG@50:0.04247637838125229
10/30/2023 03:37:38 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:37:42 - INFO - trainer.finetune_evaluator - Epoch 61 Eval Result: R@10:0.05095589905977249, R@50:0.13613629341125488, NDCG@10:0.0241119135171175, NDCG@50:0.04266293719410896
10/30/2023 03:38:06 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:38:10 - INFO - trainer.finetune_evaluator - Epoch 62 Eval Result: R@10:0.05166679620742798, R@50:0.13677102327346802, NDCG@10:0.024606281891465187, NDCG@50:0.04305581748485565
10/30/2023 03:38:34 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:38:38 - INFO - trainer.finetune_evaluator - Epoch 63 Eval Result: R@10:0.05108284577727318, R@50:0.1361616849899292, NDCG@10:0.024283315986394882, NDCG@50:0.04273030161857605
10/30/2023 03:39:02 - INFO - trainer.finetune_evaluator - ***** Run eval *****
10/30/2023 03:39:06 - INFO - trainer.finetune_evaluator - Epoch 64 Eval Result: R@10:0.05057506263256073, R@50:0.1352730691432953, NDCG@10:0.023748105391860008, NDCG@50:0.04223109781742096
10/30/2023 03:39:06 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/finetune-Clothing-8192batch
10/30/2023 03:39:06 - INFO - trainer.finetune_evaluator - ***** Run test *****
10/30/2023 03:39:10 - INFO - trainer.finetune_evaluator - Test Result: R@10:0.04681747779250145, R@50:0.12978902459144592, NDCG@10:0.0223682913929224, NDCG@50:0.04040413722395897
11/26/2023 02:02:36 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 8, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 4, 'device': device(type='cuda', index=0)}
11/26/2023 03:30:45 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 4, 'device': device(type='cuda', index=0)}
11/26/2023 03:32:10 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Beauty/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Beauty/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Beauty/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Beauty/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'model_save_path': './weights/finetune-Beauty-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 03:32:30 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 03:32:30 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 03:32:30 - INFO - trainer.finetune_trainer -   Num examples = 131413
11/26/2023 03:32:30 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 03:32:30 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 03:32:30 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 03:32:30 - INFO - trainer.finetune_trainer -   Total steps = 64500
11/26/2023 05:27:00 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 50, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed', 'hidden_size': 512, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 05:33:15 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 50, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/', 'hidden_size': 512, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 05:35:24 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 50, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 05:39:13 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 50, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropput_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 05:40:09 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 50, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 05:40:50 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 05:40:50 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 05:40:50 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 05:40:50 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 05:40:50 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 05:40:50 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 05:40:50 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 06:37:52 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 50, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 06:38:18 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 06:38:18 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 06:38:18 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 06:38:18 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 06:38:18 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 06:38:18 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 06:38:18 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 06:49:54 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 50, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 06:50:17 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 06:50:17 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 06:50:17 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 06:50:17 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 06:50:17 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 06:50:17 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 06:50:17 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 06:57:10 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 50, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 06:57:33 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 06:57:33 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 06:57:33 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 06:57:33 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 06:57:33 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 06:57:33 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 06:57:33 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 07:01:38 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 07:02:01 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 07:02:01 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 07:02:01 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 07:02:01 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 07:02:01 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 07:02:01 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 07:02:01 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 07:11:08 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 07:11:30 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 07:11:30 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 07:11:30 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 07:11:30 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 07:11:30 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 07:11:30 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 07:11:30 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 07:16:19 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 07:16:41 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 07:16:41 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 07:16:41 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 07:16:41 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 07:16:41 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 07:16:41 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 07:16:41 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 07:49:06 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 07:49:28 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 07:49:28 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 07:49:28 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 07:49:28 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 07:49:28 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 07:49:28 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 07:49:28 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 08:09:55 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 08:10:17 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 08:10:17 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 08:10:17 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 08:10:17 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 08:10:17 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 08:10:17 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 08:10:17 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 08:57:22 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 08:57:46 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 08:57:46 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 08:57:46 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 08:57:46 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 08:57:46 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 08:57:46 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 08:57:46 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 09:05:18 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 09:05:55 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 09:05:55 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 09:05:55 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 09:05:55 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 09:05:55 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 09:05:55 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 09:05:55 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 09:43:10 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 09:43:38 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 09:43:38 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 09:43:38 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 09:43:38 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 09:43:38 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 09:43:38 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 09:43:38 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 09:50:00 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 09:50:26 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 09:50:26 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 09:50:26 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 09:50:26 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 09:50:26 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 09:50:26 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 09:50:26 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 09:51:27 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/26/2023 09:51:52 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 09:51:52 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 09:51:52 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 09:51:52 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 09:51:52 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 09:51:52 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/26/2023 09:51:52 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/26/2023 10:23:59 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/26/2023 10:24:47 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 10:24:48 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 10:24:48 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 10:24:48 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 10:24:48 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 10:24:48 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
11/26/2023 10:24:48 - INFO - trainer.finetune_trainer -   Total steps = 86000
11/26/2023 10:26:29 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/26/2023 10:26:58 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/26/2023 10:26:58 - INFO - trainer.finetune_trainer - ***** Run training *****
11/26/2023 10:26:58 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/26/2023 10:26:58 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/26/2023 10:26:58 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/26/2023 10:26:58 - INFO - trainer.finetune_trainer -   Total train batch size = 2048
11/26/2023 10:26:58 - INFO - trainer.finetune_trainer -   Total steps = 86000
11/27/2023 00:16:51 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 2, 'device': device(type='cuda', index=0)}
11/27/2023 00:20:08 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 00:20:48 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 00:20:48 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 00:20:48 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 00:20:48 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 00:20:48 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/27/2023 00:20:48 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/27/2023 00:20:48 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/27/2023 03:05:20 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 03:05:47 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 03:05:47 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 03:05:47 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 03:05:47 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 03:05:47 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/27/2023 03:05:47 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/27/2023 03:05:47 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/27/2023 07:28:01 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 07:28:40 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 07:28:40 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 07:28:40 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 07:28:40 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 07:28:40 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/27/2023 07:28:40 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/27/2023 07:28:40 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/27/2023 08:30:07 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 08:30:33 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 08:30:33 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 08:30:33 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 08:30:33 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 08:30:33 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/27/2023 08:30:33 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/27/2023 08:30:33 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/27/2023 08:34:27 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'sample_size': [20, 20], 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 08:34:53 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 08:34:53 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 08:34:53 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 08:34:53 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 08:34:53 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/27/2023 08:34:53 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/27/2023 08:34:53 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/27/2023 08:39:18 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 08:40:29 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 08:40:54 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 08:40:54 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 08:40:54 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 08:40:54 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 08:40:54 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/27/2023 08:40:54 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/27/2023 08:40:54 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/27/2023 08:53:32 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 08:53:57 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 08:53:57 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 08:53:57 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 08:53:57 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 08:53:57 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/27/2023 08:53:57 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/27/2023 08:53:57 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/27/2023 09:01:43 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 09:02:08 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 09:02:08 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 09:02:08 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 09:02:08 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 09:02:08 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/27/2023 09:02:08 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/27/2023 09:02:08 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/27/2023 09:11:10 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 09:11:35 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 09:11:35 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 09:11:35 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 09:11:35 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 09:11:35 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/27/2023 09:11:35 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/27/2023 09:11:35 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/27/2023 09:19:26 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 1024, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 09:19:51 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 09:19:51 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 09:19:51 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 09:19:51 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 09:19:51 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 1024
11/27/2023 09:19:51 - INFO - trainer.finetune_trainer -   Total train batch size = 1024
11/27/2023 09:19:51 - INFO - trainer.finetune_trainer -   Total steps = 172000
11/27/2023 09:23:56 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 64, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 09:24:21 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 09:24:21 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 09:24:21 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 09:24:21 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 09:24:21 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 64
11/27/2023 09:24:21 - INFO - trainer.finetune_trainer -   Total train batch size = 64
11/27/2023 09:24:21 - INFO - trainer.finetune_trainer -   Total steps = 2751000
11/27/2023 09:25:47 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 09:26:12 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 09:26:12 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 09:26:12 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 09:26:12 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 09:26:12 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/27/2023 09:26:12 - INFO - trainer.finetune_trainer -   Total train batch size = 4
11/27/2023 09:26:12 - INFO - trainer.finetune_trainer -   Total steps = 44016000
11/27/2023 09:36:28 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 09:36:53 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 09:36:53 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 09:36:53 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 09:36:53 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 09:36:53 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/27/2023 09:36:53 - INFO - trainer.finetune_trainer -   Total train batch size = 4
11/27/2023 09:36:53 - INFO - trainer.finetune_trainer -   Total steps = 44016000
11/27/2023 09:38:54 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 09:39:19 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 09:39:19 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 09:39:19 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 09:39:19 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 09:39:19 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/27/2023 09:39:19 - INFO - trainer.finetune_trainer -   Total train batch size = 4
11/27/2023 09:39:19 - INFO - trainer.finetune_trainer -   Total steps = 44016000
11/27/2023 09:41:13 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 09:41:38 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 09:41:38 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 09:41:38 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 09:41:38 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 09:41:38 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/27/2023 09:41:38 - INFO - trainer.finetune_trainer -   Total train batch size = 4
11/27/2023 09:41:38 - INFO - trainer.finetune_trainer -   Total steps = 44016000
11/27/2023 09:45:15 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 09:45:40 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 09:45:40 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 09:45:40 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 09:45:40 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 09:45:40 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/27/2023 09:45:40 - INFO - trainer.finetune_trainer -   Total train batch size = 4
11/27/2023 09:45:40 - INFO - trainer.finetune_trainer -   Total steps = 44016000
11/27/2023 09:46:48 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 09:47:12 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 09:47:13 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 09:47:13 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 09:47:13 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 09:47:13 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/27/2023 09:47:13 - INFO - trainer.finetune_trainer -   Total train batch size = 4
11/27/2023 09:47:13 - INFO - trainer.finetune_trainer -   Total steps = 44016000
11/27/2023 09:49:18 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 09:49:44 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 09:49:44 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 09:49:44 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 09:49:44 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 09:49:44 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/27/2023 09:49:44 - INFO - trainer.finetune_trainer -   Total train batch size = 4
11/27/2023 09:49:44 - INFO - trainer.finetune_trainer -   Total steps = 44016000
11/27/2023 09:53:31 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'weight_data_dir': './dataset/amazon/processed/Home/', 'sample_size': [20, 20], 'hidden_size': 512, 'gnn_dropout_prob': 0.5, 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 09:53:56 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 09:53:56 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 09:53:56 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 09:53:56 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 09:53:56 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/27/2023 09:53:56 - INFO - trainer.finetune_trainer -   Total train batch size = 4
11/27/2023 09:53:56 - INFO - trainer.finetune_trainer -   Total steps = 44016000
11/27/2023 11:37:17 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'path': './adj_mat', 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 11:38:25 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'path': './adj_mat', 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 11:40:32 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'path': './adj_mat', 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 11:41:44 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'path': './adj_mat', 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 11:45:16 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'path': './adj_mat', 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 12:22:05 - INFO - __main__ - {'config': './configs/finetuning/finetune_amazon.yaml', 'wandb_enable': False, 'project_name': '', 'display_name': '', 'num_worker': 2, 'train_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'train_seq_file': './dataset/amazon/processed/Home/train_seq.jsonl', 'eval_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'eval_seq_file': './dataset/amazon/processed/Home/eval_seq.jsonl', 'test_item_file': './dataset/amazon/processed/Home/item_feature.jsonl', 'test_seq_file': './dataset/amazon/processed/Home/test_seq.jsonl', 'max_seq_length': 20, 'train_vision_format': 'embed', 'eval_vision_format': 'embed', 'test_vision_format': 'embed', 'max_vision_frames': 10, 'train_text_format': 'embed', 'eval_text_format': 'embed', 'test_text_format': 'embed', 'clip_model_path': './weights/clip/ViT-B-32.pt', 'vision_feature_embed_dim': 512, 'text_feature_embed_dim': 512, 'fusion_embed_dim': 512, 'fusion_layers': 2, 'fusion_heads': 8, 'fusion_feedforward_dim': 1024, 'fusion_dropout': 0.5, 'fusion_embed_dropout': 0.2, 'initializer_range': 0.02, 'seed': 42, 'log_file': './logs/finetune-amazon-2layer.log', 'train_batch_size': 4, 'eval_batch_size': 1024, 'test_batch_size': 1024, 'num_train_epochs': 500, 'learning_rate': 0.001, 'lr_scheduler_gamma': 1.0, 'max_grad_norm': 1.0, 'contrastive_temperature': 0.05, 'ce_mask_ratio': 0.2, 'early_stopping': 10, 'path': './adj_mat', 'model_save_path': './weights/finetune-Home-8192batch-con_l', 'model_resume_path': './weights/pretrain-webvid-2layer-512dim', 'rank': 0, 'local_rank': 0, 'world_size': 1, 'device': device(type='cuda', index=0)}
11/27/2023 12:23:00 - INFO - trainer.finetune_trainer - ***** Resume Model from path ./weights/pretrain-webvid-2layer-512dim
11/27/2023 12:23:01 - INFO - trainer.finetune_trainer - ***** Run training *****
11/27/2023 12:23:01 - INFO - trainer.finetune_trainer -   Num examples = 352125
11/27/2023 12:23:01 - INFO - trainer.finetune_trainer -   Num Epochs = 500
11/27/2023 12:23:01 - INFO - trainer.finetune_trainer -   Instantaneous batch size per device = 4
11/27/2023 12:23:01 - INFO - trainer.finetune_trainer -   Total train batch size = 4
11/27/2023 12:23:01 - INFO - trainer.finetune_trainer -   Total steps = 44016000
